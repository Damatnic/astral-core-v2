var e,t=Object.defineProperty,i=Object.defineProperties,n=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,a=Math.pow,l=(e,i,n)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[i]=n,c=(e,t)=>{for(var i in t||(t={}))r.call(t,i)&&l(e,i,t[i]);if(s)for(var i of s(t))o.call(t,i)&&l(e,i,t[i]);return e},d=(e,t)=>i(e,n(t)),u=(e,t,i)=>l(e,"symbol"!=typeof t?t+"":t,i),m=(e,t,i)=>new Promise((n,s)=>{var r=e=>{try{a(i.next(e))}catch(t){s(t)}},o=e=>{try{a(i.throw(e))}catch(t){s(t)}},a=e=>e.done?n(e.value):Promise.resolve(e.value).then(r,o);a((i=i.apply(e,t)).next())});import{r as h}from"./react-vendor-IorqdeNj.js";import{z as p,f as g,E as y,x as f,S,L as v,$ as I}from"./vendor-BRFUAJck.js";var w={};const C={makeRedirectUri:()=>window.location.origin+"/auth/callback",useAutoDiscovery:e=>({authorizationEndpoint:`${e}/authorize`,tokenEndpoint:`${e}/oauth/token`,revocationEndpoint:`${e}/oauth/revoke`,userInfoEndpoint:`${e}/userinfo`,endSessionEndpoint:`${e}/v2/logout`}),ResponseType:{Token:w.REACT_APP_TOKEN||"token",Code:"code"},useAuthRequest:(e,t)=>{const i=()=>{var i;const n=new URLSearchParams({client_id:e.clientId,redirect_uri:e.redirectUri,response_type:e.responseType,scope:e.scopes.join(" "),audience:(null==(i=e.extraParams)?void 0:i.audience)||"",state:Math.random().toString(36).substring(7)});return`${t.authorizationEndpoint}?${n.toString()}`},n=window.location.hash?Object.fromEntries(new URLSearchParams(window.location.hash.substring(1))):{};let s=null;window.location.hash&&(n.error?s={type:"error",params:n,error:{message:n.error_description||n.error}}:n.access_token&&(s={type:"success",params:n,error:null}));return[{url:i()},s,()=>m(null,null,function*(){const e=i();window.location.href=e})]},exchangeCodeAsync:e=>m(null,null,function*(){return{accessToken:w.REACT_APP_TOKEN||"default-token"}})},_=class e{static getInstance(){return e.instance||(e.instance=new e),e.instance}getStarkeeperJournalEntries(e){return[{id:"journal-001",userToken:e,timestamp:new Date(Date.now()-1728e5).toISOString(),content:"Been feeling really overwhelmed with work lately. The deadlines keep piling up and I feel like I'm drowning. Sometimes I wonder if I'm good enough for this job. Maybe talking to someone would help..."},{id:"journal-002",userToken:e,timestamp:new Date(Date.now()-864e5).toISOString(),content:"Had a breakthrough moment today during my session with Luna. She helped me realize that my anxiety spirals usually start with comparison to others. Going to try the breathing exercises she suggested."},{id:"journal-003",userToken:e,timestamp:(new Date).toISOString(),content:"Practicing gratitude like my guide suggested. Three things I'm grateful for: 1) The supportive community here 2) Having a safe space to share my thoughts 3) Small progress feels significant. The tether feature really helped when I was panicking yesterday."}]}getStarkeeperMoodCheckIns(e){return[{id:"mood-001",userToken:e,timestamp:new Date(Date.now()-2592e5).toISOString(),moodScore:2,anxietyLevel:4,sleepQuality:2,energyLevel:2,tags:["overwhelmed","stressed","isolated"],notes:"Work pressure getting to me. Barely sleeping."},{id:"mood-002",userToken:e,timestamp:new Date(Date.now()-864e5).toISOString(),moodScore:3,anxietyLevel:3,sleepQuality:3,energyLevel:3,tags:["hopeful","supported"],notes:"Had a really good session with my guide. Feeling more hopeful."},{id:"mood-003",userToken:e,timestamp:(new Date).toISOString(),moodScore:4,anxietyLevel:2,sleepQuality:4,energyLevel:4,tags:["grateful","motivated","calm"],notes:"Breathing exercises are working! Slept better last night."}]}getStarkeeperDilemmas(e){return[{id:"dilemma-001",userToken:e,category:"work-anxiety",content:"I've been having panic attacks at work almost daily. My boss keeps piling on more projects and I feel like I'm suffocating. I'm scared to tell anyone because I don't want to seem weak or lose my job. Has anyone else dealt with workplace anxiety like this?",timestamp:new Date(Date.now()-1728e5).toISOString(),supportCount:12,isSupported:!0,isReported:!1,status:"resolved",assignedHelperId:"helper-luna",helperDisplayName:"Luna ✨",resolved_by_seeker:!0,summary:"Connected with Luna who provided excellent breathing techniques and workplace boundary strategies. Panic attacks have reduced significantly."},{id:"dilemma-002",userToken:e,category:"relationships",content:"My best friend has been distant lately and I'm worried I did something wrong. They used to text me every day but now it's been a week of silence. I'm anxious about reaching out because what if they're avoiding me on purpose?",timestamp:new Date(Date.now()-18e6).toISOString(),supportCount:7,isSupported:!1,isReported:!1,status:"active",aiMatchReason:"Relationship anxiety and fear of abandonment - would benefit from perspective on communication strategies"}]}getStarkeeperAssessments(e){return[{id:"assessment-001",userToken:e,type:"gad-7",timestamp:new Date(Date.now()-6048e5).toISOString(),score:12,answers:[2,2,1,2,1,2,2]},{id:"assessment-002",userToken:e,type:"phq-9",timestamp:new Date(Date.now()-6048e5).toISOString(),score:8,answers:[1,1,2,1,0,1,1,1,0]},{id:"assessment-003",userToken:e,type:"gad-7",timestamp:(new Date).toISOString(),score:8,answers:[1,1,1,2,1,1,1]}]}getConstellationGuideProfile(){return{id:"helper-luna",auth0UserId:"demo-helper-001",displayName:"Luna ✨",bio:"Certified therapist specializing in anxiety and workplace stress. Here to listen and support your journey. 🌙 Remember: seeking help is a sign of strength, not weakness.",joinDate:new Date(Date.now()-15552e6).toISOString(),helperType:"Certified",role:"Certified",reputation:4.9,isAvailable:!0,expertise:["anxiety","workplace-stress","panic-attacks","breathing-techniques"],kudosCount:89,xp:2450,level:8,nextLevelXp:2500,applicationStatus:"approved",trainingCompleted:!0,quizScore:95}}getAllDilemmasForHelper(){return[{id:"dilemma-available-001",userToken:"user-need-help-001",category:"anxiety",content:"I've been having trouble sleeping because my mind races with worries about everything I need to do tomorrow. Even when I'm exhausted, I can't seem to turn off my thoughts. Has anyone found techniques that help with bedtime anxiety?",timestamp:new Date(Date.now()-72e5).toISOString(),supportCount:3,isSupported:!1,isReported:!1,status:"active",aiMatchReason:"Anxiety specialist match - Luna's expertise in breathing techniques could help with bedtime racing thoughts"},{id:"dilemma-available-002",userToken:"user-need-help-002",category:"workplace-stress",content:"My coworker keeps taking credit for my ideas in meetings. I'm too afraid to speak up because they have more seniority, but it's really affecting my confidence and motivation. I don't know how to handle this professionally.",timestamp:new Date(Date.now()-144e5).toISOString(),supportCount:1,isSupported:!1,isReported:!1,status:"active",aiMatchReason:"Workplace boundary issues - Luna's background in workplace stress management could provide professional guidance"},{id:"dilemma-direct-001",userToken:"user-returning-001",category:"anxiety",content:"Hi Luna, you helped me a few weeks ago with my panic attacks and I was wondering if we could talk again? They've been getting worse since I started a new job and I could really use your guidance with the breathing techniques you taught me.",timestamp:new Date(Date.now()-18e5).toISOString(),supportCount:0,isSupported:!1,isReported:!1,status:"direct_request",requestedHelperId:"helper-luna"},{id:"dilemma-001",userToken:"demo-user-001",category:"work-anxiety",content:"I've been having panic attacks at work almost daily. My boss keeps piling on more projects and I feel like I'm suffocating. I'm scared to tell anyone because I don't want to seem weak or lose my job. Has anyone else dealt with workplace anxiety like this?",timestamp:new Date(Date.now()-1728e5).toISOString(),supportCount:12,isSupported:!0,isReported:!1,status:"resolved",assignedHelperId:"helper-luna",helperDisplayName:"Luna ✨",resolved_by_seeker:!0,summary:"Connected with Luna who provided excellent breathing techniques and workplace boundary strategies. Panic attacks have reduced significantly."},...this.getStarkeeperDilemmas("demo-user-001")]}getHelperChatSessions(){return[{dilemmaId:"dilemma-001",messages:[{id:"msg-001",sender:"user",text:"Thank you for reaching out. I really need someone to talk to about these panic attacks.",timestamp:new Date(Date.now()-864e5).toISOString()},{id:"msg-002",sender:"poster",text:"I'm here to listen and support you. Panic attacks can feel overwhelming, but there are effective techniques we can explore together. Can you tell me what triggers them most at work?",timestamp:new Date(Date.now()-864e5+3e5).toISOString()},{id:"msg-003",sender:"user",text:"Usually when my boss assigns multiple urgent deadlines at once. My chest gets tight and I can't breathe properly.",timestamp:new Date(Date.now()-864e5+6e5).toISOString()},{id:"msg-004",sender:"poster",text:"That physical response is very common with anxiety. Let's try a grounding technique: 5-4-3-2-1. Name 5 things you can see, 4 you can touch, 3 you can hear, 2 you can smell, 1 you can taste. This helps bring you back to the present moment.",timestamp:new Date(Date.now()-864e5+9e5).toISOString()}],unread:!1,perspective:"helper",helpSessionId:"session-001"}]}getHelperSessions(){return[{id:"session-001",dilemmaId:"dilemma-001",seekerId:"demo-user-001",helperId:"helper-luna",helperDisplayName:"Luna ✨",startedAt:new Date(Date.now()-864e5).toISOString(),endedAt:new Date(Date.now()-828e5).toISOString(),isFavorited:!0,kudosGiven:!0,summary:"Successful session addressing workplace panic attacks. Provided grounding techniques and boundary-setting strategies.",helperSummary:"Responsive client, implemented breathing techniques effectively. Recommended ongoing practice and follow-up if symptoms persist."},{id:"session-002",dilemmaId:"dilemma-003",seekerId:"demo-user-002",helperId:"helper-luna",helperDisplayName:"Luna ✨",startedAt:new Date(Date.now()-72e5).toISOString(),isFavorited:!1,kudosGiven:!1,summary:"Ongoing session - relationship anxiety support"}]}getAdminHelperApplications(){return[{id:"helper-pending-001",auth0UserId:"pending-helper-001",displayName:"Alex Chen",bio:"Psychology graduate with experience in peer counseling. Passionate about mental health advocacy and crisis intervention.",joinDate:new Date(Date.now()-2592e5).toISOString(),helperType:"Community",role:"Community",reputation:0,isAvailable:!1,expertise:["depression","anxiety","crisis-support"],xp:0,level:1,nextLevelXp:100,applicationStatus:"pending",applicationNotes:"Strong background in psychology. Completed crisis intervention training. References pending verification.",trainingCompleted:!0,quizScore:88},{id:"helper-rejected-001",auth0UserId:"rejected-helper-001",displayName:"Sam Johnson",bio:"Want to help people with their problems.",joinDate:new Date(Date.now()-864e5).toISOString(),helperType:"Community",role:"Community",reputation:0,isAvailable:!1,expertise:["general"],xp:0,level:1,nextLevelXp:100,applicationStatus:"rejected",applicationNotes:"Insufficient training completion. Bio lacks professionalism. Quiz score below threshold.",trainingCompleted:!1,quizScore:45}]}getAdminModerationActions(){return[{id:"mod-001",type:"content_removal",targetId:"dilemma-removed-001",moderatorId:"admin-001",userId:"user-flagged-001",action:"Post Removed",reason:"Inappropriate content - sharing personal contact information",timestamp:new Date(Date.now()-216e5).toISOString(),status:"completed",relatedContentId:"dilemma-removed-001"},{id:"mod-002",type:"user_warning",targetId:"user-warned-001",moderatorId:"admin-001",userId:"user-warned-001",action:"Warning Issued",reason:"Multiple reports for aggressive language in chat sessions",timestamp:new Date(Date.now()-432e5).toISOString(),status:"completed"},{id:"mod-003",type:"helper_suspension",targetId:"helper-suspended-001",moderatorId:"admin-001",userId:"helper-suspended-001",action:"Helper Suspended",reason:"Violation of helper guidelines - providing medical advice beyond scope",timestamp:new Date(Date.now()-648e5).toISOString(),status:"active"}]}getAdminCommunityStats(){return{activeDilemmas:47,avgTimeToFirstSupport:"8m 32s",totalHelpers:23,mostCommonCategory:"anxiety"}}getAstralAdminProfile(){return{id:"admin-001",name:"Dr. Michael Torres",displayName:"Dr. Michael Torres",role:"Admin",department:"Platform Operations & Safety",clearanceLevel:"Executive",yearsWithPlatform:3,profilePicture:"/demo-images/admin-torres.jpg",contactInfo:{email:"m.torres@astralcore.org",phone:"+1-555-0123",emergencyContact:"+1-555-0199"},helperApplications:[{id:"app-001",applicantName:"Dr. Lisa Wang",applicationType:"New Helper Application",submissionDate:new Date("2024-01-10T09:15:00"),status:"pending_review",priority:"high",credentials:["Licensed Psychologist","PhD Clinical Psychology","10+ years experience"],specialties:["Trauma Recovery","Addiction Support","Family Therapy"],backgroundCheckStatus:"completed",referencesVerified:!0,reviewNotes:"Strong credentials, excellent references. Recommend approval.",riskAssessment:"low"},{id:"app-002",applicantName:"Jordan Smith",applicationType:"Peer Support Specialist",submissionDate:new Date("2024-01-12T14:30:00"),status:"under_review",priority:"medium",credentials:["Certified Peer Support Specialist","Lived Experience Advocate"],specialties:["Depression Support","Recovery Journey"],backgroundCheckStatus:"in_progress",referencesVerified:!1,reviewNotes:"Awaiting final reference verification.",riskAssessment:"low"},{id:"app-003",applicantName:"Alex Chen",applicationType:"Crisis Intervention Specialist",submissionDate:new Date("2024-01-08T11:45:00"),status:"flagged",priority:"urgent",credentials:["Crisis Intervention Certification"],specialties:["Suicide Prevention","Emergency Response"],backgroundCheckStatus:"flagged",referencesVerified:!0,reviewNotes:"Background check revealed undisclosed prior incident. Requires executive review.",riskAssessment:"high"}],escalatedCases:[{id:"esc-001",type:"serious_safety_concern",description:"User posted detailed self-harm plan in community forum",reportedBy:"guide-001",escalationTime:new Date("2024-01-15T16:20:00"),status:"urgent_intervention",userInvolved:"user-crisis-003",actionsTaken:["Immediate crisis intervention","Emergency contact notified","Professional referral initiated"],outcome:"pending",followUpRequired:!0},{id:"esc-002",type:"helper_boundary_violation",description:"Helper provided personal contact information to user",reportedBy:"automated_system",escalationTime:new Date("2024-01-14T22:15:00"),status:"under_investigation",helperInvolved:"guide-003",actionsTaken:["Temporary suspension","Investigation initiated","User safety verified"],outcome:"investigation_ongoing",followUpRequired:!0},{id:"esc-003",type:"platform_security_incident",description:"Unauthorized access attempt to admin dashboard",reportedBy:"security_system",escalationTime:new Date("2024-01-13T03:45:00"),status:"resolved",actionsTaken:["IP blocked","Security protocols updated","Access logs reviewed"],outcome:"threat_neutralized",followUpRequired:!1}],analytics:{userMetrics:{totalActiveUsers:15724,newRegistrationsToday:47,dailyActiveUsers:3892,weeklyActiveUsers:8456,userRetentionRate:78.3,averageSessionDuration:23.5},helperMetrics:{totalActiveHelpers:324,averageResponseTime:8.2,helpersOnline:89,totalSessionsToday:156,helperSatisfactionRating:4.7,helperUtilizationRate:67.8},crisisMetrics:{crisisAlertsToday:12,averageResponseTimeToCrisis:4.3,crisisResolutionRate:94.2,escalationRate:8.7,emergencyContactsActivated:3,preventionSuccessRate:91.5},platformHealth:{systemUptime:99.97,averagePageLoadTime:1.2,errorRate:.03,dataBackupStatus:"current",securityIncidents:0,performanceScore:96.8}},communityHealth:{totalPosts:1847,flaggedContent:23,moderatedContent:156,positiveSentimentRate:73.4,engagementRate:45.2,reportedIncidents:8,communityGuidanceInterventions:34},qualityMetrics:{helperPerformanceReviews:12,userSatisfactionScore:4.6,platformFeatureUsage:{journaling:89.3,peerSupport:67.8,crisisSupport:23.4,resourceLibrary:56.7,moodTracking:78.9},completedAudits:4,pendingAudits:2},recentActions:[{id:"action-001",type:"helper_approval",description:"Approved new helper application for Dr. Amanda Rodriguez",timestamp:new Date("2024-01-15T10:30:00"),adminUser:"admin-001"},{id:"action-002",type:"policy_update",description:"Updated crisis intervention protocols per new guidelines",timestamp:new Date("2024-01-14T15:45:00"),adminUser:"admin-001"},{id:"action-003",type:"security_enhancement",description:"Implemented additional 2FA requirements for helpers",timestamp:new Date("2024-01-13T09:20:00"),adminUser:"admin-001"}],systemAlerts:[{id:"alert-001",type:"performance",severity:"medium",message:"Database query response time above threshold in crisis support module",timestamp:new Date("2024-01-15T14:20:00"),status:"acknowledged"},{id:"alert-002",type:"security",severity:"low",message:"Multiple failed login attempts from IP range 192.168.1.x",timestamp:new Date("2024-01-15T11:35:00"),status:"monitoring"}]}}getCommunityReflections(){return[{id:"reflection-001",userToken:"community-user-001",content:"Today I realized that healing isn't linear. Some days are harder than others, and that's okay. Progress isn't always visible from the inside. 🌱",timestamp:new Date(Date.now()-144e5).toISOString(),reactions:{light:15,heart:8,strength:12},myReaction:"light"},{id:"reflection-002",userToken:"community-user-002",content:"Grateful for this community. Yesterday I was in a dark place, but reading everyone's stories reminded me I'm not alone. Sometimes just knowing others understand makes all the difference.",timestamp:new Date(Date.now()-288e5).toISOString(),reactions:{heart:22,light:18,hug:9}},{id:"reflection-003",userToken:"demo-user-001",content:"Six months ago I couldn't leave my apartment without panic attacks. Today I gave a presentation at work. The breathing techniques from my guide Luna really work. If you're struggling, please reach out - it gets better. 💙",timestamp:new Date(Date.now()-36e5).toISOString(),reactions:{strength:28,light:31,heart:19}}]}getForumThreads(){return[{id:"thread-001",title:"Crisis Intervention Best Practices - Updated Guidelines",authorId:"helper-luna",authorName:"Luna ✨",timestamp:new Date(Date.now()-1728e5).toISOString(),postCount:12,lastReply:new Date(Date.now()-18e5).toISOString()},{id:"thread-002",title:"Supporting Users with Workplace Anxiety - Strategies and Resources",authorId:"admin-001",authorName:"Demo Astral Admin",timestamp:new Date(Date.now()-432e6).toISOString(),postCount:8,lastReply:new Date(Date.now()-72e5).toISOString()}]}getAIChatDemoSession(){return{id:"ai-session-001",startedAt:new Date(Date.now()-9e5).toISOString(),status:"active",messages:[{id:"ai-msg-001",sender:"user",text:"I'm feeling really anxious about a job interview tomorrow. My mind keeps racing with all the things that could go wrong.",timestamp:new Date(Date.now()-6e5).toISOString()},{id:"ai-msg-002",sender:"ai",text:"It's completely natural to feel anxious before an important interview. This shows the opportunity matters to you. Let's work through some techniques to help you feel more prepared and calm. Can you tell me what specific concerns are weighing on your mind?",timestamp:new Date(Date.now()-54e4).toISOString()},{id:"ai-msg-003",sender:"user",text:"I'm worried I'll blank out when they ask me questions, or that I'll say something wrong and embarrass myself.",timestamp:new Date(Date.now()-48e4).toISOString()},{id:"ai-msg-004",sender:"ai",text:"Those are very common interview worries. Here are some strategies that can help:\n\n1. **Practice the STAR method** (Situation, Task, Action, Result) for answering behavioral questions\n2. **Prepare 3-5 key stories** about your experiences that showcase your skills\n3. **Use box breathing**: Inhale for 4, hold for 4, exhale for 4, hold for 4\n\nWould you like to practice one of these techniques right now?",timestamp:new Date(Date.now()-42e4).toISOString()}]}}getCrisisScenarioData(){return{dilemma:{id:"crisis-001",userToken:"crisis-user-001",category:"crisis",content:"I can't take this anymore. Everything feels hopeless and I don't see the point in continuing. I've been thinking about ending it all.",timestamp:new Date(Date.now()-18e5).toISOString(),supportCount:0,isSupported:!1,isReported:!0,reportReason:"Crisis - immediate intervention needed",status:"in_progress",assignedHelperId:"helper-crisis-specialist",helperDisplayName:"Crisis Support Team"},chatMessages:[{id:"crisis-msg-001",sender:"poster",text:"I see you're going through an incredibly difficult time right now, and I want you to know that reaching out here took courage. You matter, and there are people who want to help. Can you tell me if you're in a safe place right now?",timestamp:new Date(Date.now()-15e5).toISOString()},{id:"crisis-msg-002",sender:"poster",text:"I'm connecting you with our crisis specialists and providing immediate resources. The National Suicide Prevention Lifeline is available 24/7 at 988. You don't have to go through this alone.",timestamp:new Date(Date.now()-12e5).toISOString()}]}}getInterconnectedWorkflowData(){return{userPost:{id:"workflow-dilemma-001",userToken:"demo-user-workflow",username:"Hope_Seeker_22",category:"crisis-support",content:"I've been having really dark thoughts lately and I don't know how to make them stop. Everything feels pointless and I'm wondering if people would be better off without me. I keep thinking about ways to just... not be here anymore. I don't want to feel this way but I can't see any way out.",timestamp:new Date(Date.now()-108e5).toISOString(),supportCount:0,isSupported:!1,isReported:!1,status:"crisis_detected",aiConcernLevel:"high",aiFlags:["suicidal_ideation","hopelessness","social_withdrawal"],triggerKeywords:["dark thoughts","pointless","better off without me","not be here"],riskAssessment:"immediate_intervention_required"},aiDetectionResponse:{detectionTime:new Date(Date.now()-108e5+12e4).toISOString(),confidenceScore:.94,riskLevel:"critical",flaggedConcerns:["suicidal_ideation","immediate_danger","hopelessness"],automatedActions:["Crisis specialist immediately notified","Post prioritized in helper queue","Safety resources automatically shared","Admin alerted for potential escalation"],assignedHelperId:"helper-crisis-001",helperDisplayName:"Dr. Sarah Chen - Crisis Specialist"},helperIntervention:{responderId:"helper-crisis-001",responderName:"Dr. Sarah Chen",responderCredentials:["Licensed Clinical Psychologist","Crisis Intervention Specialist","15+ years experience"],responseTime:new Date(Date.now()-108e5+48e4).toISOString(),initialResponse:"Thank you for reaching out and sharing what you're going through - that took incredible courage. I want you to know that you're not alone, and these feelings, while overwhelming right now, can change. Your life has value and meaning. I'm here to support you through this difficult time.",interventionActions:["Immediate safety assessment conducted","Crisis resources provided","Safety plan development initiated","Professional referral offered","Follow-up session scheduled"],safetyPlan:{immediateSteps:["If in immediate danger, call 988 (Suicide & Crisis Lifeline)","Reach out to trusted friend/family member","Remove any means of self-harm from immediate environment","Stay in public/safe spaces"],copingStrategies:["Deep breathing exercises (4-7-8 technique)","Grounding technique: 5-4-3-2-1 sensory awareness","Listen to calming music or favorite podcast","Take a warm shower or bath"],supportContacts:["Crisis Lifeline: 988","Crisis Text Line: Text HOME to 741741","Emergency Services: 911","Platform Crisis Support: Available 24/7"]},outcomeAssessment:"user_stabilized_accepting_help"},adminReview:{reviewerId:"admin-001",reviewerName:"Dr. Michael Torres",reviewTime:new Date(Date.now()-72e5).toISOString(),reviewType:"crisis_intervention_audit",findings:{helperResponse:"excellent_professional_appropriate",timeToResponse:"within_acceptable_range",interventionQuality:"comprehensive_effective",safetyMeasures:"all_protocols_followed",userOutcome:"positive_engagement_achieved"},adminActions:["Helper performance commended","Crisis response documented for training","User added to enhanced monitoring list","Quality assurance metrics updated","Follow-up reminder scheduled"],qualityScore:9.7,recommendedImprovements:["Consider shorter initial response time target","Add automated resource delivery enhancement"],escalationDecision:"no_further_escalation_needed",followUpRequired:!0,followUpScheduled:new Date(Date.now()+864e5).toISOString()},resolutionTracking:{outcomeId:"resolution-workflow-001",currentStatus:"stable_with_support",timeToStabilization:"2 hours 15 minutes",interventionsUsed:["Crisis counselor immediate response","Safety plan implementation","Professional referral accepted","Ongoing platform support established"],userFeedback:{rating:5,comment:"Dr. Chen saved my life. I felt heard and supported when I had nowhere else to turn. The safety plan helped me get through the worst moments, and knowing help is available 24/7 gives me hope.",wouldRecommend:!0,followUpAccepted:!0},platformMetrics:{crisisResolutionSuccess:!0,emergencyContactActivated:!1,professionalReferralCompleted:!0,userRetainedOnPlatform:!0,helperKudosReceived:!0},longTermOutcome:"user_engaging_ongoing_support"}}}getMultipleWorkflowScenarios(){return{scenario1:{userReport:{id:"violation-report-001",reportingUser:"demo-user-002",reportedHelper:"helper-boundary-violation",incidentType:"inappropriate_contact",description:"Helper shared their personal phone number and suggested meeting in person outside the platform. This made me very uncomfortable.",timestamp:new Date(Date.now()-288e5).toISOString(),evidence:["Chat logs showing personal contact sharing","Screenshot of meeting suggestion message"],reportStatus:"under_investigation"},helperPerspective:{helperId:"helper-boundary-violation",helperName:"Jake Morrison",incidentFromHelperView:"I thought I was being helpful by offering more personal support. I didn't realize this violated platform guidelines.",violationType:"professional_boundary_crossed",priorViolations:0,accountStatus:"temporarily_suspended",remedialAction:"mandatory_retraining_required"},adminResponse:{investigatingAdmin:"admin-001",investigationStarted:new Date(Date.now()-216e5).toISOString(),investigationFindings:["Clear boundary violation confirmed","User safety compromised","Helper training deficiency identified","No malicious intent detected"],actionsTaken:["Helper temporarily suspended","Mandatory retraining scheduled","User provided additional support","Platform guidelines clarified","Monitoring increased for this helper"],resolutionTime:"4 hours 30 minutes",outcome:"violation_confirmed_training_required"}},scenario2:{communityPost:{id:"flagged-content-001",authorId:"user-problematic-001",category:"general_discussion",content:"I found a way to get prescription medication without seeing a doctor. DM me if you want to know how. These doctors don't understand what we really need.",timestamp:new Date(Date.now()-432e5).toISOString(),flags:["illegal_activity","medication_advice","safety_concern"],reportCount:7,reportReasons:["Promoting illegal activity","Unsafe medical advice","Community safety"]},helperModeration:{moderatingHelper:"helper-moderator-001",moderatorName:"Lisa Rodriguez",reviewTime:new Date(Date.now()-396e5).toISOString(),moderationDecision:"remove_and_escalate",justification:"Content promotes illegal medication acquisition and poses serious safety risks to community members",immediateActions:["Post removed from community","User notified of violation","Case escalated to admin team","Similar content scan initiated"],riskAssessment:"high_community_safety_risk"},adminPolicyResponse:{reviewingAdmin:"admin-001",escalationReview:new Date(Date.now()-36e6).toISOString(),policyImplications:["Medication advice guidelines need strengthening","Automated detection filters require enhancement","Helper training modules need updating"],systemChanges:["Enhanced keyword detection for medication-related content","Automatic escalation for drug-related posts","Community guidelines updated","Helper training curriculum revised"],preventiveMeasures:["Proactive content scanning implemented","Educational resources about medication safety added","Community awareness campaign launched"],outcome:"policy_strengthened_prevention_improved"}},scenario3:{successStory:{userId:"user-success-001",username:"GrowingStronger",journeyDuration:"6 months",initialState:"severe_anxiety_depression_isolation",supportReceived:["Regular sessions with certified helper Dr. Amanda","Peer support group participation","Crisis intervention during difficult periods","Resource library utilization","Community engagement growth"],currentState:"stable_managing_well_helping_others",testimonal:"Six months ago I could barely leave my house. Now I'm not only managing my anxiety but I'm here supporting others. This platform literally saved my life and gave me purpose.",metricsImprovement:{anxietyReduction:"70%",depressionImprovement:"65%",socialConnection:"300% increase",selfEfficacy:"80% improvement",qualityOfLife:"85% improvement"}},helperRecognition:{helperId:"helper-amanda-success",helperName:"Dr. Amanda Rodriguez",caseOutcome:"exceptional_success",clientProgress:"transformational_recovery",supportQuality:"exemplary_professional_caring",recognition:["Helper of the Month award","Case study selected for training materials","Peer recognition from helper community","Client testimonial featured"],platformImpact:"demonstrates_platform_effectiveness"},adminAnalysis:{analysisType:"success_case_study",keyFactors:["Consistent long-term support relationship","Multi-modal platform feature utilization","Effective crisis intervention when needed","Community integration and peer support","Resource accessibility and engagement"],platformInsights:["Long-term helper relationships drive better outcomes","Crisis support safety net enables risk-taking in growth","Community connection accelerates recovery","Resource variety meets diverse learning styles"],implementedImprovements:["Helper continuity program enhanced","Community connection features expanded","Crisis support protocols refined","Success milestone tracking added"],outcomeForPlatform:"evidence_based_feature_enhancement"}}}}initializeDemoData(e,t){const i={},n=this.getInterconnectedWorkflowData(),s=this.getMultipleWorkflowScenarios(),r=this.getCrisisEscalationScenarios();return"user"===e?(i.journalEntries=this.getStarkeeperJournalEntries(t),i.moodCheckIns=this.getStarkeeperMoodCheckIns(t),i.dilemmas=this.getStarkeeperDilemmas(t),i.assessments=this.getStarkeeperAssessments(t),i.workflowExample={myPost:n.userPost,helperSupport:n.helperIntervention,safetyPlan:n.helperIntervention.safetyPlan,myFeedback:n.resolutionTracking.userFeedback,ongoingSupport:n.resolutionTracking},i.platformExamples={crisisSupport:n,boundaryProtection:s.scenario1.userReport,communityGuidelines:s.scenario2.communityPost,successStory:s.scenario3.successStory},i.crisisScenarios={suicidalCrisis:{myPost:r.immediateRisk.userPost,helpReceived:r.immediateRisk.helperResponse,safetyPlan:r.immediateRisk.helperResponse.safetyInterventions,outcome:r.immediateRisk.resolutionTracking},domesticViolenceCrisis:{myPost:r.domesticViolence.userPost,helpReceived:r.domesticViolence.helperResponse,safetyPlan:r.domesticViolence.helperResponse.safetyActions,outcome:r.domesticViolence.resolutionTracking},substanceCrisis:{myPost:r.substanceAbuseCrisis.userPost,helpReceived:r.substanceAbuseCrisis.helperResponse,medicalSupport:r.substanceAbuseCrisis.helperResponse.medicalGuidance,outcome:r.substanceAbuseCrisis.resolutionTracking}}):"helper"===e?(i.profile=this.getConstellationGuideProfile(),i.chatSessions=this.getHelperChatSessions(),i.helpSessions=this.getHelperSessions(),i.allDilemmas=this.getAllDilemmasForHelper(),i.workflowExample={crisisAlert:n.userPost,aiDetection:n.aiDetectionResponse,myIntervention:n.helperIntervention,adminReview:n.adminReview,outcome:n.resolutionTracking},i.helperScenarios={crisisIntervention:n.helperIntervention,boundaryTraining:s.scenario1.helperPerspective,contentModeration:s.scenario2.helperModeration,successRecognition:s.scenario3.helperRecognition},i.crisisInterventions={suicideIntervention:{crisisAlert:r.immediateRisk.userPost,aiAssessment:r.immediateRisk.aiDetection,myResponse:r.immediateRisk.helperResponse,adminBackup:r.immediateRisk.adminEscalation,outcome:r.immediateRisk.resolutionTracking},domesticViolenceIntervention:{crisisAlert:r.domesticViolence.userPost,aiAssessment:r.domesticViolence.aiDetection,myResponse:r.domesticViolence.helperResponse,adminBackup:r.domesticViolence.adminEscalation,outcome:r.domesticViolence.resolutionTracking},medicalEmergencyIntervention:{crisisAlert:r.substanceAbuseCrisis.userPost,aiAssessment:r.substanceAbuseCrisis.aiDetection,myResponse:r.substanceAbuseCrisis.helperResponse,adminBackup:r.substanceAbuseCrisis.adminEscalation,outcome:r.substanceAbuseCrisis.resolutionTracking}}):"admin"===e&&(i.profile=this.getAstralAdminProfile(),i.helperApplications=this.getAdminHelperApplications(),i.moderationActions=this.getAdminModerationActions(),i.communityStats=this.getAdminCommunityStats(),i.workflowExample={incidentOverview:n.userPost,aiSystem:n.aiDetectionResponse,helperResponse:n.helperIntervention,myReview:n.adminReview,systemMetrics:n.resolutionTracking.platformMetrics,qualityAssurance:n.adminReview.findings},i.adminOversight={crisisManagement:n.adminReview,boundaryEnforcement:s.scenario1.adminResponse,policyDevelopment:s.scenario2.adminPolicyResponse,successAnalysis:s.scenario3.adminAnalysis},i.crisisManagement={suicideCrisisOversight:{incident:r.immediateRisk.userPost,aiSystem:r.immediateRisk.aiDetection,helperResponse:r.immediateRisk.helperResponse,myEscalation:r.immediateRisk.adminEscalation,systemMetrics:r.immediateRisk.resolutionTracking},domesticViolenceCrisisOversight:{incident:r.domesticViolence.userPost,aiSystem:r.domesticViolence.aiDetection,helperResponse:r.domesticViolence.helperResponse,myEscalation:r.domesticViolence.adminEscalation,systemMetrics:r.domesticViolence.resolutionTracking},medicalEmergencyCrisisOversight:{incident:r.substanceAbuseCrisis.userPost,aiSystem:r.substanceAbuseCrisis.aiDetection,helperResponse:r.substanceAbuseCrisis.helperResponse,myEscalation:r.substanceAbuseCrisis.adminEscalation,systemMetrics:r.substanceAbuseCrisis.resolutionTracking}}),i.communityReflections=this.getCommunityReflections(),i.forumThreads=this.getForumThreads(),i.aiChatSession=this.getAIChatDemoSession(),i.crisisScenario=this.getCrisisScenarioData(),localStorage.setItem(`demo_data_${e}`,JSON.stringify(i)),i}getDemoData(e){try{const t=localStorage.getItem(`demo_data_${e}`);if(t)try{return JSON.parse(t)}catch(i){}}catch(n){}let t="demo-token-"+Date.now();try{const e=localStorage.getItem("demo_user");if(e){const i=JSON.parse(e);i&&i.sub&&(t=i.sub)}}catch(s){}return this.initializeDemoData(e,t)}clearDemoData(){localStorage.removeItem("demo_data_user"),localStorage.removeItem("demo_data_helper"),localStorage.removeItem("demo_data_admin")}getCrisisEscalationScenarios(){return{immediateRisk:{userPost:{id:"crisis-immediate-001",userToken:"user-crisis-immediate",username:"desperateforanswers_92",category:"crisis-support",content:"I can't do this anymore. I have pills saved up and tonight feels like the right time. I've written letters to everyone. My family will be better off without the burden of dealing with me. I just wanted to say goodbye to this community that tried to help.",timestamp:new Date(Date.now()-3e5).toISOString(),supportCount:0,isSupported:!1,isReported:!1,status:"critical_crisis_detected",aiFlags:["suicide_plan","means_available","imminent_danger","goodbye_message"],riskLevel:"critical",urgencyScore:10},aiDetection:{detectionTime:new Date(Date.now()-27e4).toISOString(),algorithm:"Advanced Crisis Detection v3.2",confidenceScore:.98,riskFactors:["Specific method mentioned (pills)","Expressed intent with timeline (tonight)","Farewell behavior (letters written)","Burden narrative (family better off)","Finality language (goodbye message)"],automatedActions:["Crisis alert to all available specialists","Emergency contact protocol activated","Content flagged for immediate intervention","User IP geo-location for emergency services","Admin escalation triggered automatically"],estimatedTimeToAct:"15-30 minutes based on post language"},helperResponse:{responderId:"helper-crisis-specialist-001",responderName:"Dr. Emma Williams",credentials:["Licensed Clinical Psychologist","Crisis Intervention Specialist","Suicide Prevention Certified"],responseTime:new Date(Date.now()-18e4).toISOString(),urgencyProtocol:"Level 1 - Imminent Danger",initialResponse:"I can see you're in tremendous pain right now, and I'm so glad you reached out here. Your life has value and meaning, even when it doesn't feel that way. I'm a crisis specialist and I'm here with you right now. Please don't take those pills tonight. Can you help me understand what's making tonight feel different?",immediateActions:["Private crisis chat initiated","Emergency protocols activated","Safety plan deployment","Crisis lifeline numbers provided","Emergency contact authorization requested"],safetyInterventions:["Pills removal from immediate area","Crisis hotline: 988 Suicide & Crisis Lifeline","Text support: HOME to 741741","Emergency services: 911 if immediate danger","Trusted person notification"],riskMitigation:"Active engagement, safety contracting, means restriction"},adminEscalation:{escalatedBy:"helper-crisis-specialist-001",reviewingAdmin:"admin-crisis-001",adminName:"Dr. Michael Torres - Crisis Director",escalationTime:new Date(Date.now()-12e4).toISOString(),escalationReason:"Imminent danger with specific plan and means",emergencyProtocols:["Emergency services notification prepared","Crisis team assembly activated","Legal emergency contact override authorized","Platform crisis mode engaged","Follow-up intervention scheduled"],legalActions:"Emergency contact authorization under crisis intervention protocols",resourcesDeployed:["Crisis specialist team (3 helpers assigned)","Emergency counselor on standby","Legal emergency contact procedures","Local crisis center notification","24-hour monitoring activated"]},resolutionTracking:{currentStatus:"crisis_stabilized_monitoring",timeToStabilization:"47 minutes",interventionSuccess:!0,emergencyServicesContacted:!1,safetyPlanImplemented:!0,ongoingSupport:"Intensive 72-hour monitoring with daily check-ins",outcome:"User agreed to remove pills, contacted trusted friend, emergency contact notified, professional referral accepted",followUpScheduled:["2-hour safety check-in","24-hour crisis counselor session","72-hour platform welfare check","Weekly therapy referral appointment"]}},domesticViolence:{userPost:{id:"crisis-dv-002",userToken:"user-dv-crisis",username:"scared_but_trying",category:"crisis-support",content:"He found my phone and saw I was getting help here. He's escalating and I'm scared for tonight. He took my car keys and I can't leave. My kids are asleep upstairs. I don't know what to do. If something happens to me, please know this community gave me hope when I had none.",timestamp:new Date(Date.now()-9e5).toISOString(),supportCount:2,isSupported:!1,isReported:!0,status:"safety_crisis_detected",aiFlags:["domestic_violence","immediate_danger","children_involved","isolation_tactics"],riskLevel:"high",urgencyScore:9},aiDetection:{detectionTime:new Date(Date.now()-84e4).toISOString(),algorithm:"Domestic Violence Crisis Detection v2.1",confidenceScore:.94,riskFactors:["Escalating abuser behavior","Physical isolation (keys taken)","Children present in dangerous situation","Fear for immediate safety","Potential goodbye message"],automatedActions:["Domestic violence specialist notified","Safety planning resources deployed","Local DV hotline information provided","Emergency exit strategy resources","Admin crisis team alerted"]},helperResponse:{responderId:"helper-dv-specialist-001",responderName:"Maria Santos, LCSW",credentials:["Licensed Clinical Social Worker","Domestic Violence Specialist","Child Safety Advocate"],responseTime:new Date(Date.now()-78e4).toISOString(),urgencyProtocol:"Level 2 - Immediate Safety Risk",initialResponse:"I'm here with you and I believe you. This is not your fault. Your safety and your children's safety are the priority. Do you have a safe room you can go to right now? I'm going to share some immediate safety resources and we'll work through this together.",safetyActions:["Immediate safety planning activated","DV hotline: 1-800-799-7233 provided","Local shelter information shared","Safety bag checklist provided","Emergency contact strategy discussed"],emergencyResources:["National DV Hotline with text option","Local shelter with immediate availability","Legal advocacy resources","Child protective safety planning","Emergency transportation assistance"]},adminEscalation:{escalatedBy:"helper-dv-specialist-001",reviewingAdmin:"admin-safety-001",adminName:"Sarah Chen - Safety Operations Director",escalationTime:new Date(Date.now()-6e5).toISOString(),escalationReason:"Children at risk, immediate physical danger",emergencyProtocols:["Child protection services consultation","Local law enforcement liaison","Emergency shelter coordination","Legal advocacy team notification","Crisis intervention team deployment"],legalConsiderations:"Mandatory reporting protocols for children at risk",resourcesDeployed:["DV crisis team (2 specialists)","Child safety advocate","Emergency shelter coordination","Legal advocacy referral","Transportation assistance network"]},resolutionTracking:{currentStatus:"emergency_safety_plan_implemented",timeToSafetyPlan:"25 minutes",interventionSuccess:!0,emergencyServicesContacted:!0,safetyPlanImplemented:!0,outcome:"User and children safely relocated to shelter, police welfare check completed, legal advocacy initiated",followUpScheduled:["Daily safety check-ins for 1 week","Legal advocacy appointment scheduled","Counseling for children arranged","Long-term safety planning session"]}},substanceAbuseCrisis:{userPost:{id:"crisis-substance-003",userToken:"user-substance-crisis",username:"trying_to_recover",category:"crisis-support",content:"I relapsed after 6 months clean and I took way too much. My heart is racing and I can't stop shaking. I'm scared I'm overdosing but I can't call anyone because I'll lose my job and my family will disown me. I don't want to die but I don't know what to do.",timestamp:new Date(Date.now()-48e4).toISOString(),supportCount:1,isSupported:!1,isReported:!1,status:"medical_crisis_detected",aiFlags:["overdose_symptoms","medical_emergency","fear_of_consequences","immediate_danger"],riskLevel:"critical",urgencyScore:10},aiDetection:{detectionTime:new Date(Date.now()-45e4).toISOString(),algorithm:"Medical Emergency Detection v1.8",confidenceScore:.96,riskFactors:["Physical overdose symptoms described","Fear preventing emergency contact","Substance relapse with quantity concern","Medical distress indicators","Isolation due to stigma"],automatedActions:["Medical emergency specialist notified","Overdose prevention resources provided","Emergency medical guidance initiated","Crisis medical team alerted","Harm reduction resources deployed"]},helperResponse:{responderId:"helper-medical-crisis-001",responderName:"Dr. James Rodriguez, MD",credentials:["Emergency Medicine Physician","Addiction Medicine Specialist","Crisis Intervention Certified"],responseTime:new Date(Date.now()-39e4).toISOString(),urgencyProtocol:"Level 1 - Medical Emergency",initialResponse:"This is a medical emergency and you need immediate help. Your life is more important than any job or relationship. Please call 911 or go to the nearest emergency room right now. I'm a doctor and I can tell you that what you're describing sounds like you need medical attention immediately. Your family and job can be dealt with later - right now we need to keep you alive.",medicalGuidance:["Immediate 911 call strongly advised","Stay awake and try to stay calm","If you have someone nearby, ask them to stay with you","Do not take any more substances","Try to remember what and how much you took"],emergencyActions:["Medical emergency protocol activated","Emergency services coordination offered","Poison control center information provided","Emergency room escort service offered","Family notification support offered"]},adminEscalation:{escalatedBy:"helper-medical-crisis-001",reviewingAdmin:"admin-medical-001",adminName:"Dr. Lisa Park - Medical Crisis Director",escalationTime:new Date(Date.now()-3e5).toISOString(),escalationReason:"Life-threatening medical emergency, overdose symptoms",emergencyProtocols:["Emergency medical services coordination","Hospital emergency department notification","Crisis medical team deployment","Family notification protocols","Employment protection advocacy"],medicalProtocols:"Emergency overdose intervention, medical stabilization, addiction crisis support",resourcesDeployed:["Emergency medical specialist team","Hospital emergency coordination","Addiction counselor on standby","Employment rights advocate","Family support services"]},resolutionTracking:{currentStatus:"medical_emergency_resolved",timeToEmergencyServices:"12 minutes",interventionSuccess:!0,emergencyServicesContacted:!0,medicalTreatmentReceived:!0,outcome:"User transported to emergency room, medically stabilized, addiction treatment referral completed, employment protection advocacy initiated",followUpScheduled:["Daily recovery check-ins for 2 weeks","Addiction counselor appointment scheduled","Employment rights consultation","Family support session arranged","Relapse prevention planning"]}}}}getWellnessChallenges(){return[{id:"challenge-mindfulness-001",title:"30-Day Mindful Moments",description:"Discover the power of mindfulness with daily 5-minute practices. Each day brings a new technique to help ground yourself and find inner peace.",category:"mindfulness",duration:30,startDate:new Date(Date.now()-1296e6).toISOString(),endDate:new Date(Date.now()+1296e6).toISOString(),createdBy:"helper-wellness-001",createdByName:"Luna Martinez, Mindfulness Coach",participants:[{userId:"user-mindful-001",username:"PeacefulJourney23",joinedDate:new Date(Date.now()-10368e5).toISOString(),currentStreak:12,totalDaysCompleted:12,isActive:!0},{userId:"user-mindful-002",username:"SerenitySeeker",joinedDate:new Date(Date.now()-864e6).toISOString(),currentStreak:8,totalDaysCompleted:10,isActive:!0},{userId:"user-mindful-003",username:"CalmWaters88",joinedDate:new Date(Date.now()-6912e5).toISOString(),currentStreak:6,totalDaysCompleted:8,isActive:!0}],dailyPrompts:[{day:1,title:"Breath Awareness",description:"Spend 5 minutes focusing solely on your natural breath. Notice the sensation of air entering and leaving your body.",type:"mindfulness",estimatedTime:"5 minutes"},{day:2,title:"Body Scan Meditation",description:"Slowly scan your body from head to toe, noticing any sensations without judgment.",type:"mindfulness",estimatedTime:"7 minutes"},{day:3,title:"Mindful Walking",description:"Take a slow, deliberate walk, focusing on each step and the feeling of your feet touching the ground.",type:"action",estimatedTime:"10 minutes"}],status:"active",isPublic:!0,tags:["mindfulness","meditation","stress-relief","beginner-friendly"]},{id:"challenge-gratitude-002",title:"Gratitude Garden - 21 Days",description:"Cultivate an attitude of gratitude by identifying and reflecting on three things you're grateful for each day. Watch your perspective bloom!",category:"gratitude",duration:21,startDate:new Date(Date.now()-6048e5).toISOString(),endDate:new Date(Date.now()+12096e5).toISOString(),createdBy:"helper-gratitude-001",createdByName:"Emma Chen, Positive Psychology Specialist",participants:[{userId:"user-grateful-001",username:"SunshineSpirit",joinedDate:new Date(Date.now()-5184e5).toISOString(),currentStreak:6,totalDaysCompleted:6,isActive:!0},{userId:"user-grateful-002",username:"ThankfulHeart92",joinedDate:new Date(Date.now()-432e6).toISOString(),currentStreak:5,totalDaysCompleted:5,isActive:!0}],dailyPrompts:[{day:1,title:"Simple Joys",description:"Identify three simple things that brought you joy today. They can be as small as a warm cup of coffee or a smile from a stranger.",type:"gratitude",estimatedTime:"5 minutes"},{day:2,title:"People in Your Life",description:"Think of three people you're grateful for and why. Consider sending one of them a message of appreciation.",type:"reflection",estimatedTime:"8 minutes"},{day:3,title:"Personal Strengths",description:"Reflect on three personal qualities or strengths you're grateful to possess. How have they helped you recently?",type:"reflection",estimatedTime:"10 minutes"}],status:"active",isPublic:!0,tags:["gratitude","positivity","reflection","mood-boost"]},{id:"challenge-creativity-003",title:"Creative Expression Journey",description:"Explore different forms of creative expression to boost mood and self-discovery. No artistic experience required - just an open heart!",category:"creativity",duration:14,startDate:new Date(Date.now()+1728e5).toISOString(),endDate:new Date(Date.now()+13824e5).toISOString(),createdBy:"helper-creative-001",createdByName:"Alex Rivera, Art Therapist",participants:[{userId:"user-creative-001",username:"ColorfulSoul",joinedDate:new Date(Date.now()-864e5).toISOString(),currentStreak:0,totalDaysCompleted:0,isActive:!0}],dailyPrompts:[{day:1,title:"Emotion Doodling",description:"Draw or doodle how you're feeling right now. Don't worry about it looking \"good\" - just let your emotions flow onto paper.",type:"creative",estimatedTime:"15 minutes"},{day:2,title:"Poetry of the Moment",description:"Write a short poem (even just 4 lines) about something you noticed today. Focus on imagery and feeling rather than perfect rhymes.",type:"creative",estimatedTime:"10 minutes"}],status:"upcoming",isPublic:!0,tags:["creativity","art-therapy","self-expression","mood-boost"]}]}getGroupDiscussions(){return[{id:"discussion-anxiety-001",title:"Managing Anxiety in Daily Life",description:"A supportive space to share practical strategies for managing anxiety, from breathing techniques to lifestyle adjustments. All levels of experience welcome.",category:"support",hostId:"helper-anxiety-001",hostName:"Dr. Jennifer Walsh",hostType:"helper",participants:[{userId:"user-anxiety-001",username:"BreatheEasy23",userType:"starkeeper",joinedDate:new Date(Date.now()-432e6).toISOString(),isActive:!0,lastSeen:new Date(Date.now()-72e5).toISOString()},{userId:"user-anxiety-002",username:"CalmMind88",userType:"starkeeper",joinedDate:new Date(Date.now()-2592e5).toISOString(),isActive:!0,lastSeen:new Date(Date.now()-18e5).toISOString()},{userId:"helper-peer-001",username:"PeerSupporter_Maria",userType:"helper",joinedDate:new Date(Date.now()-6048e5).toISOString(),isActive:!0,lastSeen:new Date(Date.now()-6e5).toISOString()}],messages:[{id:"msg-anxiety-001",senderId:"helper-anxiety-001",senderName:"Dr. Jennifer Walsh",senderType:"helper",content:"Welcome everyone! Let's start by sharing one small victory you've had this week in managing your anxiety. Remember, no victory is too small to celebrate.",timestamp:new Date(Date.now()-72e5).toISOString(),reactions:[{type:"heart",count:5,users:["user-anxiety-001","user-anxiety-002","helper-peer-001"]}],isSupported:!0,supportCount:5},{id:"msg-anxiety-002",senderId:"user-anxiety-001",senderName:"BreatheEasy23",senderType:"starkeeper",content:"I actually used the 4-7-8 breathing technique before a meeting this week and it really helped! I felt so much more centered going in.",timestamp:new Date(Date.now()-54e5).toISOString(),reactions:[{type:"light",count:3,users:["helper-anxiety-001","user-anxiety-002","helper-peer-001"]},{type:"strength",count:2,users:["helper-anxiety-001","helper-peer-001"]}],isSupported:!0,supportCount:8},{id:"msg-anxiety-003",senderId:"helper-peer-001",senderName:"PeerSupporter_Maria",senderType:"helper",content:"That's wonderful, @BreatheEasy23! The 4-7-8 technique is so powerful. I love how you prepared yourself before the meeting - that's such good self-care.",timestamp:new Date(Date.now()-51e5).toISOString(),reactions:[{type:"heart",count:4,users:["user-anxiety-001","user-anxiety-002","helper-anxiety-001"]}],isSupported:!0,supportCount:6},{id:"msg-anxiety-004",senderId:"user-anxiety-002",senderName:"CalmMind88",senderType:"starkeeper",content:"I've been struggling with morning anxiety lately. Does anyone have tips for starting the day feeling more grounded?",timestamp:new Date(Date.now()-27e5).toISOString(),reactions:[{type:"hug",count:6,users:["helper-anxiety-001","user-anxiety-001","helper-peer-001"]}],isSupported:!0,supportCount:6}],scheduledDate:new Date(Date.now()+864e5).toISOString(),duration:60,isRecurring:!0,recurrencePattern:"weekly",status:"active",isPrivate:!1,maxParticipants:12,tags:["anxiety","coping-strategies","peer-support","weekly"]},{id:"discussion-recovery-002",title:"Recovery Stories: Sharing Hope",description:"A space for those in recovery to share their journey, milestones, and insights. Whether you're just starting or years into recovery, your story matters.",category:"recovery",hostId:"helper-recovery-001",hostName:"Michael Chen, Recovery Counselor",hostType:"helper",participants:[{userId:"user-recovery-001",username:"PhoenixRising",userType:"starkeeper",joinedDate:new Date(Date.now()-864e6).toISOString(),isActive:!0,lastSeen:new Date(Date.now()-144e5).toISOString()},{userId:"user-recovery-002",username:"OneDay_AtATime",userType:"starkeeper",joinedDate:new Date(Date.now()-6912e5).toISOString(),isActive:!0,lastSeen:new Date(Date.now()-36e5).toISOString()}],messages:[{id:"msg-recovery-001",senderId:"user-recovery-001",senderName:"PhoenixRising",senderType:"starkeeper",content:"Today marks 6 months clean for me. Some days are still hard, but I'm learning to celebrate these milestones. Each day I choose recovery is a victory.",timestamp:new Date(Date.now()-108e5).toISOString(),reactions:[{type:"strength",count:8,users:["helper-recovery-001","user-recovery-002"]},{type:"star",count:5,users:["helper-recovery-001","user-recovery-002"]}],isSupported:!0,supportCount:15},{id:"msg-recovery-002",senderId:"helper-recovery-001",senderName:"Michael Chen",senderType:"helper",content:"6 months is incredible, @PhoenixRising! Your commitment to your recovery is inspiring. How are you celebrating this milestone?",timestamp:new Date(Date.now()-9e6).toISOString(),reactions:[{type:"heart",count:3,users:["user-recovery-001","user-recovery-002"]}],isSupported:!0,supportCount:4}],scheduledDate:new Date(Date.now()+2592e5).toISOString(),duration:90,isRecurring:!0,recurrencePattern:"weekly",status:"scheduled",isPrivate:!0,maxParticipants:8,tags:["recovery","addiction","peer-support","hope","milestones"]},{id:"discussion-social-003",title:"Building Healthy Relationships",description:"Explore strategies for building and maintaining healthy relationships, setting boundaries, and improving communication skills in a supportive environment.",category:"social",hostId:"helper-relationships-001",hostName:"Dr. Sarah Kim, Relationship Therapist",hostType:"helper",participants:[{userId:"user-social-001",username:"BoundaryBuilder",userType:"starkeeper",joinedDate:new Date(Date.now()-1728e5).toISOString(),isActive:!0,lastSeen:new Date(Date.now()-216e5).toISOString()}],messages:[{id:"msg-social-001",senderId:"helper-relationships-001",senderName:"Dr. Sarah Kim",senderType:"helper",content:"This week, let's talk about the difference between being helpful and being enabling. How do we support others while maintaining healthy boundaries?",timestamp:new Date(Date.now()-288e5).toISOString(),reactions:[{type:"light",count:2,users:["user-social-001"]}],isSupported:!0,supportCount:3}],scheduledDate:new Date(Date.now()+432e6).toISOString(),duration:75,isRecurring:!0,recurrencePattern:"biweekly",status:"scheduled",isPrivate:!1,maxParticipants:10,tags:["relationships","boundaries","communication","self-care"]}]}getCommunityForumPosts(){return[{id:"forum-anxiety-tips-001",title:"Daily Anxiety Management - What's Working for You?",description:"Share your go-to strategies for managing anxiety day-to-day. Looking for practical tips I can use when things get overwhelming.",category:"anxiety-support",authorId:"user-forum-001",authorName:"SeekingCalm",authorType:"starkeeper",timestamp:new Date(Date.now()-216e5).toISOString(),replyCount:8,supportCount:12,lastActivity:new Date(Date.now()-72e5).toISOString(),tags:["anxiety","coping-strategies","daily-life"],isSticky:!1,isLocked:!1,responses:[{id:"reply-anxiety-001",authorId:"helper-anxiety-peer-001",authorName:"CalmingPresence",authorType:"helper",content:"The 5-4-3-2-1 grounding technique has been a game-changer for me: 5 things you can see, 4 you can touch, 3 you can hear, 2 you can smell, 1 you can taste. It brings me back to the present moment when my thoughts spiral.",timestamp:new Date(Date.now()-18e6).toISOString(),supportCount:6,isSupported:!0},{id:"reply-anxiety-002",authorId:"user-forum-002",authorName:"BreatheDeep22",authorType:"starkeeper",content:"I keep a 'worry time' - 15 minutes each day where I allow myself to worry about everything, then I close that mental door. It helps me not carry anxiety all day long.",timestamp:new Date(Date.now()-144e5).toISOString(),supportCount:4,isSupported:!0},{id:"reply-anxiety-003",authorId:"helper-professional-001",authorName:"Dr. Elena Rodriguez",authorType:"helper",content:"These are wonderful strategies! I'd also add that progressive muscle relaxation can be very effective. Start with your toes and work your way up, tensing and then relaxing each muscle group. It helps release physical tension that often accompanies anxiety.",timestamp:new Date(Date.now()-72e5).toISOString(),supportCount:5,isSupported:!0}]},{id:"forum-recovery-celebrate-002",title:"Small Wins Worth Celebrating 🌟",description:"Recovery isn't just about the big milestones - it's made up of countless small victories. What small win are you celebrating today?",category:"recovery-support",authorId:"user-recovery-forum-001",authorName:"StepByStep",authorType:"starkeeper",timestamp:new Date(Date.now()-432e5).toISOString(),replyCount:15,supportCount:23,lastActivity:new Date(Date.now()-36e5).toISOString(),tags:["recovery","milestones","celebration","progress"],isSticky:!0,isLocked:!1,responses:[{id:"reply-recovery-001",authorId:"user-recovery-forum-002",authorName:"NewBeginnings",authorType:"starkeeper",content:"I went to a social event last night and didn't feel the urge to drink! Instead, I enjoyed meaningful conversations and woke up clear-headed this morning. Feels amazing.",timestamp:new Date(Date.now()-36e6).toISOString(),supportCount:8,isSupported:!0},{id:"reply-recovery-002",authorId:"helper-recovery-peer-001",authorName:"SoberStrong",authorType:"helper",content:"That's incredible @NewBeginnings! Those first social events can be challenging. You should be so proud of yourself for staying true to your recovery and still having a good time.",timestamp:new Date(Date.now()-324e5).toISOString(),supportCount:6,isSupported:!0},{id:"reply-recovery-003",authorId:"user-recovery-forum-003",authorName:"GratefulHeart",authorType:"starkeeper",content:"I called my sponsor when I was feeling triggered instead of isolating. It was hard to reach out, but I'm so glad I did. Connection is healing.",timestamp:new Date(Date.now()-216e5).toISOString(),supportCount:9,isSupported:!0}]},{id:"forum-daily-checkin-003",title:"Daily Check-in: How are you feeling today?",description:"A safe space to share how you're doing today - the good, the challenging, and everything in between. No judgment, just support.",category:"daily-support",authorId:"moderator-checkin-001",authorName:"Community Guide Alex",authorType:"moderator",timestamp:new Date(Date.now()-288e5).toISOString(),replyCount:22,supportCount:31,lastActivity:new Date(Date.now()-18e5).toISOString(),tags:["daily-checkin","emotional-support","community"],isSticky:!0,isLocked:!1,responses:[{id:"reply-checkin-001",authorId:"user-checkin-001",authorName:"MorningLight",authorType:"starkeeper",content:"Feeling cautiously optimistic today. Had a rough patch last week, but I'm taking things one moment at a time and focusing on self-compassion.",timestamp:new Date(Date.now()-216e5).toISOString(),supportCount:7,isSupported:!0},{id:"reply-checkin-002",authorId:"user-checkin-002",authorName:"QuietStrength",authorType:"starkeeper",content:"Struggling with some old thought patterns today, but I'm grateful for this community. Just knowing others understand makes a difference.",timestamp:new Date(Date.now()-144e5).toISOString(),supportCount:12,isSupported:!0},{id:"reply-checkin-003",authorId:"helper-support-001",authorName:"CompassionateHelper",authorType:"helper",content:"@QuietStrength - sending you strength today. Those old patterns are tough, but recognizing them is such an important step. You're not alone in this. 💙",timestamp:new Date(Date.now()-108e5).toISOString(),supportCount:8,isSupported:!0}]},{id:"forum-relationships-boundaries-004",title:"Learning to Say No: Boundary Setting Tips",description:"I'm working on setting healthier boundaries but struggle with guilt when I say no. How do you balance being helpful with taking care of yourself?",category:"relationships",authorId:"user-boundaries-001",authorName:"LearningToChoose",authorType:"starkeeper",timestamp:new Date(Date.now()-648e5).toISOString(),replyCount:11,supportCount:18,lastActivity:new Date(Date.now()-144e5).toISOString(),tags:["boundaries","relationships","self-care","guilt"],isSticky:!1,isLocked:!1,responses:[{id:"reply-boundaries-001",authorId:"helper-boundaries-001",authorName:"Dr. Michelle Park",authorType:"helper",content:"Boundary guilt is so common! Remember that saying no to one thing means saying yes to something else - often your own well-being. You can't pour from an empty cup.",timestamp:new Date(Date.now()-576e5).toISOString(),supportCount:9,isSupported:!0},{id:"reply-boundaries-002",authorId:"user-boundaries-002",authorName:"BoundaryBuilder88",authorType:"starkeeper",content:"I started with small nos first - like declining optional social events when I was exhausted. It helped me practice the skill before bigger situations came up.",timestamp:new Date(Date.now()-432e5).toISOString(),supportCount:6,isSupported:!0}]},{id:"forum-wellness-habits-005",title:"Building Sustainable Wellness Habits",description:"What small, daily habits have made the biggest difference in your mental health? Looking for realistic practices I can actually stick with.",category:"wellness",authorId:"user-wellness-001",authorName:"SmallSteps",authorType:"starkeeper",timestamp:new Date(Date.now()-864e5).toISOString(),replyCount:19,supportCount:26,lastActivity:new Date(Date.now()-216e5).toISOString(),tags:["wellness","habits","self-care","routine"],isSticky:!1,isLocked:!1,responses:[{id:"reply-wellness-001",authorId:"user-wellness-002",authorName:"MindfulMornings",authorType:"starkeeper",content:"I started with just 2 minutes of deep breathing every morning before I even get out of bed. It's grown into a fuller meditation practice, but starting tiny was key.",timestamp:new Date(Date.now()-72e6).toISOString(),supportCount:8,isSupported:!0},{id:"reply-wellness-002",authorId:"helper-wellness-001",authorName:"WellnessGuide_Sam",authorType:"helper",content:"The 'two-minute rule' is powerful! Any habit can be started in 2 minutes or less. Read one page, write one sentence in a journal, do one sun salutation. Small consistency beats large inconsistency every time.",timestamp:new Date(Date.now()-54e6).toISOString(),supportCount:11,isSupported:!0}]}]}getCommunityEvents(){return[{id:"event-mindfulness-workshop-001",title:"Introduction to Mindfulness for Beginners",description:"A gentle introduction to mindfulness practices designed specifically for those dealing with anxiety and stress. No experience necessary - just bring an open mind and comfortable clothes.",type:"workshop",hostId:"helper-mindfulness-001",hostName:"Luna Martinez, Certified Mindfulness Instructor",startTime:new Date(Date.now()+2592e5).toISOString(),endTime:new Date(Date.now()+2592e5+54e5).toISOString(),timezone:"PST",maxParticipants:15,currentParticipants:[{userId:"user-mindful-event-001",username:"SeekingPeace",registeredDate:new Date(Date.now()-1728e5).toISOString(),attended:!1},{userId:"user-mindful-event-002",username:"CalmSeeker99",registeredDate:new Date(Date.now()-864e5).toISOString(),attended:!1},{userId:"user-mindful-event-003",username:"AnxiousNoMore",registeredDate:new Date(Date.now()-288e5).toISOString(),attended:!1}],isVirtual:!0,meetingLink:"https://astralcore.meeting/mindfulness-intro",resources:[{id:"resource-mindful-001",title:"Beginner's Guide to Breathing Exercises",type:"document",url:"/resources/breathing-guide.pdf",description:"Simple breathing techniques you can use anywhere"},{id:"resource-mindful-002",title:"Guided Body Scan Meditation",type:"audio",url:"/resources/body-scan-meditation.mp3",description:"15-minute guided meditation for relaxation"}],status:"upcoming",tags:["mindfulness","anxiety-relief","beginner-friendly","stress-management"]},{id:"event-support-group-001",title:"Young Adults Support Circle",description:"A weekly support group for young adults (18-30) navigating life transitions, career stress, and relationship challenges. Safe, confidential, and peer-led.",type:"support-group",hostId:"helper-young-adult-001",hostName:"Alex Chen, Peer Support Specialist",startTime:new Date(Date.now()+432e6).toISOString(),endTime:new Date(Date.now()+432e6+45e5).toISOString(),timezone:"EST",maxParticipants:8,currentParticipants:[{userId:"user-young-001",username:"TransitionTime",registeredDate:new Date(Date.now()-432e6).toISOString(),attended:!0,feedback:"Really appreciate the safe space to share. Feeling less alone.",rating:5},{userId:"user-young-002",username:"CareerAnxiety",registeredDate:new Date(Date.now()-2592e5).toISOString(),attended:!0,feedback:"Great group dynamic. Looking forward to next week.",rating:4}],isVirtual:!0,meetingLink:"https://astralcore.meeting/young-adults-support",resources:[{id:"resource-support-001",title:"Young Adult Life Transition Guide",type:"document",url:"/resources/life-transition-guide.pdf"}],status:"upcoming",tags:["young-adults","peer-support","life-transitions","weekly"]},{id:"event-wellness-session-001",title:"Art Therapy: Creative Expression for Healing",description:"Explore emotions through creative expression in this gentle art therapy session. All skill levels welcome - this is about healing, not creating perfect art.",type:"wellness",hostId:"helper-art-therapy-001",hostName:"Dr. Maria Rodriguez, Licensed Art Therapist",startTime:new Date(Date.now()+6048e5).toISOString(),endTime:new Date(Date.now()+6048e5+72e5).toISOString(),timezone:"CST",maxParticipants:12,currentParticipants:[{userId:"user-art-001",username:"CreativeHealing",registeredDate:new Date(Date.now()-864e5).toISOString(),attended:!1}],isVirtual:!1,resources:[{id:"resource-art-001",title:"Art Therapy Supply List",type:"document",url:"/resources/art-supplies.pdf",description:"Basic supplies needed for the session"},{id:"resource-art-002",title:"Art for Emotional Expression Guide",type:"worksheet",url:"/resources/art-expression-worksheet.pdf"}],status:"upcoming",tags:["art-therapy","creative-expression","healing","emotions"]}]}getPeerConnections(){return[{id:"connection-accountability-001",starkeeperId:"user-account-001",peerId:"user-account-peer-001",peerName:"MindfulMate",connectionType:"accountability-buddy",connectedDate:new Date(Date.now()-12096e5).toISOString(),lastInteraction:new Date(Date.now()-216e5).toISOString(),sharedGoals:["Daily 10-minute meditation","Journaling before bed","Weekly anxiety check-ins"],status:"active",interactionCount:28,isMatched:!0},{id:"connection-mentor-001",starkeeperId:"user-mentee-001",peerId:"helper-mentor-001",peerName:"RecoveryGuide_Sarah",connectionType:"mentor",connectedDate:new Date(Date.now()-2592e6).toISOString(),lastInteraction:new Date(Date.now()-1728e5).toISOString(),sharedGoals:["90-day sobriety milestone","Building healthy coping strategies","Rebuilding family relationships"],status:"active",interactionCount:45,isMatched:!0},{id:"connection-study-001",starkeeperId:"user-student-001",peerId:"user-student-peer-001",peerName:"StudyBuddy_Alex",connectionType:"study-partner",connectedDate:new Date(Date.now()-6048e5).toISOString(),lastInteraction:new Date(Date.now()-432e5).toISOString(),sharedGoals:["DBT skills practice","Anxiety management techniques","Academic stress reduction"],status:"active",interactionCount:12,isMatched:!0}]}getCommunityUsers(){return[{id:"user-community-001",username:"HopefulJourney",userType:"starkeeper",joinedDate:new Date(Date.now()-5184e6).toISOString(),lastActive:new Date(Date.now()-72e5).toISOString(),contributionScore:245,badges:[{id:"badge-helper-001",name:"Supportive Voice",description:"Provided meaningful support to 10+ community members",icon:"💙",earnedDate:new Date(Date.now()-1728e6).toISOString(),category:"helping"},{id:"badge-participation-001",name:"Active Participant",description:"Engaged in community for 30+ consecutive days",icon:"⭐",earnedDate:new Date(Date.now()-2592e6).toISOString(),category:"participation"}],isOnline:!0},{id:"helper-community-001",username:"CompassionateGuide",userType:"helper",joinedDate:new Date(Date.now()-10368e6).toISOString(),lastActive:new Date(Date.now()-18e5).toISOString(),contributionScore:890,badges:[{id:"badge-leader-001",name:"Community Leader",description:"Outstanding leadership and guidance in the community",icon:"🌟",earnedDate:new Date(Date.now()-3888e6).toISOString(),category:"leadership"},{id:"badge-mentor-001",name:"Dedicated Mentor",description:"Mentored 25+ community members",icon:"🤝",earnedDate:new Date(Date.now()-5184e6).toISOString(),category:"helping"}],isOnline:!0},{id:"user-community-002",username:"GrowingStronger",userType:"starkeeper",joinedDate:new Date(Date.now()-18144e5).toISOString(),lastActive:new Date(Date.now()-144e5).toISOString(),contributionScore:156,badges:[{id:"badge-milestone-001",name:"First Steps",description:"Completed first week in the community",icon:"👣",earnedDate:new Date(Date.now()-12096e5).toISOString(),category:"milestone"}],isOnline:!1}]}};u(_,"instance");const E=_.getInstance();var D={VITE_API_URL:"/.netlify/functions"};let A=null;const T=()=>m(null,null,function*(){return null!==A?A:(A=!0,!0)}),b=()=>null!==localStorage.getItem("demo_token")||"true"===D.VITE_USE_DEMO_DATA,P=()=>{const e=localStorage.getItem("demo_user");if(!e)return null;const t=JSON.parse(e);return"seeker"===t.userType?"user":"helper"===t.userType?"helper":"admin"===t.userType?"admin":null},k=(e,t)=>m(null,null,function*(){if(b()){const t=P();if(t){const i=E.getDemoData(t);if(i[e])return i[e]}}return t()}),O=(e,...t)=>m(null,[e,...t],function*(e,t={}){yield T();if("localhost"===window.location.hostname&&!1===A){const e=new Error("Demo mode - API skipped");throw e.isDevelopmentError=!0,e}const i=sessionStorage.getItem("accessToken"),n=i?null:localStorage.getItem("astral_core_anonymous_id"),s=D.VITE_API_URL,r=yield fetch(`${s}${e}`,d(c({},t),{headers:c(c(c({"Content-Type":"application/json"},i&&{Authorization:`Bearer ${i}`}),n&&{"X-Anonymous-Id":n}),t.headers)}));if(401===r.status)throw window.dispatchEvent(new CustomEvent("auth-error")),new Error("Unauthorized");if(!r.ok){const e=r.headers.get("content-type");let t;throw t=e&&e.includes("text/html")?{message:"Server returned an unexpected response format."}:yield r.json().catch(()=>({message:"An unknown API error occurred."})),new Error(t.message||`Request failed with status ${r.status}`)}if(204===r.status)return;const o=r.headers.get("content-type");if(o&&o.includes("text/html"))throw new Error("Server returned an unexpected response format.");return r.json()});T();const R={initialize:()=>m(null,null,function*(){yield T()}),resources:{getResources:()=>O("/wellness/resources")},assessments:{submitPhq9Result:(e,t,i)=>O("/wellness/assessments",{method:"POST",body:JSON.stringify({userToken:e,score:t,answers:i,type:"phq-9"})}),submitGad7Result:(e,t,i)=>O("/wellness/assessments",{method:"POST",body:JSON.stringify({userToken:e,score:t,answers:i,type:"gad-7"})}),getHistory:e=>O(`/wellness/assessments/history/${e}`)},habits:{getPredefinedHabits:()=>O("/wellness/habits/predefined"),getTrackedHabitIds:e=>O(`/wellness/habits/tracked/${e}`),getCompletions:e=>O(`/wellness/habits/completions/${e}`),trackHabit:(e,t)=>O("/wellness/habits/track",{method:"POST",body:JSON.stringify({userId:e,habitId:t})}),untrackHabit:(e,t)=>O("/wellness/habits/untrack",{method:"POST",body:JSON.stringify({userId:e,habitId:t})}),logCompletion:(e,t,i)=>O("/wellness/habits/log",{method:"POST",body:JSON.stringify({userId:e,habitId:t,date:i})})},mood:{postCheckIn:(e,t)=>O("/wellness/mood/checkin",{method:"POST",body:JSON.stringify(d(c({},e),{userToken:t}))}),getHistory:e=>O(`/wellness/mood/history/${e}`)},journal:{getEntries:e=>k("journalEntries",()=>O(`/wellness/journal/${e}`)),getHistory:e=>k("journalEntries",()=>O(`/wellness/journal/history/${e}`)),postEntry:(e,t)=>O("/wellness/journal/entry",{method:"POST",body:JSON.stringify({content:e,userToken:t})})},videos:{getVideos:()=>O("/wellness/videos"),likeVideo:e=>O(`/wellness/videos/like/${e}`,{method:"POST"}),uploadVideo:(e,t,i)=>m(null,null,function*(){return O("/wellness/videos/upload",{method:"POST",body:JSON.stringify({description:t,userToken:i,fileName:e.name})})})},safetyPlan:{get:e=>O(`/users/safety-plan/${e}`),save:(e,t)=>O("/users/safety-plan",{method:"POST",body:JSON.stringify({plan:e,userToken:t})})},legal:{checkConsent:(e,t)=>O(`/users/consent/${e}/${t}`),recordConsent:(e,t,i,n)=>O("/users/consent",{method:"POST",body:JSON.stringify({userId:e,userType:t,documentType:i,documentVersion:n})})},payment:{createDonationIntent:e=>new Promise(e=>{setTimeout(()=>{e({clientSecret:`pi_${crypto.randomUUID()}_secret_${crypto.randomUUID()}`})},500)})},emergency:{trigger:(e,t)=>new Promise(e=>{setTimeout(()=>e(),300)})},helpSessions:{getForSeeker:e=>k("helpSessions",()=>O(`/sessions/user/${e}`)),getForUser:e=>k("helpSessions",()=>O(`/sessions/user/${e}`)),toggleFavorite:(e,t)=>O(`/sessions/${e}/favorite`,{method:"POST",body:JSON.stringify({seekerId:t})}),sendKudos:(e,t)=>O(`/sessions/${e}/kudos`,{method:"POST",body:JSON.stringify({seekerId:t})})},preferences:{getPreferences:e=>O(`/users/preferences/${e}`),updatePreferences:(e,t)=>O(`/users/preferences/${e}`,{method:"PUT",body:JSON.stringify(t)})},dilemmas:{getDilemmas:()=>m(null,null,function*(){var e;try{return yield O("/dilemmas")}catch(t){const i=t;if(i.isDevelopmentError||(null==(e=i.message)?void 0:e.includes("Demo mode"))){const e=P()||"user",t=E.getDemoData(e);return t.allDilemmas||t.dilemmas||[]}throw t}}),getForYouFeed:e=>O(`/dilemmas/for-you/${e}`),postDilemma:(e,t)=>O("/dilemmas",{method:"POST",body:JSON.stringify(d(c({},e),{userToken:t}))}),createDirectRequest:(e,t,i)=>O("/dilemmas/direct-request",{method:"POST",body:JSON.stringify(d(c({},e),{userToken:t,requestedHelperId:i}))}),declineRequest:(e,t)=>O(`/dilemmas/${e}/decline`,{method:"POST",body:JSON.stringify({helperId:t})}),toggleSupport:e=>O(`/dilemmas/${e}/support`,{method:"POST"}),report:(e,t)=>O(`/dilemmas/${e}/report`,{method:"POST",body:JSON.stringify({reason:t})}),acceptDilemma:(e,t)=>O(`/dilemmas/${e}/accept`,{method:"POST",body:JSON.stringify({helperId:t})}),resolveBySeeker:(e,t)=>O(`/dilemmas/${e}/resolve`,{method:"POST",body:JSON.stringify({userToken:t})})},chat:{getMessages:e=>O(`/chat/${e}/messages`),sendMessage:(e,t,i,n)=>O(`/chat/${e}/messages`,{method:"POST",body:JSON.stringify({text:t,sender:i,senderId:n})})},helpers:{getById:e=>O(`/helpers/${e}`),getAllHelpers:()=>O("/helpers"),getProfile:e=>{if(b()){const e=P();if("helper"===e||"admin"===e){const t=E.getDemoData(e);return Promise.resolve(t.profile||null)}}return O(`/helpers/profile/${e}`)},getFavoriteHelpersDetails:e=>O(`/helpers/favorites/${e}`),createProfile:e=>O("/helpers",{method:"POST",body:JSON.stringify(e)}),updateProfile:(e,t)=>O(`/helpers/${e}`,{method:"PUT",body:JSON.stringify(t)}),setAvailability:(e,t)=>O(`/helpers/${e}/availability`,{method:"PUT",body:JSON.stringify({isAvailable:t})}),getOnlineHelperCount:()=>m(null,null,function*(){var e;try{return yield O("/helpers/online-count",{headers:{Authorization:""}})}catch(t){const i=t;if(i.isDevelopmentError||(null==(e=i.message)?void 0:e.includes("Demo mode")))return 12;throw t}}),getHelperAchievements:e=>O(`/helpers/${e}/achievements`),submitTrainingQuiz:(e,t)=>O(`/helpers/${e}/training`,{method:"POST",body:JSON.stringify({score:t})}),submitApplication:e=>O(`/helpers/${e}/application`,{method:"POST"})},admin:{getApplications:()=>O("/admin/applications"),getApplicantDetails:e=>O(`/admin/applicants/${e}`),updateApplicationStatus:(e,t,i,n)=>O(`/admin/applications/${e}`,{method:"PUT",body:JSON.stringify({status:t,notes:n})}),getCommunityStats:()=>O("/admin/stats")},feedback:{submitFeedback:(e,t,i)=>O("/feedback",{method:"POST",body:JSON.stringify({dilemmaId:e,helperId:t,wasHelpful:i})}),getFeedbackForHelper:e=>O(`/feedback/${e}`)},helperCommunity:{getThreads:()=>O("/community/threads"),getPosts:e=>O(`/community/posts/${e}`),createPost:e=>O("/community/posts",{method:"POST",body:JSON.stringify(e)}),createThread:(e,t)=>O("/community/threads",{method:"POST",body:JSON.stringify(d(c({},e),{firstPostContent:t}))}),getProposals:()=>O("/community/proposals"),createProposal:e=>O("/community/proposals",{method:"POST",body:JSON.stringify(e)}),voteOnProposal:(e,t,i)=>O(`/community/proposals/${e}/vote`,{method:"POST",body:JSON.stringify({helperId:t,vote:i})})},reflections:{getReflections:()=>O("/reflections"),postReflection:(e,t)=>O("/reflections",{method:"POST",body:JSON.stringify({userToken:e,content:t})}),addReaction:(e,t,i)=>O(`/reflections/${e}/react`,{method:"POST",body:JSON.stringify({reactionType:t,userToken:i})})},userBlocking:{getBlockedUsers:e=>O(`/users/blocked/${e}`),blockUser:(e,t)=>O("/users/block",{method:"POST",body:JSON.stringify({blockerId:e,blockedId:t})}),unblockUser:(e,t)=>O("/users/unblock",{method:"POST",body:JSON.stringify({blockerId:e,blockedId:t})})},moderation:{getHistory:e=>O(`/moderation/history/${e}`),dismissReport:(e,t)=>O(`/moderation/reports/${e}/dismiss`,{method:"POST"}),removePost:(e,t)=>O(`/moderation/posts/${e}`,{method:"DELETE"}),getUserStatus:e=>O(`/moderation/users/${e}/status`),issueWarning:e=>O(`/moderation/users/${e}/warn`,{method:"POST"}),banUser:(e,t,i)=>O(`/moderation/users/${e}/ban`,{method:"POST",body:JSON.stringify({reason:t,durationHours:i})})},ai:{chat:(e,t,i)=>m(null,null,function*(){try{return yield O("/api-ai/chat",{method:"POST",body:JSON.stringify({messages:e,userId:t,provider:i||"openai"})})}catch(n){return{response:"I'm having trouble connecting right now. Please try again in a moment.",metadata:{error:!0}}}}),sendMessageToAI:e=>m(null,null,function*(){return(yield R.ai.chat(e)).response}),resetAIChat:e=>m(null,null,function*(){return O("/api-ai/clear",{method:"POST",body:JSON.stringify({userId:e})})}),saveChatHistory:(e,t)=>m(null,null,function*(){return O("/api-ai/history",{method:"POST",body:JSON.stringify({userId:e,messages:t})})}),loadChatHistory:e=>m(null,null,function*(){var t;try{return(yield O(`/api-ai/history?userId=${e}`)).messages||[]}catch(i){const e=i;return e.isDevelopmentError||(null==(t=e.message)||t.includes("Demo mode")),[]}}),getProviders:()=>m(null,null,function*(){try{return yield O("/api-ai/providers")}catch(e){return{providers:[],default:null}}}),draftPostFromChat:e=>m(null,null,function*(){return O("/ai/draft-post",{method:"POST",body:JSON.stringify({messages:e})})}),getHelperGuidance:e=>m(null,null,function*(){return O("/ai/guidance",{method:"POST",body:JSON.stringify({text:e})})}),summarizeDilemma:e=>m(null,null,function*(){return(yield O("/ai/summarize-dilemma",{method:"POST",body:JSON.stringify({content:e})})).summary}),summarizeChat:e=>m(null,null,function*(){return(yield O("/ai/summarize-chat",{method:"POST",body:JSON.stringify({transcript:e})})).summary}),getAiMatchedDilemmas:(e,t)=>m(null,null,function*(){return(yield O("/ai/match-dilemmas",{method:"POST",body:JSON.stringify({helper:e,dilemmas:t})})).matchedDilemmas}),summarizeHelperPerformance:e=>m(null,null,function*(){return(yield O("/ai/summarize-performance",{method:"POST",body:JSON.stringify({transcript:e})})).summary})}};const L=new class{constructor(){u(this,"STORAGE_KEY_PREFIX","astral_core_"),u(this,"ANONYMOUS_ID_KEY",`${this.STORAGE_KEY_PREFIX}anonymous_id`),u(this,"DATA_KEY",`${this.STORAGE_KEY_PREFIX}user_data`),u(this,"SYNC_KEY",`${this.STORAGE_KEY_PREFIX}sync_status`)}getAnonymousId(){try{return localStorage.getItem(this.ANONYMOUS_ID_KEY)}catch(e){return null}}setAnonymousId(e){try{localStorage.setItem(this.ANONYMOUS_ID_KEY,e)}catch(t){}}getUserData(){try{const e=localStorage.getItem(this.DATA_KEY);return e?JSON.parse(e):null}catch(e){return null}}setUserData(e){try{const t=this.getUserData()||this.getDefaultUserData(),i=c(c({},t),e);localStorage.setItem(this.DATA_KEY,JSON.stringify(i))}catch(t){}}getDataField(e){try{const t=this.getUserData();return t?t[e]:null}catch(t){return null}}setDataField(e,t){try{const i=this.getUserData()||this.getDefaultUserData();i[e]=t,localStorage.setItem(this.DATA_KEY,JSON.stringify(i))}catch(i){}}addMoodEntry(e){const t=this.getDataField("moodEntries")||[];t.push(d(c({},e),{id:crypto.randomUUID(),timestamp:(new Date).toISOString()})),this.setDataField("moodEntries",t)}addReflection(e){const t=this.getDataField("reflections")||[];t.push(d(c({},e),{id:crypto.randomUUID(),timestamp:(new Date).toISOString()})),this.setDataField("reflections",t)}saveSafetyPlan(e){this.setDataField("safetyPlan",d(c({},e),{updatedAt:(new Date).toISOString()}))}addAssessment(e){const t=this.getDataField("assessments")||[];t.push(d(c({},e),{id:crypto.randomUUID(),timestamp:(new Date).toISOString()})),this.setDataField("assessments",t)}updateWellnessData(e){const t=this.getDataField("wellnessData")||{};this.setDataField("wellnessData",d(c(c({},t),e),{updatedAt:(new Date).toISOString()}))}savePreferences(e){this.setDataField("preferences",e)}getDefaultUserData(){return{anonymousId:this.getAnonymousId()||crypto.randomUUID(),moodEntries:[],reflections:[],safetyPlan:null,wellnessData:{},assessments:[],preferences:{theme:"system",notifications:!1,language:"en"}}}clearUserData(){try{localStorage.removeItem(this.DATA_KEY),localStorage.removeItem(this.SYNC_KEY)}catch(e){}}needsSync(){try{return"synced"!==localStorage.getItem(this.SYNC_KEY)}catch(e){return!1}}markAsSynced(){try{localStorage.setItem(this.SYNC_KEY,"synced"),this.setDataField("lastSyncedAt",(new Date).toISOString())}catch(e){}}markAsNeedsSync(){try{localStorage.setItem(this.SYNC_KEY,"pending")}catch(e){}}migrateToAuthenticatedUser(e){return m(this,null,function*(){try{return!this.getUserData()||(this.clearUserData(),this.markAsSynced(),!0)}catch(e){return!1}})}isStorageAvailable(){try{const e="__storage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}getStorageInfo(){try{let e=0;for(const t in localStorage)if(t.startsWith(this.STORAGE_KEY_PREFIX)){const i=localStorage.getItem(t);i&&(e+=i.length+t.length)}return{used:e,available:this.isStorageAvailable()}}catch(e){return{used:0,available:!1}}}};const N=new class{constructor(){u(this,"logBuffer",[]),u(this,"maxBufferSize",100)}get isDevelopment(){return!1}shouldLog(e){return!!this.isDevelopment||("warn"===e||"error"===e)}formatMessage(e,t,i){return`${i?`[${i}]`:""} ${t}`}addToBuffer(e){this.logBuffer.push(e),this.logBuffer.length>this.maxBufferSize&&this.logBuffer.shift()}debug(e,t,i){if(!this.shouldLog("debug"))return;const n={level:"debug",message:e,data:t,timestamp:(new Date).toISOString(),source:i};this.addToBuffer(n),this.isDevelopment}info(e,t,i){if(!this.shouldLog("info"))return;const n={level:"info",message:e,data:t,timestamp:(new Date).toISOString(),source:i};this.addToBuffer(n),this.isDevelopment}warn(e,t,i){if(!this.shouldLog("warn"))return;const n={level:"warn",message:e,data:t,timestamp:(new Date).toISOString(),source:i};this.addToBuffer(n)}error(e,t,i){const n={level:"error",message:e,data:t,timestamp:(new Date).toISOString(),source:i};this.addToBuffer(n),!this.isDevelopment&&window.Sentry&&window.Sentry.captureException(t||new Error(e),{tags:{source:i},level:"error"})}getRecentLogs(){return this.isDevelopment?[...this.logBuffer]:[]}clearLogs(){this.logBuffer=[]}};N.debug.bind(N),N.info.bind(N),N.warn.bind(N),N.error.bind(N);class U{constructor(e={}){u(this,"config"),u(this,"eventQueue",[]),u(this,"sessionId"),u(this,"userId"),u(this,"consentStatus",null);this.config=c({enabled:!0,collectPersonalData:!1,batchSize:10,flushInterval:3e4,privacySettings:c(c({},{dataRetentionDays:30,allowCrossSession:!1,anonymizeAfterDays:7,purgeAfterDays:90,collectLocationData:!1,collectDeviceData:!0,shareCrisisData:!0}),e.privacySettings||{}),requireConsent:!0,gdprCompliant:!0,hipaaAdjacent:!0,crisisPriority:!0},e),this.sessionId=this.generateSessionId()}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substring(2,11)}`}track(e,t,i){if(!this.config.enabled)return;const n={id:`event_${Date.now()}_${Math.random().toString(36).substring(2,11)}`,name:e,category:t,properties:i,timestamp:Date.now(),sessionId:this.sessionId,userId:this.userId,isAnonymized:!1,sensitivityLevel:"public"};this.eventQueue.push(n)}trackPageView(e,t){this.track("page_view","page_view",c({path:e},t))}trackFeatureUsage(e,t,i){this.track(`${e}_${t}`,"feature_usage",c({feature:e,action:t},i))}trackEvent(e,t){this.track(e,"user_action",t)}trackError(e,t){var i;this.track("error","error",{message:e.message,stack:null==(i=e.stack)?void 0:i.split("\n").slice(0,5).join("\n"),context:t,url:window.location.href})}trackUserAction(e,t,i){this.track(e,"user_action",c({element:t},i))}trackTiming(e,t,i){this.track("timing","performance",{name:e,duration:t,category:i})}trackCrisisIntervention(e,t){this.track(e,"crisis_intervention",c({timestamp:Date.now(),urgent:!0},t))}trackWellnessActivity(e,t){this.track(e,"wellness_tracking",c({timestamp:Date.now()},t))}updateConsent(e){this.consentStatus=d(c(c({},this.consentStatus),e),{timestamp:Date.now()})}getConsentStatus(){return this.consentStatus}exportUserData(e){return m(this,null,function*(){return{userId:e,requestDate:Date.now(),includeAnalytics:!0,includeJourneys:!0,format:"json",status:"completed"}})}setUserId(e){this.userId=e}endSession(){}flush(){this.eventQueue=[]}isEnabled(){return this.config.enabled}optOut(){this.config.enabled=!1,this.eventQueue=[]}optIn(){this.config.enabled=!0}}let F=null;const M=(F||(F=new U),F),x={primary:"#2E7D8F",primaryLight:"#4A9FB0",primaryDark:"#1F5A6A",secondary:"#7FB069",secondaryLight:"#A4C989",secondaryDark:"#5E8B4A",background:"#F8FBFC",backgroundSecondary:"#F1F7F9",backgroundTertiary:"#E8F4F6",surface:"#FFFFFF",surfaceSecondary:"#F4F9FA",surfaceHover:"#EBF6F8",text:"#1B3A42",textSecondary:"#4A6B73",textMuted:"#7A9CA4",textInverse:"#FFFFFF",success:"#7FB069",warning:"#E6B17A",error:"#D97757",info:"#5BA8C4",crisis:"#E53E3E",calm:"#B8E6E1",hope:"#A8D8EA",support:"#9FD3C7",growth:"#86C7B8",border:"#D1E7EA",borderLight:"#E8F4F6",borderHover:"#B8DDE2",shadow:"rgba(46, 125, 143, 0.1)",shadowHover:"rgba(46, 125, 143, 0.15)"},H={primary:"#4A9FB0",primaryLight:"#6BB5C5",primaryDark:"#2E7D8F",secondary:"#A4C989",secondaryLight:"#BDD8A4",secondaryDark:"#7FB069",background:"#0F1B1E",backgroundSecondary:"#162329",backgroundTertiary:"#1D2D33",surface:"#243339",surfaceSecondary:"#2B3D44",surfaceHover:"#34464E",text:"#E8F4F6",textSecondary:"#B8DDE2",textMuted:"#7A9CA4",textInverse:"#1B3A42",success:"#A4C989",warning:"#F4D03F",error:"#F1948A",info:"#85C1E9",crisis:"#FF6B6B",calm:"#6BB5C5",hope:"#85C1E9",support:"#A4C989",growth:"#86C7B8",border:"#3C5259",borderLight:"#2B3D44",borderHover:"#4A6B73",shadow:"rgba(0, 0, 0, 0.3)",shadowHover:"rgba(0, 0, 0, 0.4)"},V={"calm-sanctuary":{id:"calm-sanctuary",name:"Calm Sanctuary",description:"Cool blues and soft greens designed to reduce anxiety and promote tranquility",psychologyPrinciples:["Blue reduces cortisol levels and heart rate","Green promotes emotional balance and reduces eye strain","Cool tones activate parasympathetic nervous system","Low saturation prevents overstimulation"],recommendedFor:["Anxiety disorders","Panic attacks","Insomnia","PTSD symptoms","Sensory sensitivity"],colors:{light:x,dark:H},accessibility:{contrastRatio:7.2,level:"AAA",colorBlindFriendly:!0},customization:{allowsIntensityAdjustment:!0,allowsColorOverrides:!0,allowsAnimationControl:!0}},"warm-embrace":{id:"warm-embrace",name:"Warm Embrace",description:"Gentle oranges and warm yellows to combat depression and boost mood",psychologyPrinciples:["Orange stimulates serotonin production","Warm yellows increase dopamine levels","Warm tones promote feelings of comfort and security","Moderate saturation prevents overstimulation while maintaining mood benefits"],recommendedFor:["Depression","Seasonal Affective Disorder","Low motivation","Emotional numbness","Social isolation"],colors:{light:d(c({},x),{primary:"#E67E22",primaryLight:"#F39C12",primaryDark:"#D35400",secondary:"#F1C40F",secondaryLight:"#F7DC6F",secondaryDark:"#D4AC0D",background:"#FFFEF7",backgroundSecondary:"#FEF9E7",backgroundTertiary:"#FCF3CF",text:"#6E2C00",textSecondary:"#935116",textMuted:"#B7950B"}),dark:d(c({},H),{primary:"#F39C12",primaryLight:"#F7DC6F",primaryDark:"#E67E22",secondary:"#F7DC6F",secondaryLight:"#FCF3CF",secondaryDark:"#F1C40F",background:"#1C1408",backgroundSecondary:"#2C1E0A",backgroundTertiary:"#3D280E"})},accessibility:{contrastRatio:6.8,level:"AA",colorBlindFriendly:!0},customization:{allowsIntensityAdjustment:!0,allowsColorOverrides:!0,allowsAnimationControl:!0}},"nature-healing":{id:"nature-healing",name:"Nature Healing",description:"Earth tones and natural greens for grounding and emotional stability",psychologyPrinciples:["Earth tones reduce stress hormones","Natural greens restore attention and reduce mental fatigue","Brown promotes feelings of security and stability","Forest colors activate biophilic stress reduction"],recommendedFor:["ADHD and attention issues","Chronic stress","Burnout recovery","Trauma healing","Nature-based therapy"],colors:{light:d(c({},x),{primary:"#27AE60",primaryLight:"#58D68D",primaryDark:"#1E8449",secondary:"#8D6E63",secondaryLight:"#A1887F",secondaryDark:"#6D4C41"}),dark:d(c({},H),{primary:"#58D68D",primaryLight:"#82E5AA",primaryDark:"#27AE60",secondary:"#A1887F",secondaryLight:"#BCAAA4",secondaryDark:"#8D6E63"})},accessibility:{contrastRatio:7.5,level:"AAA",colorBlindFriendly:!0},customization:{allowsIntensityAdjustment:!0,allowsColorOverrides:!0,allowsAnimationControl:!0}},"gentle-focus":{id:"gentle-focus",name:"Gentle Focus",description:"Muted purples and soft lavenders for concentration and mental clarity",psychologyPrinciples:["Purple enhances creativity and introspection","Lavender reduces anxiety while maintaining alertness","Cool purples improve focus without overstimulation","Muted tones prevent distraction while supporting concentration"],recommendedFor:["Study and focus sessions","Meditation and mindfulness","Creative work","Therapy sessions","Cognitive behavioral therapy"],colors:{light:d(c({},x),{primary:"#9C88B5",primaryLight:"#B39DDB",primaryDark:"#7B1FA2",secondary:"#C5A3FF",secondaryLight:"#D1C4E9",secondaryDark:"#9575CD"}),dark:d(c({},H),{primary:"#B39DDB",primaryLight:"#D1C4E9",primaryDark:"#9C88B5",secondary:"#CE93D8",secondaryLight:"#E1BEE7",secondaryDark:"#BA68C8"})},accessibility:{contrastRatio:6.9,level:"AA",colorBlindFriendly:!0},customization:{allowsIntensityAdjustment:!0,allowsColorOverrides:!0,allowsAnimationControl:!0}},"energizing-hope":{id:"energizing-hope",name:"Energizing Hope",description:"Bright but gentle colors for motivation and positive energy",psychologyPrinciples:["Bright colors increase energy and motivation","Coral and pink promote feelings of love and hope","Optimistic colors boost dopamine production","Balanced saturation provides energy without anxiety"],recommendedFor:["Recovery and healing","Building motivation","Overcoming hopelessness","Positive psychology therapy","Goal setting sessions"],colors:{light:d(c({},x),{primary:"#FF6B9D",primaryLight:"#FF8FA3",primaryDark:"#E91E63",secondary:"#4ECDC4",secondaryLight:"#80CBC4",secondaryDark:"#26A69A"}),dark:d(c({},H),{primary:"#FF8FA3",primaryLight:"#FFB3BA",primaryDark:"#FF6B9D",secondary:"#80CBC4",secondaryLight:"#B2DFDB",secondaryDark:"#4ECDC4"})},accessibility:{contrastRatio:6.5,level:"AA",colorBlindFriendly:!1},customization:{allowsIntensityAdjustment:!0,allowsColorOverrides:!0,allowsAnimationControl:!0}},"minimal-zen":{id:"minimal-zen",name:"Minimal Zen",description:"High contrast minimalism for sensory sensitivity and focus",psychologyPrinciples:["Minimal stimulation reduces sensory overload","High contrast improves accessibility and focus","Monochromatic design reduces decision fatigue","Clean lines promote mental clarity"],recommendedFor:["Autism spectrum disorders","Sensory processing sensitivity","ADHD focus support","Migraine sensitivity","Accessibility needs"],colors:{light:d(c({},x),{primary:"#2D3748",primaryLight:"#4A5568",primaryDark:"#1A202C",secondary:"#718096",secondaryLight:"#A0AEC0",secondaryDark:"#4A5568",background:"#FFFFFF",backgroundSecondary:"#F7FAFC",backgroundTertiary:"#EDF2F7"}),dark:d(c({},H),{primary:"#E2E8F0",primaryLight:"#F7FAFC",primaryDark:"#CBD5E0",secondary:"#A0AEC0",secondaryLight:"#CBD5E0",secondaryDark:"#718096",background:"#1A202C",backgroundSecondary:"#2D3748",backgroundTertiary:"#4A5568"})},accessibility:{contrastRatio:15,level:"AAA",colorBlindFriendly:!0},customization:{allowsIntensityAdjustment:!1,allowsColorOverrides:!1,allowsAnimationControl:!0}},"crisis-safe":{id:"crisis-safe",name:"Crisis Safe",description:"Emergency-optimized colors for crisis intervention and high visibility",psychologyPrinciples:["High contrast ensures visibility during distress","Specific colors for different emergency states","Intuitive color coding for quick recognition","Calming background with urgent accent colors"],recommendedFor:["Crisis intervention","Emergency situations","High stress states","Accessibility requirements","Professional crisis support"],colors:{light:{primary:"#C53030",primaryLight:"#E53E3E",primaryDark:"#9B2C2C",secondary:"#2B6CB0",secondaryLight:"#3182CE",secondaryDark:"#2C5282",background:"#FFFAF0",backgroundSecondary:"#FED7C3",backgroundTertiary:"#FEEBC8",surface:"#FFFFFF",surfaceSecondary:"#FFFAF0",surfaceHover:"#FED7C3",text:"#1A202C",textSecondary:"#2D3748",textMuted:"#4A5568",textInverse:"#FFFFFF",success:"#38A169",warning:"#D69E2E",error:"#C53030",info:"#2B6CB0",crisis:"#C53030",calm:"#90CDF4",hope:"#68D391",support:"#F6E05E",growth:"#9AE6B4",border:"#FBD38D",borderLight:"#FEEBC8",borderHover:"#F6AD55",shadow:"rgba(197, 48, 48, 0.15)",shadowHover:"rgba(197, 48, 48, 0.25)"},dark:{primary:"#FC8181",primaryLight:"#FEB2B2",primaryDark:"#E53E3E",secondary:"#63B3ED",secondaryLight:"#90CDF4",secondaryDark:"#3182CE",background:"#2D1B1B",backgroundSecondary:"#3B2A2A",backgroundTertiary:"#4A3939",surface:"#59484A",surfaceSecondary:"#685759",surfaceHover:"#776768",text:"#FEEBC8",textSecondary:"#FBD38D",textMuted:"#F6AD55",textInverse:"#1A202C",success:"#9AE6B4",warning:"#F6E05E",error:"#FC8181",info:"#90CDF4",crisis:"#FC8181",calm:"#90CDF4",hope:"#9AE6B4",support:"#F6E05E",growth:"#C6F6D5",border:"#685759",borderLight:"#59484A",borderHover:"#8A7778",shadow:"rgba(0, 0, 0, 0.4)",shadowHover:"rgba(0, 0, 0, 0.6)"}},accessibility:{contrastRatio:12,level:"AAA",colorBlindFriendly:!0},customization:{allowsIntensityAdjustment:!1,allowsColorOverrides:!1,allowsAnimationControl:!1}},"high-contrast":{id:"high-contrast",name:"High Contrast",description:"Maximum contrast for accessibility compliance and visual clarity",psychologyPrinciples:["Maximum contrast reduces visual strain","Clear distinction improves cognitive processing","Reduces ambiguity in interface elements","Supports users with visual impairments"],recommendedFor:["Visual impairments","Dyslexia","Cognitive disabilities","Low vision conditions","Screen reader users"],colors:{light:d(c({},x),{primary:"#000000",primaryLight:"#1A1A1A",primaryDark:"#000000",secondary:"#000000",secondaryLight:"#333333",secondaryDark:"#000000",background:"#FFFFFF",text:"#000000",textSecondary:"#000000",textMuted:"#666666",border:"#000000"}),dark:d(c({},H),{primary:"#FFFFFF",primaryLight:"#FFFFFF",primaryDark:"#E6E6E6",secondary:"#FFFFFF",secondaryLight:"#FFFFFF",secondaryDark:"#CCCCCC",background:"#000000",text:"#FFFFFF",textSecondary:"#FFFFFF",textMuted:"#CCCCCC",border:"#FFFFFF"})},accessibility:{contrastRatio:21,level:"AAA",colorBlindFriendly:!0},customization:{allowsIntensityAdjustment:!1,allowsColorOverrides:!1,allowsAnimationControl:!0}},custom:{id:"custom",name:"Custom Theme",description:"User-defined personalized therapeutic color environment",psychologyPrinciples:["Personal color preferences enhance comfort","User control improves sense of agency","Customization supports individual needs","Adaptation to personal sensitivities"],recommendedFor:["Individual preferences","Specific sensitivities","Cultural considerations","Personal therapeutic goals","Advanced users"],colors:{light:x,dark:H},accessibility:{contrastRatio:4.5,level:"AA",colorBlindFriendly:!0},customization:{allowsIntensityAdjustment:!0,allowsColorOverrides:!0,allowsAnimationControl:!0}},system:{id:"system",name:"System Default",description:"Follow system dark/light mode preferences",psychologyPrinciples:["Consistency with user preferences","Reduced cognitive load","Familiarity promotes comfort","Adaptive to environmental conditions"],recommendedFor:["General use","System integration","Consistent experience","Automatic adaptation","Default option"],colors:{light:x,dark:H},accessibility:{contrastRatio:7,level:"AAA",colorBlindFriendly:!0},customization:{allowsIntensityAdjustment:!0,allowsColorOverrides:!0,allowsAnimationControl:!0}}},B=h.createContext(void 0);var j={VITE_AUTH0_DOMAIN:"dev-ac3ajs327vs5vzhk.us.auth0.com",VITE_AUTH0_CLIENT_ID:"uGv7ns4HVxnKn5ofBdnaKqCKue1JUvZG",VITE_AUTH0_CALLBACK_URL:"http://localhost:3000/callback",VITE_API_BASE_URL:"/.netlify/functions",VITE_WEBSOCKET_URL:"ws://localhost:3000",VITE_VAPID_PUBLIC_KEY:"development-vapid-public-key-placeholder",VITE_SENTRY_DSN:"",VITE_ENABLE_AI_CHAT:"true",VITE_ENABLE_VIDEO_CHAT:"false",VITE_ENABLE_PUSH_NOTIFICATIONS:"false",VITE_ENABLE_OFFLINE_MODE:"true",VITE_DEBUG_MODE:"false",VITE_SHOW_DEV_TOOLS:"false",VITE_CRISIS_HOTLINE:"988",VITE_CRISIS_TEXT_LINE:"741741",VITE_GA_TRACKING_ID:"",VITE_PWA_NAME:"Astral Core - Mental Health Support",VITE_PWA_SHORT_NAME:"Astral Core",VITE_PWA_THEME_COLOR:"",VITE_PWA_BACKGROUND_COLOR:"",VITE_PWA_DESCRIPTION:"Anonymous peer-to-peer mental health support platform with offline crisis resources",VITE_SW_UPDATE_INTERVAL:"60000",VITE_SW_CACHE_NAME:"astral-core",VITE_SW_ENABLE_BACKGROUND_SYNC:"true",VITE_SW_ENABLE_PUSH_SYNC:"false",VITE_PWA_DISPLAY:"standalone",VITE_PWA_ORIENTATION:"portrait",VITE_PWA_START_URL:"/",VITE_PWA_SCOPE:"/",VITE_OFFLINE_FALLBACK_PAGE:"/offline.html",VITE_OFFLINE_CRISIS_PAGE:"/offline-crisis.html",VITE_ENABLE_OFFLINE_ANALYTICS:"true",VITE_ENABLE_INSTALL_PROMPT:"true",VITE_INSTALL_PROMPT_DELAY:"5000",VITE_INSTALL_PROMPT_FREQUENCY:"7",VITE_ENABLE_SHARE_TARGET:"true",VITE_SHARE_TARGET_URL:"/share",DATABASE_URL:"postgresql://neondb_owner:npg_IrC1uWYi3FdA@ep-floral-lake-aeiztgic-pooler.c-2.us-east-2.aws.neon.tech/neondb?sslmode=require&channel_binding=require",AUTH0_CLIENT_SECRET:"demo-auth0-client-secret-min-32-characters-for-production",JWT_SECRET:"development-jwt-secret-key-must-be-32-characters-or-longer-for-security",VITE_OTEL_ENABLED:"false",VITE_OTEL_ENDPOINT:"",VITE_OTEL_API_KEY:"",VITE_APP_VERSION:"1.0.0",VITE_AUTH0_AUDIENCE:"http://localhost:3000/api",SESSION_SECRET:"development-session-secret-key-must-be-32-characters-or-longer-for-security",NODE_ENV:"production",VITE_API_URL:"/.netlify/functions",VITE_AUTH_OPTIONAL:"true",VITE_ALLOW_ANONYMOUS:"true",ACSetupSvcPort:"23210",ALLUSERSPROFILE:"C:\\ProgramData",ANDROID_SDK_ROOT:"C:\\Users\\damat\\AppData\\Local\\Android\\Sdk",APPDATA:"C:\\Users\\damat\\AppData\\Roaming",ChocolateyInstall:"C:\\ProgramData\\chocolatey",ChocolateyLastPathUpdate:"133947761431510901",CHROME_CRASHPAD_PIPE_NAME:"\\\\.\\pipe\\crashpad_63148_PAITOUHBJETQCUJU",CI:"true",CLAUDE_CODE_MAX_OUTPUT_TOKENS:"32000",CLAUDE_CODE_SSE_PORT:"51573",COLOR:"1",COLORTERM:"truecolor",CommonProgramFiles:"C:\\Program Files\\Common Files","CommonProgramFiles(x86)":"C:\\Program Files (x86)\\Common Files",CommonProgramW6432:"C:\\Program Files\\Common Files",COMPUTERNAME:"DEMONWALL_EXE",ComSpec:"C:\\WINDOWS\\system32\\cmd.exe",CURSOR_TRACE_ID:"3b8302348a734895b48542bd45043e1f",DriverData:"C:\\Windows\\System32\\Drivers\\DriverData",EDITOR:"C:\\WINDOWS\\notepad.exe",EFC_13896_1592913036:"1",ENABLE_IDE_INTEGRATION:"true",FORCE_COLOR:"0",FPS_BROWSER_APP_PROFILE_STRING:"Internet Explorer",FPS_BROWSER_USER_PROFILE_STRING:"Default",GIT_ASKPASS:"c:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\resources\\app\\extensions\\git\\dist\\askpass.sh",GRADLE_HOME:"C:\\gradle\\gradle-8.14.3\\bin\\gradle-8.14.2",HOME:"C:\\Users\\damat",HOMEDRIVE:"C:",HOMEPATH:"\\Users\\damat",INIT_CWD:"C:\\Users\\damat\\_REPOS\\CoreV2_Mental_Health_Platform","IntelliJ IDEA":"C:\\Program Files\\JetBrains\\IntelliJ IDEA 2025.2\\bin",JAVA_HOME:"C:\\Program Files\\Microsoft\\jdk-21.0.8.9-hotspot",KMP_BLOCKTIME:"0",LANG:"en_US.UTF-8",LOCALAPPDATA:"C:\\Users\\damat\\AppData\\Local",LOGONSERVER:"\\\\DEMONWALL_EXE",NODE:"C:\\Program Files\\nodejs\\node.exe",NODE_EXE:"C:\\Program Files\\nodejs\\\\node.exe",NODE_OPTIONS:"--max-old-space-size=8192",npm_command:"exec",npm_config_cache:"C:\\Users\\damat\\AppData\\Local\\npm-cache",npm_config_globalconfig:"C:\\Users\\damat\\AppData\\Roaming\\npm\\etc\\npmrc",npm_config_global_prefix:"C:\\Users\\damat\\AppData\\Roaming\\npm",npm_config_init_module:"C:\\Users\\damat\\.npm-init.js",npm_config_local_prefix:"C:\\Users\\damat\\_REPOS\\CoreV2_Mental_Health_Platform",npm_config_loglevel:"silent",npm_config_node_gyp:"C:\\Program Files\\nodejs\\node_modules\\npm\\node_modules\\node-gyp\\bin\\node-gyp.js",npm_config_noproxy:"",npm_config_npm_version:"10.9.2",npm_config_prefix:"C:\\Users\\damat\\AppData\\Roaming\\npm",npm_config_userconfig:"C:\\Users\\damat\\.npmrc",npm_config_user_agent:"npm/10.9.2 node/v22.17.0 win32 x64 workspaces/false",npm_execpath:"C:\\Program Files\\nodejs\\node_modules\\npm\\bin\\npm-cli.js",npm_lifecycle_event:"npx",npm_lifecycle_script:"vite",npm_node_execpath:"C:\\Program Files\\nodejs\\node.exe",npm_package_engines_node:">=20.19.0",npm_package_engines_npm:">=10.0.0",npm_package_json:"C:\\Users\\damat\\_REPOS\\CoreV2_Mental_Health_Platform\\package.json",npm_package_name:"astral-core-react",npm_package_version:"1.0.0",NPM_PREFIX_JS:"C:\\Program Files\\nodejs\\\\node_modules\\npm\\bin\\npm-prefix.js",NPM_PREFIX_NPX_CLI_JS:"C:\\Users\\damat\\AppData\\Roaming\\npm\\node_modules\\npm\\bin\\npx-cli.js",NPX_CLI_JS:"C:\\Program Files\\nodejs\\\\node_modules\\npm\\bin\\npx-cli.js",NUMBER_OF_PROCESSORS:"32",OMP_WAIT_POLICY:"PASSIVE",OneDrive:"C:\\Users\\damat\\OneDrive",OneDriveConsumer:"C:\\Users\\damat\\OneDrive",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",OS:"Windows_NT",Path:"C:\\Users\\damat\\_REPOS\\CoreV2_Mental_Health_Platform\\node_modules\\.bin;C:\\Users\\damat\\_REPOS\\CoreV2_Mental_Health_Platform\\node_modules\\.bin;C:\\Users\\damat\\_REPOS\\node_modules\\.bin;C:\\Users\\damat\\node_modules\\.bin;C:\\Users\\node_modules\\.bin;C:\\node_modules\\.bin;C:\\Program Files\\nodejs\\node_modules\\npm\\node_modules\\@npmcli\\run-script\\lib\\node-gyp-bin;C:\\Users\\damat\\_REPOS\\CoreV2_Mental_Health_Platform\\node_modules\\.bin;C:\\Users\\damat\\_REPOS\\node_modules\\.bin;C:\\Users\\damat\\node_modules\\.bin;C:\\Users\\node_modules\\.bin;C:\\node_modules\\.bin;C:\\Program Files\\nodejs\\node_modules\\npm\\node_modules\\@npmcli\\run-script\\lib\\node-gyp-bin;C:\\Users\\damat\\AppData\\Local\\cloud-code\\installer\\google-cloud-sdk\\bin;C:\\Program Files\\Microsoft\\jdk-21.0.8.9-hotspot\\bin;C:\\Program Files\\Microsoft\\jdk-17.0.16.8-hotspot\\bin;C:\\Gradle\\gradle-9.0.0\\bin;C:\\Program Files\\Eclipse Adoptium\\jdk-11.0.27.6-hotspot\\bin;C:\\Program Files\\Eclipse Adoptium\\jdk-8.0.452.9-hotspot\\bin;c:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\resources\\app\\bin;c:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\resources\\app\\bin;c:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\resources\\app\\bin;C:\\Program Files\\Common Files\\Oracle\\Java\\javapath;C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\java8path;C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath;C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem;C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\;C:\\WINDOWS\\System32\\OpenSSH\\;C:\\Program Files\\dotnet\\;C:\\Program Files\\NVIDIA Corporation\\NVIDIA App\\NvDLISR;C:\\Program Files (x86)\\NVIDIA Corporation\\PhysX\\Common;C:\\Program Files\\Calibre2\\;C:\\Program Files\\Git\\cmd;C:\\Program Files\\Eclipse Adoptium\\jdk-21.0.7.6-hotspot\\bin;C:\\Android\\platform-tools;C:\\Users\\damat\\OneDrive\\Documents\\_AAAA\\jdk-21.0.4\\bin;C:\\Users\\damat\\OneDrive\\Documents\\_AAAA\\java-21-openjdk-21.0.4.0.7-1.win.jdk.x86_64\\bin;C:\\Users\\damat\\AppData\\Local\\Programs\\Python\\Launcher\\;C:\\Users\\damat\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Users\\damat\\AppD;C:\\Program Files\\GitHub CLI\\;C:\\Program Files\\Java\\jdk-17\\bin;C:\\Program Files (x86)\\Google\\Cloud SDK\\google-cloud-sdk\\bin;C:\\Program Files\\Docker\\Docker\\resources\\bin;C:\\protoc\\bin;C:\\Program Files\\Eclipse Adoptium\\jdk-11.0.27.6-hotspot\\bin;C:\\Program Files\\Eclipse Adoptium\\jdk-8.0.452.9-hotspot\\bin;c:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\resources\\app\\bin;c:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\resources\\app\\bin;c:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\resources\\app\\bin;C:\\Program Files\\Common Files\\Oracle\\Java\\javapath;C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\java8path;C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath;C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem;C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\;C:\\WINDOWS\\System32\\OpenSSH\\;C:\\Program Files\\dotnet\\;C:\\Program Files\\NVIDIA Corporation\\NVIDIA App\\NvDLISR;C:\\Program Files (x86)\\NVIDIA Corporation\\PhysX\\Common;C:\\Program Files\\Calibre2\\;C:\\Program Files\\Git\\cmd;C:\\Program Files\\Eclipse Adoptium\\jdk-21.0.7.6-hotspot\\bin;C:\\Android\\platform-tools;C:\\Users\\damat\\OneDrive\\Documents\\_AAAA\\jdk-21.0.4\\bin;C:\\Users\\damat\\OneDrive\\Documents\\_AAAA\\java-21-openjdk-21.0.4.0.7-1.win.jdk.x86_64\\bin;C:\\Users\\damat\\AppData\\Local\\Programs\\Python\\Launcher\\;C:\\Users\\damat\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Users\\damat\\AppD;C:\\Program Files\\GitHub CLI\\;C:\\Program Files\\Java\\jdk-17\\bin;C:\\Program Files (x86)\\Google\\Cloud SDK\\google-cloud-sdk\\bin;C:\\Program Files\\Docker\\Docker\\resources\\bin;C:\\Users\\damat\\.cargo\\bin;C:\\Users\\damat\\OneDrive\\Documents\\_AAAA\\jdk-21.0.4\\bin;C:\\Users\\damat\\OneDrive\\Documents\\_AAAA\\java-21-openjdk-21.0.4.0.7-1.win.jdk.x86_64\\bin;C:\\Users\\damat\\AppData\\Local\\Programs\\Python\\Launcher\\;C:\\Users\\damat\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Users\\damat\\AppData\\Local\\Programs\\Windsurf\\bin;C:\\Users\\damat\\AppData\\Local\\Programs\\Microsoft VS Code\\bin;C:\\Users\\damat\\Downloads\\java-1.8.0-openjdk-1.8.0.392-1.b08.redhat.windows.x86_64\\bin;C:\\Users\\damat\\Downloads\\java-1.8.0-openjdk-1.8.0.392-1.b08.redhat.windows.x86_64\\java-1.8.0-openjdk-1.8.0.392-1.b08.redhat.windows.x86_64\\jre\\bin;C:\\Users\\damat\\Downloads\\java-1.8.0-openjdk-1.8.0.392-1.b08.redhat.windows.x86_64\\jdk8u392-b08\\bin;C:\\Program Files\\Java\\jdk-17\\bin;C:\\Users\\damat\\Downloads\\gradle-8.14.2-all\\gradle-8.14.2\\bin;C:\\Users\\damat\\AppData\\Roaming\\ffmpeg\\ffmpeg-7.1.1-essentials_build\\bin;C:\\Users\\damat\\AppData\\Local\\Microsoft\\WinGet\\Links;C:\\Program Files\\Eclipse Adoptium\\jdk-21.0.7.6-ho;C:\\Users\\damat\\AppData\\Local\\Android\\platform-tools;C:\\Users\\damat\\.dotnet\\tools;C:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\resources\\app\\bin;C:\\Users\\damat\\AppData\\Roaming\\npm;C:\\Program Files\\nodejs;C:\\Users\\damat\\AppData\\Local\\GitHubDesktop\\bin;C:\\Users\\damat\\.fly\\bin;C:\\Users\\damat\\AppData\\Local\\JetBrains\\Toolbox\\scripts;;C:\\prot",PATHEXT:".COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC;.CPL",PROCESSOR_ARCHITECTURE:"AMD64",PROCESSOR_IDENTIFIER:"Intel64 Family 6 Model 183 Stepping 1, GenuineIntel",PROCESSOR_LEVEL:"6",PROCESSOR_REVISION:"b701",ProgramData:"C:\\ProgramData",ProgramFiles:"C:\\Program Files","ProgramFiles(x86)":"C:\\Program Files (x86)",ProgramW6432:"C:\\Program Files",PROMPT:"$P$G",PSModulePath:"C:\\Users\\damat\\Documents\\WindowsPowerShell\\Modules;C:\\Users\\damat\\AppData\\Local\\Google\\Cloud SDK\\google-cloud-sdk\\platform\\PowerShell;C:\\Program Files\\WindowsPowerShell\\Modules;C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules;C:\\Program Files (x86)\\Google\\Cloud SDK\\google-cloud-sdk\\platform\\PowerShell",PUBLIC:"C:\\Users\\Public",RlsSvcPort:"22112",SESSIONNAME:"Console",SystemDrive:"C:",SystemRoot:"C:\\WINDOWS",TEMP:"C:\\Users\\damat\\AppData\\Local\\Temp",TERM_PROGRAM:"vscode",TERM_PROGRAM_VERSION:"1.4.5",TMP:"C:\\Users\\damat\\AppData\\Local\\Temp",USERDOMAIN:"DEMONWALL_EXE",USERDOMAIN_ROAMINGPROFILE:"DEMONWALL_EXE",USERNAME:"damat",USERPROFILE:"C:\\Users\\damat",VITE_USER_NODE_ENV:"production",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"",VSCODE_GIT_ASKPASS_MAIN:"c:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\resources\\app\\extensions\\git\\dist\\askpass-main.js",VSCODE_GIT_ASKPASS_NODE:"C:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\Cursor.exe",VSCODE_GIT_IPC_HANDLE:"\\\\.\\pipe\\vscode-git-097521b929-sock",VSCODE_INJECTION:"1",windir:"C:\\WINDOWS",ZES_ENABLE_SYSMAN:"1"};function W(e,t=""){if("undefined"!=typeof process&&(null==j?void 0:j[e]))return j[e];if("undefined"!=typeof window){const t=window.__VITE_ENV__||{};if(t[e])return t[e]}return t}function z(){var e;return"undefined"!=typeof window&&!0===(null==(e=window.__VITE_ENV__)?void 0:e.DEV)}if("undefined"!=typeof window&&!window.__VITE_ENV__)try{const t=null==(e=globalThis.import)?void 0:e.meta;(null==t?void 0:t.env)&&"object"==typeof t.env?window.__VITE_ENV__=t.env:window.__VITE_ENV__={}}catch(Me){window.__VITE_ENV__={}}const $={API_BASE_URL:W("VITE_API_BASE_URL","http://localhost:3847/api"),AUTH0_DOMAIN:W("VITE_AUTH0_DOMAIN","dev-placeholder.auth0.com"),AUTH0_CLIENT_ID:W("VITE_AUTH0_CLIENT_ID","placeholder-client-id"),AUTH0_CALLBACK_URL:W("VITE_AUTH0_CALLBACK_URL","undefined"!=typeof window?window.location.origin+"/callback":""),AUTH0_AUDIENCE:W("VITE_AUTH0_AUDIENCE","http://localhost:3847/api"),AUTH0_CLIENT_SECRET:W("VITE_AUTH0_CLIENT_SECRET","placeholder-secret"),AUTH_OPTIONAL:"true"===W("VITE_AUTH_OPTIONAL","true"),ALLOW_ANONYMOUS:"true"===W("VITE_ALLOW_ANONYMOUS","true"),ENABLE_ANONYMOUS_CHAT:"true"===W("VITE_ENABLE_ANONYMOUS_CHAT","true"),BYPASS_AUTH:"true"===W("VITE_BYPASS_AUTH","true"),MOCK_API:"true"===W("VITE_MOCK_API","true"),CRISIS_HOTLINE:W("VITE_CRISIS_HOTLINE","988"),CRISIS_TEXT_LINE:W("VITE_CRISIS_TEXT_LINE","741741"),VAPID_PUBLIC_KEY:W("VITE_VAPID_PUBLIC_KEY",z()?"BPrE3_xJcGZo5xOiKh_1G5VhbGxqr4K7SLkJtNhE9f2sQcDvRwXfOhY3zP8mKnN1wRtYuCvBmNzLkDhElLLr-I":""),WS_URL:W("VITE_WS_URL",z()?"ws://localhost:3001":"wss://api.astralcore.app"),SENTRY_DSN:W("VITE_SENTRY_DSN",""),SENTRY_DEV_ENABLED:"true"===W("VITE_SENTRY_DEV_ENABLED","false"),APP_VERSION:W("VITE_APP_VERSION","unknown"),ENV:W("VITE_ENV","production"),IS_DEV:z(),IS_PROD:"undefined"!=typeof process||"undefined"!=typeof window&&!0===(null==(J=window.__VITE_ENV__)?void 0:J.PROD)};var J,G={VITE_AUTH0_DOMAIN:"dev-ac3ajs327vs5vzhk.us.auth0.com",VITE_AUTH0_CLIENT_ID:"uGv7ns4HVxnKn5ofBdnaKqCKue1JUvZG",VITE_AUTH0_CALLBACK_URL:"http://localhost:3000/callback",VITE_API_BASE_URL:"/.netlify/functions",VITE_WEBSOCKET_URL:"ws://localhost:3000",VITE_VAPID_PUBLIC_KEY:"development-vapid-public-key-placeholder",VITE_SENTRY_DSN:"",VITE_ENABLE_AI_CHAT:"true",VITE_ENABLE_VIDEO_CHAT:"false",VITE_ENABLE_PUSH_NOTIFICATIONS:"false",VITE_ENABLE_OFFLINE_MODE:"true",VITE_DEBUG_MODE:"false",VITE_SHOW_DEV_TOOLS:"false",VITE_CRISIS_HOTLINE:"988",VITE_CRISIS_TEXT_LINE:"741741",VITE_GA_TRACKING_ID:"",VITE_PWA_NAME:"Astral Core - Mental Health Support",VITE_PWA_SHORT_NAME:"Astral Core",VITE_PWA_THEME_COLOR:"",VITE_PWA_BACKGROUND_COLOR:"",VITE_PWA_DESCRIPTION:"Anonymous peer-to-peer mental health support platform with offline crisis resources",VITE_SW_UPDATE_INTERVAL:"60000",VITE_SW_CACHE_NAME:"astral-core",VITE_SW_ENABLE_BACKGROUND_SYNC:"true",VITE_SW_ENABLE_PUSH_SYNC:"false",VITE_PWA_DISPLAY:"standalone",VITE_PWA_ORIENTATION:"portrait",VITE_PWA_START_URL:"/",VITE_PWA_SCOPE:"/",VITE_OFFLINE_FALLBACK_PAGE:"/offline.html",VITE_OFFLINE_CRISIS_PAGE:"/offline-crisis.html",VITE_ENABLE_OFFLINE_ANALYTICS:"true",VITE_ENABLE_INSTALL_PROMPT:"true",VITE_INSTALL_PROMPT_DELAY:"5000",VITE_INSTALL_PROMPT_FREQUENCY:"7",VITE_ENABLE_SHARE_TARGET:"true",VITE_SHARE_TARGET_URL:"/share",DATABASE_URL:"postgresql://neondb_owner:npg_IrC1uWYi3FdA@ep-floral-lake-aeiztgic-pooler.c-2.us-east-2.aws.neon.tech/neondb?sslmode=require&channel_binding=require",AUTH0_CLIENT_SECRET:"demo-auth0-client-secret-min-32-characters-for-production",JWT_SECRET:"development-jwt-secret-key-must-be-32-characters-or-longer-for-security",VITE_OTEL_ENABLED:"false",VITE_OTEL_ENDPOINT:"",VITE_OTEL_API_KEY:"",VITE_APP_VERSION:"1.0.0",VITE_AUTH0_AUDIENCE:"http://localhost:3000/api",SESSION_SECRET:"development-session-secret-key-must-be-32-characters-or-longer-for-security",NODE_ENV:"production",VITE_API_URL:"/.netlify/functions",VITE_AUTH_OPTIONAL:"true",VITE_ALLOW_ANONYMOUS:"true",ACSetupSvcPort:"23210",ALLUSERSPROFILE:"C:\\ProgramData",ANDROID_SDK_ROOT:"C:\\Users\\damat\\AppData\\Local\\Android\\Sdk",APPDATA:"C:\\Users\\damat\\AppData\\Roaming",ChocolateyInstall:"C:\\ProgramData\\chocolatey",ChocolateyLastPathUpdate:"133947761431510901",CHROME_CRASHPAD_PIPE_NAME:"\\\\.\\pipe\\crashpad_63148_PAITOUHBJETQCUJU",CI:"true",CLAUDE_CODE_MAX_OUTPUT_TOKENS:"32000",CLAUDE_CODE_SSE_PORT:"51573",COLOR:"1",COLORTERM:"truecolor",CommonProgramFiles:"C:\\Program Files\\Common Files","CommonProgramFiles(x86)":"C:\\Program Files (x86)\\Common Files",CommonProgramW6432:"C:\\Program Files\\Common Files",COMPUTERNAME:"DEMONWALL_EXE",ComSpec:"C:\\WINDOWS\\system32\\cmd.exe",CURSOR_TRACE_ID:"3b8302348a734895b48542bd45043e1f",DriverData:"C:\\Windows\\System32\\Drivers\\DriverData",EDITOR:"C:\\WINDOWS\\notepad.exe",EFC_13896_1592913036:"1",ENABLE_IDE_INTEGRATION:"true",FORCE_COLOR:"0",FPS_BROWSER_APP_PROFILE_STRING:"Internet Explorer",FPS_BROWSER_USER_PROFILE_STRING:"Default",GIT_ASKPASS:"c:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\resources\\app\\extensions\\git\\dist\\askpass.sh",GRADLE_HOME:"C:\\gradle\\gradle-8.14.3\\bin\\gradle-8.14.2",HOME:"C:\\Users\\damat",HOMEDRIVE:"C:",HOMEPATH:"\\Users\\damat",INIT_CWD:"C:\\Users\\damat\\_REPOS\\CoreV2_Mental_Health_Platform","IntelliJ IDEA":"C:\\Program Files\\JetBrains\\IntelliJ IDEA 2025.2\\bin",JAVA_HOME:"C:\\Program Files\\Microsoft\\jdk-21.0.8.9-hotspot",KMP_BLOCKTIME:"0",LANG:"en_US.UTF-8",LOCALAPPDATA:"C:\\Users\\damat\\AppData\\Local",LOGONSERVER:"\\\\DEMONWALL_EXE",NODE:"C:\\Program Files\\nodejs\\node.exe",NODE_EXE:"C:\\Program Files\\nodejs\\\\node.exe",NODE_OPTIONS:"--max-old-space-size=8192",npm_command:"exec",npm_config_cache:"C:\\Users\\damat\\AppData\\Local\\npm-cache",npm_config_globalconfig:"C:\\Users\\damat\\AppData\\Roaming\\npm\\etc\\npmrc",npm_config_global_prefix:"C:\\Users\\damat\\AppData\\Roaming\\npm",npm_config_init_module:"C:\\Users\\damat\\.npm-init.js",npm_config_local_prefix:"C:\\Users\\damat\\_REPOS\\CoreV2_Mental_Health_Platform",npm_config_loglevel:"silent",npm_config_node_gyp:"C:\\Program Files\\nodejs\\node_modules\\npm\\node_modules\\node-gyp\\bin\\node-gyp.js",npm_config_noproxy:"",npm_config_npm_version:"10.9.2",npm_config_prefix:"C:\\Users\\damat\\AppData\\Roaming\\npm",npm_config_userconfig:"C:\\Users\\damat\\.npmrc",npm_config_user_agent:"npm/10.9.2 node/v22.17.0 win32 x64 workspaces/false",npm_execpath:"C:\\Program Files\\nodejs\\node_modules\\npm\\bin\\npm-cli.js",npm_lifecycle_event:"npx",npm_lifecycle_script:"vite",npm_node_execpath:"C:\\Program Files\\nodejs\\node.exe",npm_package_engines_node:">=20.19.0",npm_package_engines_npm:">=10.0.0",npm_package_json:"C:\\Users\\damat\\_REPOS\\CoreV2_Mental_Health_Platform\\package.json",npm_package_name:"astral-core-react",npm_package_version:"1.0.0",NPM_PREFIX_JS:"C:\\Program Files\\nodejs\\\\node_modules\\npm\\bin\\npm-prefix.js",NPM_PREFIX_NPX_CLI_JS:"C:\\Users\\damat\\AppData\\Roaming\\npm\\node_modules\\npm\\bin\\npx-cli.js",NPX_CLI_JS:"C:\\Program Files\\nodejs\\\\node_modules\\npm\\bin\\npx-cli.js",NUMBER_OF_PROCESSORS:"32",OMP_WAIT_POLICY:"PASSIVE",OneDrive:"C:\\Users\\damat\\OneDrive",OneDriveConsumer:"C:\\Users\\damat\\OneDrive",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",OS:"Windows_NT",Path:"C:\\Users\\damat\\_REPOS\\CoreV2_Mental_Health_Platform\\node_modules\\.bin;C:\\Users\\damat\\_REPOS\\CoreV2_Mental_Health_Platform\\node_modules\\.bin;C:\\Users\\damat\\_REPOS\\node_modules\\.bin;C:\\Users\\damat\\node_modules\\.bin;C:\\Users\\node_modules\\.bin;C:\\node_modules\\.bin;C:\\Program Files\\nodejs\\node_modules\\npm\\node_modules\\@npmcli\\run-script\\lib\\node-gyp-bin;C:\\Users\\damat\\_REPOS\\CoreV2_Mental_Health_Platform\\node_modules\\.bin;C:\\Users\\damat\\_REPOS\\node_modules\\.bin;C:\\Users\\damat\\node_modules\\.bin;C:\\Users\\node_modules\\.bin;C:\\node_modules\\.bin;C:\\Program Files\\nodejs\\node_modules\\npm\\node_modules\\@npmcli\\run-script\\lib\\node-gyp-bin;C:\\Users\\damat\\AppData\\Local\\cloud-code\\installer\\google-cloud-sdk\\bin;C:\\Program Files\\Microsoft\\jdk-21.0.8.9-hotspot\\bin;C:\\Program Files\\Microsoft\\jdk-17.0.16.8-hotspot\\bin;C:\\Gradle\\gradle-9.0.0\\bin;C:\\Program Files\\Eclipse Adoptium\\jdk-11.0.27.6-hotspot\\bin;C:\\Program Files\\Eclipse Adoptium\\jdk-8.0.452.9-hotspot\\bin;c:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\resources\\app\\bin;c:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\resources\\app\\bin;c:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\resources\\app\\bin;C:\\Program Files\\Common Files\\Oracle\\Java\\javapath;C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\java8path;C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath;C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem;C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\;C:\\WINDOWS\\System32\\OpenSSH\\;C:\\Program Files\\dotnet\\;C:\\Program Files\\NVIDIA Corporation\\NVIDIA App\\NvDLISR;C:\\Program Files (x86)\\NVIDIA Corporation\\PhysX\\Common;C:\\Program Files\\Calibre2\\;C:\\Program Files\\Git\\cmd;C:\\Program Files\\Eclipse Adoptium\\jdk-21.0.7.6-hotspot\\bin;C:\\Android\\platform-tools;C:\\Users\\damat\\OneDrive\\Documents\\_AAAA\\jdk-21.0.4\\bin;C:\\Users\\damat\\OneDrive\\Documents\\_AAAA\\java-21-openjdk-21.0.4.0.7-1.win.jdk.x86_64\\bin;C:\\Users\\damat\\AppData\\Local\\Programs\\Python\\Launcher\\;C:\\Users\\damat\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Users\\damat\\AppD;C:\\Program Files\\GitHub CLI\\;C:\\Program Files\\Java\\jdk-17\\bin;C:\\Program Files (x86)\\Google\\Cloud SDK\\google-cloud-sdk\\bin;C:\\Program Files\\Docker\\Docker\\resources\\bin;C:\\protoc\\bin;C:\\Program Files\\Eclipse Adoptium\\jdk-11.0.27.6-hotspot\\bin;C:\\Program Files\\Eclipse Adoptium\\jdk-8.0.452.9-hotspot\\bin;c:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\resources\\app\\bin;c:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\resources\\app\\bin;c:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\resources\\app\\bin;C:\\Program Files\\Common Files\\Oracle\\Java\\javapath;C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\java8path;C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath;C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem;C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\;C:\\WINDOWS\\System32\\OpenSSH\\;C:\\Program Files\\dotnet\\;C:\\Program Files\\NVIDIA Corporation\\NVIDIA App\\NvDLISR;C:\\Program Files (x86)\\NVIDIA Corporation\\PhysX\\Common;C:\\Program Files\\Calibre2\\;C:\\Program Files\\Git\\cmd;C:\\Program Files\\Eclipse Adoptium\\jdk-21.0.7.6-hotspot\\bin;C:\\Android\\platform-tools;C:\\Users\\damat\\OneDrive\\Documents\\_AAAA\\jdk-21.0.4\\bin;C:\\Users\\damat\\OneDrive\\Documents\\_AAAA\\java-21-openjdk-21.0.4.0.7-1.win.jdk.x86_64\\bin;C:\\Users\\damat\\AppData\\Local\\Programs\\Python\\Launcher\\;C:\\Users\\damat\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Users\\damat\\AppD;C:\\Program Files\\GitHub CLI\\;C:\\Program Files\\Java\\jdk-17\\bin;C:\\Program Files (x86)\\Google\\Cloud SDK\\google-cloud-sdk\\bin;C:\\Program Files\\Docker\\Docker\\resources\\bin;C:\\Users\\damat\\.cargo\\bin;C:\\Users\\damat\\OneDrive\\Documents\\_AAAA\\jdk-21.0.4\\bin;C:\\Users\\damat\\OneDrive\\Documents\\_AAAA\\java-21-openjdk-21.0.4.0.7-1.win.jdk.x86_64\\bin;C:\\Users\\damat\\AppData\\Local\\Programs\\Python\\Launcher\\;C:\\Users\\damat\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Users\\damat\\AppData\\Local\\Programs\\Windsurf\\bin;C:\\Users\\damat\\AppData\\Local\\Programs\\Microsoft VS Code\\bin;C:\\Users\\damat\\Downloads\\java-1.8.0-openjdk-1.8.0.392-1.b08.redhat.windows.x86_64\\bin;C:\\Users\\damat\\Downloads\\java-1.8.0-openjdk-1.8.0.392-1.b08.redhat.windows.x86_64\\java-1.8.0-openjdk-1.8.0.392-1.b08.redhat.windows.x86_64\\jre\\bin;C:\\Users\\damat\\Downloads\\java-1.8.0-openjdk-1.8.0.392-1.b08.redhat.windows.x86_64\\jdk8u392-b08\\bin;C:\\Program Files\\Java\\jdk-17\\bin;C:\\Users\\damat\\Downloads\\gradle-8.14.2-all\\gradle-8.14.2\\bin;C:\\Users\\damat\\AppData\\Roaming\\ffmpeg\\ffmpeg-7.1.1-essentials_build\\bin;C:\\Users\\damat\\AppData\\Local\\Microsoft\\WinGet\\Links;C:\\Program Files\\Eclipse Adoptium\\jdk-21.0.7.6-ho;C:\\Users\\damat\\AppData\\Local\\Android\\platform-tools;C:\\Users\\damat\\.dotnet\\tools;C:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\resources\\app\\bin;C:\\Users\\damat\\AppData\\Roaming\\npm;C:\\Program Files\\nodejs;C:\\Users\\damat\\AppData\\Local\\GitHubDesktop\\bin;C:\\Users\\damat\\.fly\\bin;C:\\Users\\damat\\AppData\\Local\\JetBrains\\Toolbox\\scripts;;C:\\prot",PATHEXT:".COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC;.CPL",PROCESSOR_ARCHITECTURE:"AMD64",PROCESSOR_IDENTIFIER:"Intel64 Family 6 Model 183 Stepping 1, GenuineIntel",PROCESSOR_LEVEL:"6",PROCESSOR_REVISION:"b701",ProgramData:"C:\\ProgramData",ProgramFiles:"C:\\Program Files","ProgramFiles(x86)":"C:\\Program Files (x86)",ProgramW6432:"C:\\Program Files",PROMPT:"$P$G",PSModulePath:"C:\\Users\\damat\\Documents\\WindowsPowerShell\\Modules;C:\\Users\\damat\\AppData\\Local\\Google\\Cloud SDK\\google-cloud-sdk\\platform\\PowerShell;C:\\Program Files\\WindowsPowerShell\\Modules;C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules;C:\\Program Files (x86)\\Google\\Cloud SDK\\google-cloud-sdk\\platform\\PowerShell",PUBLIC:"C:\\Users\\Public",RlsSvcPort:"22112",SESSIONNAME:"Console",SystemDrive:"C:",SystemRoot:"C:\\WINDOWS",TEMP:"C:\\Users\\damat\\AppData\\Local\\Temp",TERM_PROGRAM:"vscode",TERM_PROGRAM_VERSION:"1.4.5",TMP:"C:\\Users\\damat\\AppData\\Local\\Temp",USERDOMAIN:"DEMONWALL_EXE",USERDOMAIN_ROAMINGPROFILE:"DEMONWALL_EXE",USERNAME:"damat",USERPROFILE:"C:\\Users\\damat",VITE_USER_NODE_ENV:"production",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"",VSCODE_GIT_ASKPASS_MAIN:"c:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\resources\\app\\extensions\\git\\dist\\askpass-main.js",VSCODE_GIT_ASKPASS_NODE:"C:\\Users\\damat\\AppData\\Local\\Programs\\cursor\\Cursor.exe",VSCODE_GIT_IPC_HANDLE:"\\\\.\\pipe\\vscode-git-097521b929-sock",VSCODE_INJECTION:"1",windir:"C:\\WINDOWS",ZES_ENABLE_SYSMAN:"1"};const q=p.object({NODE_ENV:p.enum(["development","staging","production"]),VITE_API_BASE_URL:p.string().url(),VITE_WEBSOCKET_URL:p.string().regex(/^wss?:\/\/.+/),PORT:p.string().regex(/^\d+$/).optional(),HOST:p.string().optional(),VITE_AUTH0_DOMAIN:p.string().min(1),VITE_AUTH0_CLIENT_ID:p.string().min(1),VITE_AUTH0_CLIENT_SECRET:p.string().min(1).optional(),VITE_AUTH0_CALLBACK_URL:p.string().url(),VITE_AUTH0_AUDIENCE:p.string().optional(),JWT_SECRET:p.string().min(32).optional(),JWT_ALGORITHM:p.string().enum(["HS256","HS384","HS512","RS256","RS384","RS512"]).optional(),JWT_EXPIRES_IN:p.string().optional(),JWT_REFRESH_EXPIRES_IN:p.string().optional(),SESSION_SECRET:p.string().min(32).optional(),SESSION_NAME:p.string().optional(),SESSION_MAX_AGE:p.string().regex(/^\d+$/).optional(),DATABASE_URL:p.string().optional(),DATABASE_SSL:p.enum(["true","false"]).optional(),DATABASE_POOL_SIZE:p.string().regex(/^\d+$/).optional(),REDIS_URL:p.string().optional(),REDIS_PASSWORD:p.string().optional(),REDIS_DB:p.string().regex(/^\d+$/).optional(),VITE_CRISIS_HOTLINE:p.string().default("988"),VITE_CRISIS_TEXT_LINE:p.string().default("741741"),VITE_ENABLE_AI_CHAT:p.enum(["true","false"]).default("true"),VITE_ENABLE_VIDEO_CHAT:p.enum(["true","false"]).default("true"),VITE_ENABLE_PUSH_NOTIFICATIONS:p.enum(["true","false"]).default("true"),VITE_ENABLE_OFFLINE_MODE:p.enum(["true","false"]).default("true"),VITE_ENABLE_TWO_FACTOR:p.enum(["true","false"]).default("false"),VITE_ENABLE_DEVICE_FINGERPRINTING:p.enum(["true","false"]).default("false"),VITE_DEBUG_MODE:p.enum(["true","false"]).default("false"),VITE_SHOW_DEV_TOOLS:p.enum(["true","false"]).default("false"),VITE_VAPID_PUBLIC_KEY:p.string().optional(),VITE_VAPID_PRIVATE_KEY:p.string().optional(),VITE_SENTRY_DSN:p.string().optional(),VITE_GA_TRACKING_ID:p.string().optional(),VITE_PWA_NAME:p.string().default("CoreV2 - Mental Health Support"),VITE_PWA_SHORT_NAME:p.string().default("CoreV2"),VITE_PWA_THEME_COLOR:p.string().regex(/^#[0-9A-Fa-f]{6}$/i).optional().default("#667eea"),VITE_PWA_BACKGROUND_COLOR:p.string().regex(/^#[0-9A-Fa-f]{6}$/i).optional().default("#ffffff"),VITE_PWA_DISPLAY:p.enum(["fullscreen","standalone","minimal-ui","browser"]).default("standalone"),VITE_PWA_ORIENTATION:p.enum(["any","natural","landscape","portrait"]).default("portrait"),VITE_SW_UPDATE_INTERVAL:p.string().regex(/^\d+$/).default("60000"),VITE_SW_CACHE_NAME:p.string().default("corev2"),VITE_SW_ENABLE_BACKGROUND_SYNC:p.enum(["true","false"]).default("true"),VITE_SW_ENABLE_PUSH_SYNC:p.enum(["true","false"]).default("true"),CSP_REPORT_ONLY:p.enum(["true","false"]).optional(),CSP_REPORT_URI:p.string().optional(),HSTS_ENABLED:p.enum(["true","false"]).optional(),HSTS_MAX_AGE:p.string().regex(/^\d+$/).optional(),RATE_LIMIT_WINDOW_MS:p.string().regex(/^\d+$/).optional(),RATE_LIMIT_MAX_REQUESTS:p.string().regex(/^\d+$/).optional(),RATE_LIMIT_AUTH_MAX:p.string().regex(/^\d+$/).optional(),RATE_LIMIT_CRISIS_MAX:p.string().regex(/^\d+$/).optional(),LOG_LEVEL:p.enum(["error","warn","info","debug","trace"]).optional(),LOG_FORMAT:p.enum(["json","dev","combined","common"]).optional(),LOG_ALL_REQUESTS:p.enum(["true","false"]).optional(),LOG_AUTH_EVENTS:p.enum(["true","false"]).optional(),LOG_DATA_ACCESS:p.enum(["true","false"]).optional(),LOG_SECURITY_EVENTS:p.enum(["true","false"]).optional(),SMTP_HOST:p.string().optional(),SMTP_PORT:p.string().regex(/^\d+$/).optional(),SMTP_SECURE:p.enum(["true","false"]).optional(),SMTP_USER:p.string().optional(),SMTP_PASS:p.string().optional(),EMAIL_FROM:p.string().email().optional(),MAX_FILE_SIZE:p.string().regex(/^\d+$/).optional(),ALLOWED_FILE_TYPES:p.string().optional(),UPLOAD_PATH:p.string().optional()}),K={development:["NODE_ENV","VITE_API_BASE_URL","VITE_AUTH0_DOMAIN","VITE_AUTH0_CLIENT_ID","VITE_AUTH0_CALLBACK_URL"],staging:["NODE_ENV","VITE_API_BASE_URL","VITE_WEBSOCKET_URL","VITE_AUTH0_DOMAIN","VITE_AUTH0_CLIENT_ID","VITE_AUTH0_CALLBACK_URL","JWT_SECRET","SESSION_SECRET","DATABASE_URL"],production:["NODE_ENV","VITE_API_BASE_URL","VITE_WEBSOCKET_URL","VITE_AUTH0_DOMAIN","VITE_AUTH0_CLIENT_ID","VITE_AUTH0_CLIENT_SECRET","VITE_AUTH0_CALLBACK_URL","VITE_AUTH0_AUDIENCE","JWT_SECRET","SESSION_SECRET","DATABASE_URL","REDIS_URL","VITE_VAPID_PUBLIC_KEY","VITE_VAPID_PRIVATE_KEY","SMTP_HOST","SMTP_USER","SMTP_PASS","EMAIL_FROM"]},Y={JWT_SECRET:e=>{if(e&&(e.includes("dev-")||e.includes("change-this")||e.length<32))throw new Error("JWT_SECRET must be at least 32 characters and not contain default values")},SESSION_SECRET:e=>{if(e&&(e.includes("dev-")||e.includes("change-this")||e.length<32))throw new Error("SESSION_SECRET must be at least 32 characters and not contain default values")},DATABASE_URL:e=>{if(e&&e.includes("password")&&!e.includes("@"))throw new Error("DATABASE_URL appears to be malformed")},VITE_AUTH0_CLIENT_SECRET:e=>{if(e&&e.length<32)throw new Error("AUTH0_CLIENT_SECRET appears to be too short")}};function X(){const e=Q(),t=function(e,t){const i={valid:!0,missing:[],errors:[],warnings:[],security:[]};K[t].forEach(t=>{e[t]||(i.missing.push(t),i.valid=!1)});try{const t=c({},e);""===t.VITE_PWA_THEME_COLOR&&delete t.VITE_PWA_THEME_COLOR,""===t.VITE_PWA_BACKGROUND_COLOR&&delete t.VITE_PWA_BACKGROUND_COLOR,q.parse(t)}catch(n){n instanceof p.ZodError&&(n.issues.forEach(e=>{e.message.includes("Required")?i.missing.push(e.path.join(".")):i.errors.push(`${e.path.join(".")}: ${e.message}`)}),i.valid=!1)}return Object.entries(Y).forEach(([s,r])=>{const o=e[s];if(o)try{r(o)}catch(n){i.security.push(n.message),"production"===t&&(i.valid=!1)}}),"production"===t&&("true"===e.VITE_DEBUG_MODE&&i.warnings.push("Debug mode is enabled in production"),"true"===e.VITE_SHOW_DEV_TOOLS&&i.warnings.push("Dev tools are enabled in production"),"true"===e.CSP_REPORT_ONLY&&i.warnings.push("CSP is in report-only mode in production"),e.VITE_ENABLE_TWO_FACTOR&&"true"===e.VITE_ENABLE_TWO_FACTOR||i.warnings.push("Two-factor authentication is not enabled in production"),e.DATABASE_SSL&&"true"===e.DATABASE_SSL||i.warnings.push("Database SSL is not enabled in production")),Object.keys(e).filter(e=>e.startsWith("VITE_")).forEach(n=>{const s=e[n];s&&(s.includes("password")||s.includes("secret")||s.includes("key")||s.includes("token"))&&!n.includes("PUBLIC")&&!n.includes("URL")&&(i.security.push(`Potentially sensitive data in public variable: ${n}`),"production"===t&&(i.valid=!1))}),i}("undefined"!=typeof process?G:{},e);return function(e){if(e.missing.length>0&&e.missing.forEach(e=>{}),e.errors.length>0&&e.errors.forEach(e=>{}),e.security.length>0&&e.security.forEach(e=>{}),!e.valid&&"undefined"!=typeof process)throw new Error("Environment validation failed in production");e.warnings.length>0&&e.warnings.forEach(e=>{}),e.valid&&e.warnings.length}(t),t}function Q(){return"undefined"!=typeof process?"production":"development"}function Z(){return"production"===Q()}const ee=c({domain:$.AUTH0_DOMAIN,clientId:$.AUTH0_CLIENT_ID,redirectUri:$.AUTH0_CALLBACK_URL,audience:$.AUTH0_AUDIENCE,scope:"openid profile email offline_access",useRefreshTokens:!0,cacheLocation:"localstorage"},Z()&&{cacheLocation:"memory"}),te="corev2_auth_token",ie="corev2_user";const ne=new class{constructor(){u(this,"auth0Client",null),u(this,"currentUser",null),u(this,"tokenRefreshTimer",null),u(this,"isInitialized",!1)}initialize(){return m(this,null,function*(){if(!this.isInitialized)try{this.auth0Client=new g(ee);(yield this.auth0Client.isAuthenticated())&&(yield this.handleAuthentication()),this.isInitialized=!0}catch(e){throw new Error("Authentication service initialization failed")}})}login(e){return m(this,null,function*(){if(!this.auth0Client)throw new Error("Auth0 client not initialized");yield this.auth0Client.loginWithRedirect(d(c({},e),{appState:{returnTo:window.location.pathname}}))})}loginWithPopup(e){return m(this,null,function*(){if(!this.auth0Client)throw new Error("Auth0 client not initialized");try{yield this.auth0Client.loginWithPopup(e),yield this.handleAuthentication()}catch(t){throw t}})}handleCallback(){return m(this,null,function*(){var e;if(!this.auth0Client)throw new Error("Auth0 client not initialized");const t=yield this.auth0Client.handleRedirectCallback();yield this.handleAuthentication();const i=(null==(e=t.appState)?void 0:e.returnTo)||"/";window.history.replaceState({},document.title,i)})}handleAuthentication(){return m(this,null,function*(){if(this.auth0Client)try{const e=yield this.auth0Client.getUser();if(!e)return;const t=yield this.auth0Client.getTokenSilently();this.currentUser=this.transformAuth0User(e),this.storeAuthData(t,this.currentUser),this.setupTokenRefresh(),this.emitAuthEvent("authenticated",this.currentUser)}catch(e){throw e}})}transformAuth0User(e){return{id:e.sub,email:e.email,name:e.name||e.nickname,picture:e.picture,roles:this.extractUserRoles(e),isEmailVerified:e.email_verified,createdAt:e.created_at,updatedAt:e.updated_at}}extractUserRoles(e){var t;const i=e["https://corev2.com/roles"]||(null==(t=e.app_metadata)?void 0:t.roles)||["user"];return Array.isArray(i)?i:[i]}storeAuthData(e,t){Z()?(sessionStorage.setItem(te,e),sessionStorage.setItem(ie,JSON.stringify(t))):(localStorage.setItem(te,e),localStorage.setItem(ie,JSON.stringify(t)))}clearAuthData(){localStorage.removeItem(te),localStorage.removeItem("corev2_refresh_token"),localStorage.removeItem(ie),sessionStorage.removeItem(te),sessionStorage.removeItem(ie),this.tokenRefreshTimer&&(clearInterval(this.tokenRefreshTimer),this.tokenRefreshTimer=null)}setupTokenRefresh(){this.tokenRefreshTimer&&clearInterval(this.tokenRefreshTimer),this.tokenRefreshTimer=setInterval(()=>m(this,null,function*(){try{yield this.refreshToken()}catch(e){yield this.logout()}}),6e5)}refreshToken(){return m(this,null,function*(){if(!this.auth0Client)throw new Error("Auth0 client not initialized");try{const e=yield this.auth0Client.getTokenSilently();return this.storeAuthData(e,this.currentUser),e}catch(e){throw e}})}getAccessToken(){return m(this,null,function*(){if(!this.auth0Client)return null;try{return yield this.auth0Client.getTokenSilently()}catch(e){return null}})}getCurrentUser(){return m(this,null,function*(){if(this.currentUser)return this.currentUser;const e=(Z()?sessionStorage:localStorage).getItem(ie);if(e)return this.currentUser=JSON.parse(e),this.currentUser;if(this.auth0Client&&(yield this.auth0Client.isAuthenticated())){const e=yield this.auth0Client.getUser();if(e)return this.currentUser=this.transformAuth0User(e),this.currentUser}return null})}isAuthenticated(){return m(this,null,function*(){return!!this.auth0Client&&(yield this.auth0Client.isAuthenticated())})}hasRole(e){return m(this,null,function*(){var t;const i=yield this.getCurrentUser();return i&&(null==(t=i.roles)?void 0:t.includes(e))||!1})}hasAnyRole(e){return m(this,null,function*(){const t=yield this.getCurrentUser();return!!(null==t?void 0:t.roles)&&e.some(e=>t.roles.includes(e))})}hasAllRoles(e){return m(this,null,function*(){const t=yield this.getCurrentUser();return!!(null==t?void 0:t.roles)&&e.every(e=>t.roles.includes(e))})}updateProfile(e){return m(this,null,function*(){if(!this.auth0Client||!this.currentUser)throw new Error("User not authenticated");const t=yield this.getAccessToken();if(!t)throw new Error("No access token");if(!(yield fetch(`https://${ee.domain}/api/v2/users/${this.currentUser.id}`,{method:"PATCH",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,picture:e.picture})})).ok)throw new Error("Failed to update profile");this.currentUser=c(c({},this.currentUser),e),this.storeAuthData(t,this.currentUser),this.emitAuthEvent("profileUpdated",this.currentUser)})}logout(e){return m(this,null,function*(){this.auth0Client?(this.clearAuthData(),this.currentUser=null,yield this.auth0Client.logout({logoutParams:{returnTo:(null==e?void 0:e.returnTo)||window.location.origin}}),this.emitAuthEvent("logout",null)):this.clearAuthData()})}requestPasswordReset(e){return m(this,null,function*(){if(!(yield fetch(`https://${ee.domain}/dbconnections/change_password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:ee.clientId,email:e,connection:"Username-Password-Authentication"})})).ok)throw new Error("Failed to request password reset")})}enableTwoFactor(){return m(this,null,function*(){var e;const t=yield this.getAccessToken();if(!t)throw new Error("No access token");if(!(yield fetch(`https://${ee.domain}/api/v2/users/${null==(e=this.currentUser)?void 0:e.id}/multifactor/guardian`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({enabled:!0})})).ok)throw new Error("Failed to enable 2FA")})}emitAuthEvent(e,t){window.dispatchEvent(new CustomEvent(`auth:${e}`,{detail:t}))}onAuthStateChange(e){const t=t=>e(t.detail),i=()=>e(null);return window.addEventListener("auth:authenticated",t),window.addEventListener("auth:profileUpdated",t),window.addEventListener("auth:logout",i),()=>{window.removeEventListener("auth:authenticated",t),window.removeEventListener("auth:profileUpdated",t),window.removeEventListener("auth:logout",i)}}getManagementToken(){return m(this,null,function*(){if(!(yield this.hasRole("admin")))throw new Error("Admin access required");if(!(yield this.getAccessToken()))return null;const e=yield fetch(`https://${ee.domain}/oauth/token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:ee.clientId,client_secret:$.AUTH0_CLIENT_SECRET,audience:`https://${ee.domain}/api/v2/`,grant_type:"client_credentials"})});if(!e.ok)throw new Error("Failed to get management token");return(yield e.json()).access_token})}};class se{constructor(e){u(this,"config"),u(this,"cache",new Map),u(this,"pendingRequests",new Map),u(this,"interceptors",{request:[],response:[],error:[]}),this.config=c({timeout:3e4,retries:3,retryDelay:1e3,cache:!0,cacheTTL:3e5},e),this.setupDefaultInterceptors()}setupDefaultInterceptors(){this.addRequestInterceptor(e=>m(this,null,function*(){if(!e.skipAuth){const t=yield ne.getAccessToken();t&&(e.headers=d(c({},e.headers),{Authorization:`Bearer ${t}`}))}return e})),this.addErrorInterceptor(e=>m(this,null,function*(){if(401===e.status)try{return yield ne.refreshToken(),e}catch(t){yield ne.logout()}return e}))}addRequestInterceptor(e){this.interceptors.request.push(e)}addResponseInterceptor(e){this.interceptors.response.push(e)}addErrorInterceptor(e){this.interceptors.error.push(e)}request(e){return m(this,arguments,function*(e,t={}){let i=c({},t);for(const r of this.interceptors.request)i=yield r(i);const n=this.getCacheKey(e,i);if("GET"===i.method||!i.method){const e=this.getFromCache(n);if(e)return{data:e,status:200,headers:new Headers,ok:!0};const t=this.pendingRequests.get(n);if(t)return t}const s=this.executeRequest(e,i);"GET"!==i.method&&i.method||this.pendingRequests.set(n,s);try{let e=yield s;for(const t of this.interceptors.response)e=yield t(e);return"GET"!==i.method&&i.method||!e.ok||this.setCache(n,e.data,i.cacheTTL),e}finally{this.pendingRequests.delete(n)}})}executeRequest(e,t){return m(this,null,function*(){var i,n,s,r,o;const a=this.buildUrl(e,t.params),l=null!=(n=null!=(i=t.retries)?i:this.config.retries)?n:3,d=null!=(s=this.config.retryDelay)?s:1e3;let u=null;for(let e=0;e<=l;e++)try{const i=new AbortController,n=null!=(o=null!=(r=t.timeout)?r:this.config.timeout)?o:3e4,s=setTimeout(()=>i.abort(),n),m=yield fetch(a,{method:t.method||"GET",headers:c({"Content-Type":"application/json"},t.headers),body:t.body?JSON.stringify(t.body):void 0,signal:i.signal});let h;clearTimeout(s);const p=m.headers.get("content-type");if(h=p&&p.includes("application/json")?yield m.json():yield m.text(),!m.ok){let t={message:`HTTP ${m.status}: ${m.statusText}`,status:m.status,details:h};for(const e of this.interceptors.error)t=yield e(t);if(m.status>=500&&e<l){u=t,yield this.delay(d*Math.pow(2,e));continue}throw t}return{data:h,status:m.status,headers:m.headers,ok:m.ok}}catch(m){if(u=m instanceof Error?"AbortError"===m.name?{message:"Request timeout",code:"TIMEOUT"}:m instanceof TypeError&&"Failed to fetch"===m.message?{message:"Network error",code:"NETWORK_ERROR"}:{message:m.message,code:"UNKNOWN_ERROR"}:{message:"string"==typeof m?m:"Unknown error occurred",code:"UNKNOWN_ERROR"},e<l){yield this.delay(d*Math.pow(2,e));continue}let t=u;if(t){for(const e of this.interceptors.error)t=yield e(t);throw t}throw new Error("Request failed")}throw u||new Error("Request failed after retries")})}buildUrl(e,t){const i=e.startsWith("http")?e:`${this.config.baseURL}${e}`;if(!t||0===Object.keys(t).length)return i;const n=Object.entries(t).filter(([e,t])=>null!=t).map(([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(String(t))}`).join("&");return`${i}${i.includes("?")?"&":"?"}${n}`}getCacheKey(e,t){return`${t.method||"GET"}:${e}:${JSON.stringify(t.params||{})}`}getFromCache(e){var t;if(!this.config.cache)return null;const i=this.cache.get(e);if(!i)return null;const n=null!=(t=this.config.cacheTTL)?t:3e5;return Date.now()-i.timestamp>n?(this.cache.delete(e),null):i.data}setCache(e,t,i){var n;if(this.config.cache&&(this.cache.set(e,{data:t,timestamp:Date.now()}),this.cache.size>100)){const e=Array.from(this.cache.entries()),t=Date.now(),s=null!=(n=null!=i?i:this.config.cacheTTL)?n:3e5;e.forEach(([e,i])=>{t-i.timestamp>s&&this.cache.delete(e)})}}clearCache(e){if(e){Array.from(this.cache.keys()).forEach(t=>{t.includes(e)&&this.cache.delete(t)})}else this.cache.clear()}delay(e){return new Promise(t=>setTimeout(t,e))}get(e,t,i){return m(this,null,function*(){return(yield this.request(e,d(c({},i),{method:"GET",params:t}))).data})}post(e,t,i){return m(this,null,function*(){return(yield this.request(e,d(c({},i),{method:"POST",body:t}))).data})}put(e,t,i){return m(this,null,function*(){return(yield this.request(e,d(c({},i),{method:"PUT",body:t}))).data})}patch(e,t,i){return m(this,null,function*(){return(yield this.request(e,d(c({},i),{method:"PATCH",body:t}))).data})}delete(e,t){return m(this,null,function*(){return(yield this.request(e,d(c({},t),{method:"DELETE"}))).data})}}const re=new se({baseURL:$.API_BASE_URL,timeout:3e4,retries:3,cache:!0,cacheTTL:3e5});new se({baseURL:$.API_BASE_URL,timeout:6e4,retries:5,cache:!0,cacheTTL:36e5});const oe=new class{constructor(){u(this,"serviceWorkerRegistration",null),u(this,"notificationQueue",[]),u(this,"scheduledNotifications",new Map),u(this,"preferences",{enabled:!0,sound:!0,vibration:!0,crisisAlerts:!0,messages:!0,reminders:!0,achievements:!0,systemUpdates:!1,quietHours:{enabled:!1,start:"22:00",end:"08:00"},frequency:"all"}),u(this,"isOnline",navigator.onLine),u(this,"vapidPublicKey",$.VAPID_PUBLIC_KEY||""),u(this,"_addToast",null),this.init(),this.setupEventListeners(),this.loadPreferences()}init(){return m(this,null,function*(){if("Notification"in window&&"serviceWorker"in navigator)try{this.serviceWorkerRegistration=yield navigator.serviceWorker.ready}catch(e){}})}setupEventListeners(){window.addEventListener("online",()=>{this.isOnline=!0,this.flushNotificationQueue()}),window.addEventListener("offline",()=>{this.isOnline=!1}),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",e=>{"notification-click"===e.data.type&&this.handleNotificationClick(e.data)}),document.addEventListener("visibilitychange",()=>{document.hidden||this.checkMissedNotifications()})}loadPreferences(){const e=localStorage.getItem("notification_preferences");e&&(this.preferences=c(c({},this.preferences),JSON.parse(e)))}savePreferences(){localStorage.setItem("notification_preferences",JSON.stringify(this.preferences))}requestPermission(){return m(this,null,function*(){if(!("Notification"in window))return"denied";if("granted"===Notification.permission)return"granted";const e=yield Notification.requestPermission();return"granted"===e&&(yield this.subscribeToPushNotifications()),e})}subscribeToPushNotifications(){return m(this,null,function*(){if(this.serviceWorkerRegistration&&this.vapidPublicKey)try{const e=this.urlBase64ToUint8Array(this.vapidPublicKey),t=yield this.serviceWorkerRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:e});yield re.post("/notifications/subscribe",{subscription:t.toJSON(),preferences:this.preferences})}catch(e){}})}urlBase64ToUint8Array(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),i=window.atob(t),n=new Uint8Array(i.length);for(let s=0;s<i.length;++s)n[s]=i.charCodeAt(s);return n.buffer}show(e){return m(this,null,function*(){if(this.preferences.enabled){if("granted"!==Notification.permission){if("granted"!==(yield this.requestPermission()))return}if(this.isInQuietHours()&&"crisis"!==e.urgency)this.queueNotification(e);else if(this.shouldShowNotification(e)){e.icon||(e.icon="/icon-192.png"),"crisis"===e.urgency&&this.preferences.vibration&&(e.vibrate=[200,100,200,100,200],e.requireInteraction=!0);try{this.serviceWorkerRegistration?yield this.serviceWorkerRegistration.showNotification(e.title,{body:e.body,icon:e.icon,badge:e.badge,tag:e.tag||`notification-${Date.now()}`,data:e.data,requireInteraction:e.requireInteraction,silent:e.silent||!this.preferences.sound}):new Notification(e.title,{body:e.body,icon:e.icon,badge:e.badge,tag:e.tag,data:e.data,requireInteraction:e.requireInteraction,silent:e.silent||!this.preferences.sound}),this.trackNotification("shown",e)}catch(t){this.isOnline||this.queueNotification(e)}}}})}isInQuietHours(){if(!this.preferences.quietHours.enabled)return!1;const e=new Date,t=60*e.getHours()+e.getMinutes(),[i,n]=this.preferences.quietHours.start.split(":").map(Number),[s,r]=this.preferences.quietHours.end.split(":").map(Number),o=60*i+n,a=60*s+r;return o<=a?t>=o&&t<a:t>=o||t<a}shouldShowNotification(e){const{frequency:t}=this.preferences;if("crisis-only"===t&&"crisis"!==e.urgency)return!1;if("important"===t&&"low"===e.urgency)return!1;switch(e.category){case"crisis":return this.preferences.crisisAlerts;case"message":return this.preferences.messages;case"reminder":return this.preferences.reminders;case"achievement":return this.preferences.achievements;case"system":return this.preferences.systemUpdates;default:return!0}}queueNotification(e){this.notificationQueue.push(e),localStorage.setItem("notification_queue",JSON.stringify(this.notificationQueue))}flushNotificationQueue(){return m(this,null,function*(){const e=localStorage.getItem("notification_queue");e&&(this.notificationQueue=JSON.parse(e));for(const t of this.notificationQueue)yield this.show(t);this.notificationQueue=[],localStorage.removeItem("notification_queue")})}scheduleNotification(e,t,i){const n=`scheduled-${Date.now()}-${Math.random()}`;return(()=>{const s=new Date,r=t.getTime()-s.getTime();if(r<=0)this.show(e),i&&this.scheduleNextOccurrence(n,e,t,i);else{const s=setTimeout(()=>{this.show(e),i?this.scheduleNextOccurrence(n,e,t,i):this.scheduledNotifications.delete(n)},r);this.scheduledNotifications.set(n,s)}})(),this.storeScheduledNotification({id:n,notification:e,scheduledTime:t,recurring:i}),n}scheduleNextOccurrence(e,t,i,n){let s=new Date(i);if(n){switch(n.type){case"daily":s.setDate(s.getDate()+1);break;case"weekly":if(n.daysOfWeek&&n.daysOfWeek.length>0){let e=1;const t=s.getDay();for(let i=1;i<=7;i++){const s=(t+i)%7;if(n.daysOfWeek.includes(s)){e=i;break}}s.setDate(s.getDate()+e)}else s.setDate(s.getDate()+7);break;case"monthly":n.dayOfMonth?(s.setMonth(s.getMonth()+1),s.setDate(n.dayOfMonth)):s.setMonth(s.getMonth()+1)}this.scheduleNotification(t,s,n)}}cancelScheduledNotification(e){const t=this.scheduledNotifications.get(e);t&&(clearTimeout(t),this.scheduledNotifications.delete(e)),this.removeScheduledNotification(e)}storeScheduledNotification(e){const t=localStorage.getItem("scheduled_notifications"),i=t?JSON.parse(t):[];i.push(e),localStorage.setItem("scheduled_notifications",JSON.stringify(i))}removeScheduledNotification(e){const t=localStorage.getItem("scheduled_notifications");if(t){const i=JSON.parse(t).filter(t=>t.id!==e);localStorage.setItem("scheduled_notifications",JSON.stringify(i))}}loadScheduledNotifications(){const e=localStorage.getItem("scheduled_notifications");if(e){const t=JSON.parse(e);for(const e of t)this.scheduleNotification(e.notification,new Date(e.scheduledTime),e.recurring)}}handleNotificationClick(e){const t=e;if(this.trackNotification("clicked",t),t.action)switch(t.action){case"view":t.url&&(window.location.href=t.url);break;case"dismiss":break;case"snooze":const e=new Date(Date.now()+6e5);this.scheduleNotification(t.notification,e);break;default:window.dispatchEvent(new CustomEvent("notification-action",{detail:t}))}else t.url&&(window.location.href=t.url)}checkMissedNotifications(){return m(this,null,function*(){try{const e=yield re.get("/notifications/missed");for(const t of e)yield this.show(t)}catch(e){}})}trackNotification(e,t){re.post("/notifications/track",{event:e,category:t.category,urgency:t.urgency,timestamp:(new Date).toISOString()}).catch(console.error)}updatePreferences(e){this.preferences=c(c({},this.preferences),e),this.savePreferences(),re.post("/notifications/preferences",this.preferences).catch(console.error)}getPreferences(){return c({},this.preferences)}showCrisisNotification(e,t,i){return m(this,null,function*(){yield this.show({title:e,body:t,urgency:"crisis",category:"crisis",requireInteraction:!0,actions:[{action:"view",title:"Get Help Now"},{action:"dismiss",title:"Dismiss"}],data:d(c({},i),{url:"/crisis-support"})})})}showMessageNotification(e,t,i){return m(this,null,function*(){yield this.show({title:`New message from ${e}`,body:t,category:"message",urgency:"normal",tag:`message-${i}`,actions:[{action:"view",title:"Reply"},{action:"dismiss",title:"Later"}],data:{url:`/chat/${i}`}})})}showReminderNotification(e,t,i){return m(this,null,function*(){yield this.show({title:e,body:t,category:"reminder",urgency:"normal",tag:`reminder-${i}`,actions:[{action:"view",title:"Open"},{action:"snooze",title:"Snooze"},{action:"dismiss",title:"Dismiss"}]})})}showAchievementNotification(e,t){return m(this,null,function*(){yield this.show({title:`Achievement Unlocked: ${e}`,body:t,category:"achievement",urgency:"low",icon:"/achievements-icon.png"})})}clearAll(){return m(this,null,function*(){if(this.serviceWorkerRegistration){(yield this.serviceWorkerRegistration.getNotifications()).forEach(e=>e.close())}})}clearByTag(e){return m(this,null,function*(){if(this.serviceWorkerRegistration){(yield this.serviceWorkerRegistration.getNotifications({tag:e})).forEach(e=>e.close())}})}isSupported(){return"Notification"in window&&"serviceWorker"in navigator}getPermissionStatus(){return Notification.permission}testNotification(){return m(this,null,function*(){yield this.show({title:"Test Notification",body:"This is a test notification from Astral Core",category:"system",urgency:"low"})})}setToastFunction(e){this._addToast=e}addToast(e,t="success"){this._addToast?this._addToast(e,t):alert(e)}};"undefined"!=typeof window&&window.addEventListener("load",()=>{oe.loadScheduledNotifications()});const ae=new class{constructor(){u(this,"isReady",!1),u(this,"onlineCallbacks",[]),u(this,"offlineCallbacks",[]),u(this,"updateCallbacks",[]),u(this,"onNotification")}initialize(){return m(this,null,function*(){if(!("serviceWorker"in navigator))return{supported:!1};try{yield navigator.serviceWorker.register("/sw.js");return{supported:!0,registered:!0}}catch(e){return{supported:!0,registered:!1}}})}hasMessageChannel(){return!0}cacheResources(e){return m(this,null,function*(){return!0})}preloadCriticalResources(e){return m(this,null,function*(){})}registerBackgroundSync(e){return m(this,null,function*(){})}queueOfflineAction(e){return m(this,null,function*(){})}setupPushNotifications(e){return m(this,null,function*(){return null})}sendNotification(e){return m(this,null,function*(){})}isOfflineReady(){return m(this,null,function*(){return this.isReady})}getCacheStatus(){return m(this,null,function*(){return{staticResources:!1,crisisResources:!1,translations:!1,culturalContent:!1,aiModels:!1,swRegistered:"serviceWorker"in navigator,cacheVersion:"1.0.0",updateAvailable:!1}})}skipWaiting(){return m(this,null,function*(){})}checkForUpdates(){return m(this,null,function*(){return!1})}clearCache(e){return m(this,null,function*(){return!0})}cacheCrisisResource(e){return m(this,null,function*(){return!0})}precacheCrisisResources(){return m(this,null,function*(){})}forceReload(){window.location.reload()}onOnline(e){this.onlineCallbacks.push(e)}onOffline(e){this.offlineCallbacks.push(e)}onUpdateAvailable(e){this.updateCallbacks.push(e)}removeOnlineListener(e){const t=this.onlineCallbacks.indexOf(e);t>-1&&this.onlineCallbacks.splice(t,1)}removeOfflineListener(e){const t=this.offlineCallbacks.indexOf(e);t>-1&&this.offlineCallbacks.splice(t,1)}removeUpdateListener(e){const t=this.updateCallbacks.indexOf(e);t>-1&&this.updateCallbacks.splice(t,1)}getNetworkStatus(){var e;const t=navigator;return{isOnline:navigator.onLine,type:(null==(e=t.connection)?void 0:e.effectiveType)||"unknown"}}};const le=new class{constructor(){u(this,"installPrompt",null),u(this,"isOffline",!navigator.onLine),u(this,"installPromptShown",!1),u(this,"statusCallbacks",[]),this.initializeEventListeners(),this.initializeOfflineDetection(),this.initializeInstallPromptHandling(),this.initializeMobileOptimizations()}initializeEventListeners(){window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),this.installPrompt=e,this.notifyStatusChange()}),window.addEventListener("appinstalled",()=>{this.installPrompt=null,this.notifyStatusChange()}),document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState?this.handleAppFocus():this.handleAppBlur()})}initializeOfflineDetection(){window.addEventListener("online",()=>{this.isOffline=!1,this.handleOnlineStatusChange(!0),this.notifyStatusChange()}),window.addEventListener("offline",()=>{this.isOffline=!0,this.handleOnlineStatusChange(!1),this.notifyStatusChange()})}initializeInstallPromptHandling(){}initializeMobileOptimizations(){this.isMobile()&&(this.handleMobileViewport(),this.initializeTouchOptimizations())}isMobile(){return/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}handleMobileViewport(){if(!document.querySelector('meta[name="viewport"]')){const e=document.createElement("meta");e.name="viewport",e.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no",document.head.appendChild(e)}}initializeTouchOptimizations(){document.body.style.touchAction="manipulation"}handleAppFocus(){}handleAppBlur(){}handleOnlineStatusChange(e){e?this.syncPendingData():this.enableOfflineMode()}syncPendingData(){}enableOfflineMode(){}getStatus(){return{isInstallable:null!==this.installPrompt,isInstalled:this.isStandalone(),isOffline:this.isOffline,isStandalone:this.isStandalone(),supportsPWA:this.supportsPWA()}}isStandalone(){return window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://")}supportsPWA(){return"serviceWorker"in navigator&&"BeforeInstallPromptEvent"in window}showInstallPrompt(){return m(this,null,function*(){if(!this.installPrompt)return!1;try{yield this.installPrompt.prompt();const e=yield this.installPrompt.userChoice;return this.installPromptShown=!0,"accepted"===e.outcome&&(this.installPrompt=null),this.notifyStatusChange(),"accepted"===e.outcome}catch(e){return!1}})}onStatusChange(e){return this.statusCallbacks.push(e),()=>{const t=this.statusCallbacks.indexOf(e);t>-1&&this.statusCallbacks.splice(t,1)}}notifyStatusChange(){const e=this.getStatus();this.statusCallbacks.forEach(t=>{try{t(e)}catch(i){}})}},ce=e=>m(null,null,function*(){if("serviceWorker"in navigator)try{const t=yield navigator.serviceWorker.register("/sw.js",{scope:"/"});return null==e||e.onSuccess,setInterval(()=>{t.update()},6e4),t.addEventListener("updatefound",()=>{const i=t.installing;i&&i.addEventListener("statechange",()=>{"activated"===i.state&&((null==e?void 0:e.onUpdate)||window.confirm("New version available! Reload to update?")&&window.location.reload())})}),t}catch(t){return null}return null}),de=class e{constructor(){u(this,"sessionId"),u(this,"userId"),u(this,"report"),u(this,"observers",new Map),u(this,"isInitialized",!1),u(this,"reportInterval",null),u(this,"interactionBuffer",[]),u(this,"errorBuffer",[]),u(this,"thresholds",{FCP:{good:1800,poor:3e3},LCP:{good:2500,poor:4e3},INP:{good:200,poor:500},CLS:{good:.1,poor:.25},TTFB:{good:800,poor:1800}}),this.sessionId=this.generateSessionId(),this.report=this.createEmptyReport()}static getInstance(){return e.instance||(e.instance=new e),e.instance}initialize(e){this.isInitialized||(this.userId=e,this.isInitialized=!0,this.monitorWebVitals(),this.monitorResourceTiming(),this.monitorUserInteractions(),this.monitorErrors(),this.monitorMemory(),this.monitorConnection(),this.setupPeriodicReporting(),this.monitorPageVisibility())}monitorWebVitals(){y(e=>{this.report.webVitals.FCP=this.formatWebVital("FCP",e.value),this.logMetric("FCP",e.value)}),f(e=>{this.report.webVitals.LCP=this.formatWebVital("LCP",e.value),this.logMetric("LCP",e.value)}),S(e=>{this.report.webVitals.INP=this.formatWebVital("INP",e.value),this.logMetric("INP",e.value)}),v(e=>{this.report.webVitals.CLS=this.formatWebVital("CLS",e.value),this.logMetric("CLS",e.value)}),I(e=>{this.report.webVitals.TTFB=this.formatWebVital("TTFB",e.value),this.logMetric("TTFB",e.value)})}monitorResourceTiming(){if(!("PerformanceObserver"in window))return;const e=new PerformanceObserver(e=>{for(const t of e.getEntries())if("resource"===t.entryType){const e=t,i={name:e.name,type:this.getResourceType(e.name),duration:e.duration,size:e.transferSize||0,startTime:e.startTime,cached:0===e.transferSize};this.report.resources.push(i),i.duration>3e3&&this.trackCustomMetric("slow_resource",i.duration,{url:i.name,type:i.type})}});try{e.observe({entryTypes:["resource"]}),this.observers.set("resource",e)}catch(t){}}monitorUserInteractions(){if(document.addEventListener("click",e=>{const t=e.target,i={type:"click",target:this.getTargetSelector(t),timestamp:Date.now(),duration:0,successful:!0};this.interactionBuffer.push(i),this.pruneInteractionBuffer()}),document.addEventListener("submit",e=>{const t=e.target,i={type:"form_submit",target:this.getTargetSelector(t),timestamp:Date.now(),duration:0,successful:!0};this.interactionBuffer.push(i)}),"PerformanceNavigationTiming"in window){const e=performance.getEntriesByType("navigation")[0];e&&e instanceof PerformanceNavigationTiming&&(this.trackCustomMetric("page_load_time",e.loadEventEnd-e.fetchStart),this.trackCustomMetric("dom_interactive",e.domInteractive-e.fetchStart),this.trackCustomMetric("dom_complete",e.domComplete-e.fetchStart))}}monitorErrors(){window.addEventListener("error",e=>{var t;const i={message:e.message,stack:null==(t=e.error)?void 0:t.stack,timestamp:Date.now()};this.errorBuffer.push(i),this.pruneErrorBuffer(),(e.message.includes("crisis")||e.message.includes("emergency"))&&this.trackCustomMetric("critical_error",1,{message:e.message})}),window.addEventListener("unhandledrejection",e=>{var t;const i={message:`Unhandled Promise Rejection: ${e.reason}`,stack:null==(t=e.reason)?void 0:t.stack,timestamp:Date.now()};this.errorBuffer.push(i),this.pruneErrorBuffer()})}monitorMemory(){"memory"in performance&&setInterval(()=>{const e=performance.memory;if(e){this.report.memory={usedJSHeapSize:e.usedJSHeapSize,totalJSHeapSize:e.totalJSHeapSize,jsHeapSizeLimit:e.jsHeapSizeLimit};const t=e.usedJSHeapSize/e.jsHeapSizeLimit;t>.9&&this.trackCustomMetric("high_memory_usage",100*t,{used:e.usedJSHeapSize,limit:e.jsHeapSizeLimit})}},1e4)}monitorConnection(){if(!("connection"in navigator))return;const e=navigator.connection;e&&(this.report.connection={effectiveType:e.effectiveType,downlink:e.downlink,rtt:e.rtt,saveData:e.saveData},"2g"!==e.effectiveType&&"slow-2g"!==e.effectiveType||this.trackCustomMetric("slow_connection",1,{type:e.effectiveType,rtt:e.rtt}),e.addEventListener("change",()=>{this.report.connection={effectiveType:e.effectiveType,downlink:e.downlink,rtt:e.rtt,saveData:e.saveData}}))}monitorPageVisibility(){let e=0,t=Date.now();document.addEventListener("visibilitychange",()=>{if(document.hidden){e=Date.now();const i=e-t;this.trackCustomMetric("page_active_time",i)}else if(t=Date.now(),e>0){const i=t-e;this.trackCustomMetric("page_inactive_time",i)}})}trackCustomMetric(e,t,i){const n={name:e,value:t,rating:this.getMetricRating(e,t),timestamp:Date.now(),metadata:i};this.report.customMetrics.push(n),this.logMetric(e,t)}trackComponentRender(e,t){this.trackCustomMetric(`component_render_${e}`,t,{component:e})}trackApiCall(e,t,i){this.trackCustomMetric("api_call",t,{endpoint:e,status:i,success:i>=200&&i<300})}trackCrisisResourceLoad(e,t){this.trackCustomMetric("crisis_resource_load",t,{type:e,critical:!0})}setupPeriodicReporting(){this.reportInterval=window.setInterval(()=>{this.sendReport()},3e4),window.addEventListener("beforeunload",()=>{this.sendReport()})}sendReport(){return m(this,null,function*(){if(0===this.report.customMetrics.length&&0===Object.keys(this.report.webVitals).length)return;this.report.interactions=[...this.interactionBuffer],this.report.errors=[...this.errorBuffer];const e=d(c({},this.report),{timestamp:Date.now(),url:window.location.href,userAgent:navigator.userAgent});try{yield fetch("/api/performance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),this.report=this.createEmptyReport(),this.interactionBuffer=[],this.errorBuffer=[]}catch(t){}})}calculateWebVitalsScore(){const e=this.report.webVitals;let t=100;const i=[];return e.FCP&&("needs-improvement"===e.FCP.rating&&(t-=10),"poor"===e.FCP.rating&&(t-=20,i.push("Improve First Contentful Paint by optimizing critical rendering path"))),e.LCP&&("needs-improvement"===e.LCP.rating&&(t-=10),"poor"===e.LCP.rating&&(t-=20,i.push("Optimize Largest Contentful Paint by lazy loading images and optimizing server response time"))),{score:t,recommendations:i}}getInteractionRecommendations(){const e=this.report.webVitals;let t=0;const i=[];return e.INP&&("needs-improvement"===e.INP.rating&&(t+=10),"poor"===e.INP.rating&&(t+=20,i.push("Reduce Interaction to Next Paint by breaking up long tasks and optimizing JavaScript execution"))),e.CLS&&("needs-improvement"===e.CLS.rating&&(t+=10),"poor"===e.CLS.rating&&(t+=20,i.push("Fix Cumulative Layout Shift by specifying dimensions for images and avoiding dynamic content injection"))),{scoreReduction:t,recommendations:i}}getSystemRecommendations(){var e,t;const i=[];if(this.report.memory){this.report.memory.usedJSHeapSize/this.report.memory.jsHeapSizeLimit>.8&&i.push("High memory usage detected. Consider optimizing data structures and clearing unused references")}return"2g"!==(null==(e=this.report.connection)?void 0:e.effectiveType)&&"slow-2g"!==(null==(t=this.report.connection)?void 0:t.effectiveType)||i.push("Slow connection detected. Ensure critical resources are cached and minimize payload sizes"),i}getPerformanceSummary(){const e=this.calculateWebVitalsScore(),t=this.getInteractionRecommendations(),i=this.getSystemRecommendations(),n=Math.max(0,e.score-t.scoreReduction),s=[...e.recommendations,...t.recommendations,...i];return{webVitals:this.report.webVitals,score:n,recommendations:s}}formatWebVital(e,t){return{name:e,value:t,rating:this.getWebVitalRating(e,t),timestamp:Date.now()}}getWebVitalRating(e,t){const i=this.thresholds[e];return i?t<=i.good?"good":t<=i.poor?"needs-improvement":"poor":"good"}getMetricRating(e,t){return e.includes("component_render")?t<100?"good":t<300?"needs-improvement":"poor":"api_call"===e?t<1e3?"good":t<3e3?"needs-improvement":"poor":"good"}getResourceType(e){if(e.includes(".js"))return"script";if(e.includes(".css"))return"style";if(/\.(jpg|jpeg|png|gif|webp|svg)/.exec(e))return"image";return/\.(woff|woff2|ttf|otf)/.exec(e)?"font":e.includes("/api/")?"api":"other"}getTargetSelector(e){return e.id?`#${e.id}`:e.className&&"string"==typeof e.className?`.${e.className.split(" ")[0]}`:e.tagName.toLowerCase()}generateSessionId(){return`${Date.now()}-${Math.random().toString(36).substring(2,11)}`}createEmptyReport(){return{sessionId:this.sessionId,userId:this.userId,timestamp:Date.now(),url:window.location.href,userAgent:navigator.userAgent,webVitals:{},customMetrics:[],resources:[],interactions:[],errors:[]}}logMetric(e,t){}pruneInteractionBuffer(){this.interactionBuffer.length>50&&(this.interactionBuffer=this.interactionBuffer.slice(-50))}pruneErrorBuffer(){this.errorBuffer.length>20&&(this.errorBuffer=this.errorBuffer.slice(-20))}destroy(){this.reportInterval&&clearInterval(this.reportInterval),this.observers.forEach(e=>e.disconnect()),this.observers.clear(),this.sendReport(),this.isInitialized=!1}};u(de,"instance");const ue=de.getInstance(),me=ue;function he(e){if(!e)return"";const t=e=>{const t=document.createElement("div");return t.textContent=e,t.innerHTML};let i=t(e);return i=i.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"),i=i.replace(/\[([^\]]+)\]\(([^)]+)\)/g,(e,i,n)=>{if((e=>{try{const t=new URL(e);return["http:","https:","mailto:"].includes(t.protocol)}catch(Me){return e.startsWith("/")||e.startsWith("#")}})(n)){return`<a href="${t(n)}" target="_blank" rel="noopener noreferrer">${t(i)}</a>`}return t(e)}),i}"undefined"!=typeof window&&window.addEventListener("load",()=>{ue.initialize()});const pe=e=>{if(!e)return"Unknown";const t=new Date,i="string"==typeof e?new Date(e):e;if(isNaN(i.getTime()))return"Invalid date";const n=Math.floor((t.getTime()-i.getTime())/1e3);if(n<60)return`${Math.floor(n)}s ago`;const s=n/60;if(s<60)return`${Math.floor(s)}m ago`;const r=s/60;if(r<24)return`${Math.floor(r)}h ago`;const o=r/24;if(o<30)return`${Math.floor(o)}d ago`;const a=o/30;if(a<12)return`${Math.floor(a)}mo ago`;const l=o/365;return`${Math.floor(l)}y ago`},ge=e=>{const t=new Date(e),i=new Date(Date.now());if(t.getDate()===i.getDate()&&t.getMonth()===i.getMonth()&&t.getFullYear()===i.getFullYear())return t.toLocaleTimeString(navigator.language,{hour:"numeric",minute:"2-digit"});const n=new Date(Date.now());n.setDate(n.getDate()-1);return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()?`Yesterday at ${t.toLocaleTimeString(navigator.language,{hour:"numeric",minute:"2-digit"})}`:t.toLocaleDateString(navigator.language,{year:"numeric",month:"short",day:"numeric"})};const ye=new class{analyzeCrisisWithML(e,t){return m(this,null,function*(){const i=e.toLowerCase(),n=["suicide","suicidal","kill myself","end it all","can't go on","hopeless","worthless","want to die","better off dead","no reason to live","end my life","overdose","cutting","self-harm","hurt myself","hurting myself","drunk","drinking heavily","pills","jumped","bridge","gun","rope","blade","no puedo más","quiero morir"].filter(e=>i.includes(e)),s=n.length>0?Math.min(.4*n.length,1):0;return{crisisLevel:s,confidence:s>0?Math.max(.7,s):.3,riskFactors:n,immediateAction:s>.5,recommendations:s>.5?["Contact crisis helpline","Seek immediate support"]:[],culturalContext:t,hasCrisisIndicators:s>.3,mlConfidence:s>0?Math.max(.7,s):.3,psychologicalAssessment:{depressionIndicators:.8*s,anxietyIndicators:.6*s,suicidalIdeation:.9*s},behavioralPattern:{communicationStyle:s>.5?"distressed":"normal",helpSeekingBehavior:s>.3?"active":"passive",escalationTriggers:n},realTimeRisk:{immediateRisk:100*s,interventionUrgency:10*s,recommendedInterventions:s>0?[{priority:Math.round(10*s),description:"Immediate crisis support"},{priority:Math.round(5*s),description:"Follow-up care"}]:[]},biasAdjustments:[],emotionalState:{primary:s>.5?"distress":"neutral",primaryEmotion:s>.5?"despair":"neutral",intensity:s,valence:-s,arousal:.8*s,dominance:.5*-s,timestamp:Date.now()}}})}detectCrisis(e){return m(this,null,function*(){const t=yield this.analyzeCrisisWithML(e);return{isCrisis:t.crisisLevel>.3,severity:t.crisisLevel}})}};
/**
 * Cultural Context Service
 * 
 * Provides cultural context information for privacy-preserving analytics
 * and culturally-sensitive crisis intervention analysis.
 * 
 * @license Apache-2.0
 */const fe=new class{constructor(){u(this,"culturalContexts",{en:{region:"Western",mentalHealthStigma:"medium",familyInvolvement:"individual",crisisEscalation:"direct",communicationStyle:"direct"},es:{region:"Hispanic/Latino",mentalHealthStigma:"high",familyInvolvement:"family-centered",crisisEscalation:"gradual",communicationStyle:"contextual"},"pt-BR":{region:"Brazilian",mentalHealthStigma:"high",familyInvolvement:"family-centered",crisisEscalation:"gradual",communicationStyle:"contextual"},pt:{region:"Portuguese",mentalHealthStigma:"medium",familyInvolvement:"family-centered",crisisEscalation:"gradual",communicationStyle:"contextual"},ar:{region:"Arabic",mentalHealthStigma:"high",familyInvolvement:"family-centered",crisisEscalation:"authority-based",communicationStyle:"indirect"},zh:{region:"Chinese",mentalHealthStigma:"high",familyInvolvement:"family-centered",crisisEscalation:"gradual",communicationStyle:"indirect"},vi:{region:"Vietnamese",mentalHealthStigma:"high",familyInvolvement:"family-centered",crisisEscalation:"authority-based",communicationStyle:"indirect"},tl:{region:"Filipino",mentalHealthStigma:"high",familyInvolvement:"family-centered",crisisEscalation:"gradual",communicationStyle:"contextual"}})}getCulturalContext(e){return this.culturalContexts[e]||this.culturalContexts.en}getAllCulturalContexts(){return c({},this.culturalContexts)}getCulturalRegions(){return[...new Set(Object.values(this.culturalContexts).map(e=>e.region))]}};
/**
 * Privacy-Preserving Analytics Service
 * 
 * Measures crisis intervention effectiveness across languages and cultures
 * while maintaining HIPAA compliance and user privacy through:
 * - Differential privacy for statistical analysis
 * - Homomorphic encryption for secure computations
 * - Federated analytics for distributed learning
 * - Zero-knowledge proofs for outcome verification
 * 
 * @license Apache-2.0
 */const Se=new class{constructor(){u(this,"EPSILON",1),u(this,"MAX_RETENTION_DAYS",90),u(this,"MIN_COHORT_SIZE",10),u(this,"analyticsData",[]),u(this,"privacyBudgetUsed",0),this.initializeEncryption(),this.setupPeriodicCleanup()}initializeEncryption(){return m(this,null,function*(){try{yield crypto.subtle.generateKey({name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}catch(e){}})}setupPeriodicCleanup(){setInterval(()=>{this.cleanupExpiredData()},864e5)}cleanupExpiredData(){const e=Date.now()-24*this.MAX_RETENTION_DAYS*60*60*1e3,t=this.analyticsData.length;this.analyticsData=this.analyticsData.filter(t=>t.timestamp>e);this.analyticsData.length}generateAnonymizedHash(e,t){const i=`${e}-${t}-astralcore-privacy-salt-2025`;let n=0;for(let s=0;s<i.length;s++){n=(n<<5)-n+i.charCodeAt(s),n&=n}return Math.abs(n).toString(36)}addDifferentialPrivacyNoise(e,t=1){const i=t/this.EPSILON,n=this.sampleLaplace(0,i);return Math.max(0,e+n)}sampleLaplace(e,t){const i=Math.random()-.5;return e-t*Math.sign(i)*Math.log(1-2*Math.abs(i))}recordInterventionOutcome(e){return m(this,null,function*(){try{const{sessionId:t,userToken:i,language:n,interventionType:s,initialRiskLevel:r,finalRiskLevel:o,sessionDuration:a,feedback:l}=e;if(this.privacyBudgetUsed>=10)return;const c=fe.getCulturalContext(n),d=this.generateAnonymizedHash(i,t),u=this.addDifferentialPrivacyNoise(r,.1),m=this.addDifferentialPrivacyNoise(o,.1),h=l?this.addDifferentialPrivacyNoise(l,.5):0,p=.1;this.privacyBudgetUsed+=p;const g={sessionId:d,anonymizedHash:d,timestamp:Date.now(),language:n,culturalContext:c.region,interventionType:s,initialRiskLevel:u,finalRiskLevel:m,sessionDuration:a,followUpEngagement:!1,anonymizedFeedback:h,privacyBudget:p};this.analyticsData.push(g)}catch(t){}})}recordFollowUpEngagement(e,t){return m(this,null,function*(){try{const i=this.generateAnonymizedHash(e,t),n=this.analyticsData.find(e=>e.anonymizedHash===i);n&&(n.followUpEngagement=!0)}catch(i){}})}calculateCulturalMetrics(e,t){const i=this.analyticsData.filter(i=>i.language===e&&i.culturalContext===t);if(i.length<this.MIN_COHORT_SIZE)return null;const n=i.map(e=>Math.max(0,e.initialRiskLevel-e.finalRiskLevel)),s=this.addDifferentialPrivacyNoise(n.reduce((e,t)=>e+t,0)/n.length,.1),r=i.filter(e=>e.finalRiskLevel<e.initialRiskLevel).length,o=this.addDifferentialPrivacyNoise(r/i.length*100,1),a=this.addDifferentialPrivacyNoise(i.reduce((e,t)=>e+t.sessionDuration,0)/i.length,5),l=this.addDifferentialPrivacyNoise(i.filter(e=>e.followUpEngagement).length/i.length*100,1),c=i.filter(e=>e.anonymizedFeedback>0).map(e=>e.anonymizedFeedback),d=c.length>0?this.addDifferentialPrivacyNoise(c.reduce((e,t)=>e+t,0)/c.length,.2):0,u=1.96*Math.sqrt(o*(100-o)/i.length);return{language:e,culturalGroup:t,totalInterventions:i.length,averageRiskReduction:s,successRate:o,averageSessionDuration:a,followUpRate:l,satisfactionScore:d,confidenceInterval:[Math.max(0,o-u),Math.min(100,o+u)],privacyNoise:this.EPSILON}}generateGlobalMetrics(){const e=this.addDifferentialPrivacyNoise(this.analyticsData.length,1),t=this.analyticsData.length>0?this.addDifferentialPrivacyNoise(this.analyticsData.reduce((e,t)=>e+Math.max(0,t.initialRiskLevel-t.finalRiskLevel),0)/this.analyticsData.length,.1):0,i={},n=[...new Set(this.analyticsData.map(e=>e.language))];for(const o of n){const e=this.analyticsData.filter(e=>e.language===o).length;i[o]=this.addDifferentialPrivacyNoise(e,1)}const s={},r=[...new Set(this.analyticsData.map(e=>e.culturalContext))];for(const o of r){const e=this.analyticsData.filter(e=>e.culturalContext===o).length;s[o]=this.addDifferentialPrivacyNoise(e,1)}return{totalInterventions:e,averageEffectiveness:t,languageDistribution:i,culturalDistribution:s}}generateCulturalComparisons(){const e=[],t=[...new Set(this.analyticsData.map(e=>e.language))];for(const i of t){const t=[...new Set(this.analyticsData.filter(e=>e.language===i).map(e=>e.culturalContext))];for(const n of t){const t=this.calculateCulturalMetrics(i,n);t&&e.push(t)}}return e}generateInterventionTypeEffectiveness(){const e=[...new Set(this.analyticsData.map(e=>e.interventionType))],t={};for(const i of e){const e=this.analyticsData.filter(e=>e.interventionType===i);if(e.length>=this.MIN_COHORT_SIZE){const n=e.reduce((e,t)=>e+Math.max(0,t.initialRiskLevel-t.finalRiskLevel),0)/e.length;t[i]=this.addDifferentialPrivacyNoise(n,.1)}}return t}generateTemporalTrends(){const e=[],t=Date.now();for(let i=6;i>=0;i--){const n=t-7*(i+1)*24*60*60*1e3,s=t-7*i*24*60*60*1e3,r=this.analyticsData.filter(e=>e.timestamp>=n&&e.timestamp<s);if(r.length>0){const t=r.reduce((e,t)=>e+Math.max(0,t.initialRiskLevel-t.finalRiskLevel),0)/r.length;e.push({period:new Date(n).toISOString().split("T")[0],effectiveness:this.addDifferentialPrivacyNoise(t,.1),volume:this.addDifferentialPrivacyNoise(r.length,1)})}}return e}generateAnalyticsInsights(){return m(this,null,function*(){try{const e=this.generateGlobalMetrics(),t=this.generateCulturalComparisons(),i=this.generateInterventionTypeEffectiveness();return{globalMetrics:e,culturalComparisons:t,interventionTypeEffectiveness:i,temporalTrends:this.generateTemporalTrends(),privacyMetrics:{totalBudgetConsumed:this.privacyBudgetUsed,averageNoiseLevel:this.EPSILON,dataRetentionCompliance:!0}}}catch(e){throw e}})}exportAnonymizedData(){return m(this,null,function*(){try{const e=yield this.generateAnalyticsInsights();return{culturalEffectiveness:e.culturalComparisons,aggregatedInsights:e,privacyCompliance:{differentialPrivacyApplied:!0,dataAnonymized:!0,retentionCompliant:!0,minimumCohortSizeEnforced:!0}}}catch(e){throw e}})}generateEffectivenessReport(){return m(this,null,function*(){try{const e=yield this.generateAnalyticsInsights(),t=Math.round(e.globalMetrics.totalInterventions),i=`Analysis of ${t} anonymized crisis interventions shows an average risk reduction of ${(100*e.globalMetrics.averageEffectiveness).toFixed(1)}%. Data spans ${Object.keys(e.globalMetrics.languageDistribution).length} languages and ${Object.keys(e.globalMetrics.culturalDistribution).length} cultural contexts.`,n=[],s=e.culturalComparisons.sort((e,t)=>t.successRate-e.successRate).slice(0,3);for(const r of s)n.push(`${r.language} speakers in ${r.culturalGroup} show ${r.successRate.toFixed(1)}% intervention success rate with ${r.averageRiskReduction.toFixed(2)} average risk reduction.`);return{summary:i,culturalInsights:n,recommendations:["Consider culturally-adapted interventions for communities with lower effectiveness scores","Expand successful intervention types to underperforming cultural contexts","Investigate factors contributing to high-performing cultural interventions","Develop targeted training for cultural sensitivity in crisis intervention"],limitations:[`Differential privacy noise (ε=${this.EPSILON}) added to all metrics for privacy protection`,`Minimum cohort size of ${this.MIN_COHORT_SIZE} enforced to prevent re-identification`,"Individual outcomes cannot be traced to specific users",`Data automatically deleted after ${this.MAX_RETENTION_DAYS} days for HIPAA compliance`]}}catch(e){throw e}})}getPrivacyMetrics(){return{budgetUsed:this.privacyBudgetUsed,budgetRemaining:Math.max(0,10-this.privacyBudgetUsed),dataPoints:this.analyticsData.length,retentionCompliance:!0}}resetPrivacyBudget(){this.privacyBudgetUsed=0}};
/**
 * Cultural Crisis Detection Service
 * 
 * Enhances the existing AI crisis detection with comprehensive cultural context awareness
 * and bias mitigation to ensure fair and accurate crisis prediction across diverse
 * cultural backgrounds, communication styles, and help-seeking behaviors.
 * 
 * Features:
 * - Cultural communication style adaptation
 * - Bias reduction algorithms for cultural factors
 * - Culture-specific crisis expression patterns
 * - Culturally-appropriate intervention recommendations
 * - Privacy-preserving cultural analytics
 * - Multi-language crisis detection optimization
 * - Cultural help-seeking behavior analysis
 * - Family involvement preferences integration
 * 
 * @license Apache-2.0
 */const ve=new class{constructor(){u(this,"CULTURAL_BIAS_REDUCTION_FACTOR",.2),u(this,"MIN_CULTURAL_CONFIDENCE",.6),u(this,"culturalCrisisPatterns",{Western:[{indicator:"I am depressed",weight:.7,culturalRegions:["Western"],communicationStyle:"direct",expressionType:"verbal",culturalSignificance:.8},{indicator:"I need help",weight:.8,culturalRegions:["Western"],communicationStyle:"direct",expressionType:"verbal",culturalSignificance:.9},{indicator:"feeling overwhelmed",weight:.6,culturalRegions:["Western"],communicationStyle:"direct",expressionType:"verbal",culturalSignificance:.7}],"Hispanic/Latino":[{indicator:"me siento mal",weight:.8,culturalRegions:["Hispanic/Latino","Brazilian"],communicationStyle:"contextual",expressionType:"somatic",culturalSignificance:.9},{indicator:"no puedo más",weight:.9,culturalRegions:["Hispanic/Latino"],communicationStyle:"contextual",expressionType:"verbal",culturalSignificance:.9},{indicator:"dolor en el corazón",weight:.7,culturalRegions:["Hispanic/Latino"],communicationStyle:"metaphorical",expressionType:"somatic",culturalSignificance:.8},{indicator:"estoy en las manos de Dios",weight:.6,culturalRegions:["Hispanic/Latino"],communicationStyle:"indirect",expressionType:"metaphorical",culturalSignificance:.7}],Arabic:[{indicator:"الله يساعدني",weight:.8,culturalRegions:["Arabic"],communicationStyle:"indirect",expressionType:"verbal",culturalSignificance:.9},{indicator:"قلبي مكسور",weight:.7,culturalRegions:["Arabic"],communicationStyle:"metaphorical",expressionType:"somatic",culturalSignificance:.8},{indicator:"تعبان نفسياً",weight:.9,culturalRegions:["Arabic"],communicationStyle:"indirect",expressionType:"somatic",culturalSignificance:.9},{indicator:"مش قادر أكمل",weight:.8,culturalRegions:["Arabic"],communicationStyle:"indirect",expressionType:"verbal",culturalSignificance:.8}],Chinese:[{indicator:"心里不舒服",weight:.8,culturalRegions:["Chinese"],communicationStyle:"indirect",expressionType:"somatic",culturalSignificance:.9},{indicator:"压力很大",weight:.7,culturalRegions:["Chinese"],communicationStyle:"indirect",expressionType:"somatic",culturalSignificance:.8},{indicator:"想不开",weight:.9,culturalRegions:["Chinese"],communicationStyle:"indirect",expressionType:"metaphorical",culturalSignificance:.9},{indicator:"活着没意思",weight:.9,culturalRegions:["Chinese"],communicationStyle:"indirect",expressionType:"verbal",culturalSignificance:.8}],Vietnamese:[{indicator:"tôi buồn lắm",weight:.7,culturalRegions:["Vietnamese"],communicationStyle:"indirect",expressionType:"verbal",culturalSignificance:.8},{indicator:"không có hy vọng",weight:.9,culturalRegions:["Vietnamese"],communicationStyle:"indirect",expressionType:"verbal",culturalSignificance:.9},{indicator:"đau lòng quá",weight:.8,culturalRegions:["Vietnamese"],communicationStyle:"indirect",expressionType:"somatic",culturalSignificance:.8}],Filipino:[{indicator:"napakahirap",weight:.8,culturalRegions:["Filipino"],communicationStyle:"contextual",expressionType:"verbal",culturalSignificance:.8},{indicator:"walang pag-asa",weight:.9,culturalRegions:["Filipino"],communicationStyle:"contextual",expressionType:"verbal",culturalSignificance:.9},{indicator:"sakit sa puso",weight:.7,culturalRegions:["Filipino"],communicationStyle:"metaphorical",expressionType:"somatic",culturalSignificance:.8}]}),u(this,"crisisCommunicationPatterns",[{pattern:"I am thinking about suicide",culturalContext:["Western"],implicitness:.1,stigmaLevel:"medium",familyInvolvementImplied:!1,helpSeekingStyle:"direct"},{pattern:"La familia no puede saber",culturalContext:["Hispanic/Latino"],implicitness:.7,stigmaLevel:"high",familyInvolvementImplied:!0,helpSeekingStyle:"indirect"},{pattern:"Dios me ayudará",culturalContext:["Hispanic/Latino","Filipino"],implicitness:.8,stigmaLevel:"high",familyInvolvementImplied:!1,helpSeekingStyle:"religious"},{pattern:"إن شاء الله سيكون أفضل",culturalContext:["Arabic"],implicitness:.9,stigmaLevel:"high",familyInvolvementImplied:!1,helpSeekingStyle:"religious"},{pattern:"العائلة لا تفهم",culturalContext:["Arabic"],implicitness:.6,stigmaLevel:"high",familyInvolvementImplied:!0,helpSeekingStyle:"indirect"},{pattern:"家人会担心",culturalContext:["Chinese"],implicitness:.8,stigmaLevel:"high",familyInvolvementImplied:!0,helpSeekingStyle:"indirect"},{pattern:"不好意思说",culturalContext:["Chinese","Vietnamese"],implicitness:.9,stigmaLevel:"high",familyInvolvementImplied:!1,helpSeekingStyle:"indirect"},{pattern:"gia đình sẽ xấu hổ",culturalContext:["Vietnamese"],implicitness:.8,stigmaLevel:"high",familyInvolvementImplied:!0,helpSeekingStyle:"indirect"},{pattern:"nakakahiya sa pamilya",culturalContext:["Filipino"],implicitness:.7,stigmaLevel:"high",familyInvolvementImplied:!0,helpSeekingStyle:"community"}])}analyzeCrisisWithCulturalContext(e,t,i="en",n){return m(this,null,function*(){var s;const r=yield ye.analyzeCrisisWithML(e,{userId:t,languageCode:i,culturalContext:n}),o=fe.getCulturalContext(i),a=n||o.region,l=this.detectCulturalCrisisIndicators(e,a),u=this.analyzeCommunicationPatterns(e,a),m=this.calculateCulturalBiasAdjustments(r,o,l,u),h=this.calculateCulturallyAdjustedRisk((null==(s=r.realTimeRisk)?void 0:s.immediateRisk)||0,m,o),p=this.generateCulturalInterventions(r,o,l,i),g=d(c({},r),{culturalIndicators:l,communicationPatterns:u,culturalBiasAdjustments:m,culturallyAdjustedRisk:h,culturalInterventions:p,confidence:Math.max(r.confidence,h.culturalConfidence),biasAdjustments:[...r.biasAdjustments||[],...m.map(e=>({type:e.factor,description:e.explanation,severity:e.adjustment}))]});return yield this.logCulturalAnalytics(g,t),g})}detectCulturalCrisisIndicators(e,t){const i=[],n=e.toLowerCase(),s=this.culturalCrisisPatterns[t]||this.culturalCrisisPatterns.Western;for(const r of s)n.includes(r.indicator.toLowerCase())&&i.push(r);for(const[r,o]of Object.entries(this.culturalCrisisPatterns))if(r!==t)for(const e of o)n.includes(e.indicator.toLowerCase())&&i.push(d(c({},e),{weight:.6*e.weight,culturalSignificance:.7*e.culturalSignificance}));return i}analyzeCommunicationPatterns(e,t){const i=[],n=e.toLowerCase();for(const s of this.crisisCommunicationPatterns)s.culturalContext.includes(t)&&n.includes(s.pattern.toLowerCase())&&i.push(s);return i}calculateCulturalBiasAdjustments(e,t,i,n){const s=[];if("high"===t.mentalHealthStigma&&s.push({factor:"Mental Health Stigma",adjustment:.25,confidence:.8,culturalRelevance:[t.region],explanation:"Adjusted for high mental health stigma - implicit help-seeking behaviors weighted higher"}),"indirect"===t.communicationStyle&&s.push({factor:"Indirect Communication Style",adjustment:.2,confidence:.7,culturalRelevance:[t.region],explanation:"Adjusted for indirect communication style - metaphorical and implicit expressions weighted higher"}),"family-centered"===t.familyInvolvement){n.filter(e=>e.familyInvolvementImplied).length>0&&s.push({factor:"Family-Centered Culture",adjustment:.15,confidence:.9,culturalRelevance:[t.region],explanation:"Adjusted for family-centered culture - family-related crisis expressions detected"})}i.filter(e=>"somatic"===e.expressionType).length>0&&s.push({factor:"Somatic Expression",adjustment:.18,confidence:.8,culturalRelevance:[t.region],explanation:"Adjusted for somatic expression of mental health symptoms - physical symptom descriptions weighted appropriately"});return n.filter(e=>"religious"===e.helpSeekingStyle).length>0&&s.push({factor:"Religious Coping",adjustment:-.1,confidence:.6,culturalRelevance:[t.region],explanation:"Adjusted for religious coping expressions - spiritual references may indicate resilience factors"}),s}calculateCulturallyAdjustedRisk(e,t,i){let n=e;const s=[];for(const o of t){const e=o.adjustment*o.confidence;n=Math.max(0,Math.min(100,n+100*e)),s.push(o.factor)}n*=1-this.CULTURAL_BIAS_REDUCTION_FACTOR;const r=Math.min(1,t.reduce((e,t)=>e+t.confidence,0)/Math.max(1,t.length));return{originalRisk:e,adjustedRisk:Math.round(n),culturalConfidence:Math.max(this.MIN_CULTURAL_CONFIDENCE,r),adjustmentFactors:s}}generateCulturalInterventions(e,t,i,n){let s;s="family-centered"===t.familyInvolvement?"high":"community-based"===t.familyInvolvement?"medium":"low";return{familyInvolvement:s,communityApproach:"community-based"===t.familyInvolvement||"Filipino"===t.region,religiousConsideration:i.filter(e=>e.indicator.includes("Dios")||e.indicator.includes("الله")||e.indicator.includes("God")||e.indicator.includes("prayer")).length>0||["Arabic","Hispanic/Latino","Filipino"].includes(t.region),culturalResources:this.getCulturalResources(t.region),languageSpecificResources:this.getLanguageSpecificResources(n)}}getCulturalResources(e){const t={Western:["Crisis Text Line: Text HOME to 741741","National Suicide Prevention Lifeline: 988","Psychology Today therapist finder"],"Hispanic/Latino":["Línea Nacional de Prevención del Suicidio: 988","Crisis Text Line: Envía HOLA al 741741","National Alliance on Mental Illness (NAMI) en Español","Therapy for Latinx community resources"],Arabic:["Muslim Mental Health resources","Arab American Family Services","Culturally competent Arabic-speaking therapists","Islamic counseling services"],Chinese:["Chinese Mental Health Association","Asian Mental Health Collective","Mandarin/Cantonese speaking crisis counselors","Traditional Chinese Medicine integration resources"],Vietnamese:["Vietnamese Community Health Promotion Project","Asian Mental Health resources","Vietnamese-speaking crisis support","Community-based mental health services"],Filipino:["Filipino Mental Health resources","Kapamilya support networks","Filipino-American community mental health","Cultural counseling services"]};return t[e]||t.Western}getLanguageSpecificResources(e){return{es:["Crisis chat en español disponible 24/7","Consejeros bilingües especializados","Recursos de salud mental en español"],ar:["خدمات الأزمات باللغة العربية","مستشارون يتحدثون العربية","موارد الصحة النفسية الثقافية"],zh:["中文危机干预服务","说中文的心理健康专家","文化敏感的心理健康资源"],vi:["Dịch vụ can thiệp khủng hoảng tiếng Việt","Chuyên gia tâm lý nói tiếng Việt","Tài nguyên sức khỏe tâm thần phù hợp văn hóa"],tl:["Crisis intervention sa Filipino","Filipino-speaking mental health professionals","Kultura-sensitibong mental health resources"]}[e]||[]}logCulturalAnalytics(e,t){return m(this,null,function*(){try{yield Se.recordInterventionOutcome({sessionId:`cultural-crisis-${Date.now()}`,userToken:t||"anonymous",language:e.culturalInterventions.languageSpecificResources[0]||"en",interventionType:"crisis-resources",initialRiskLevel:e.culturallyAdjustedRisk.originalRisk/100,finalRiskLevel:e.culturallyAdjustedRisk.adjustedRisk/100,sessionDuration:1,feedback:void 0})}catch(i){}})}getCulturalMetrics(e){return m(this,null,function*(){try{const e=yield Se.generateEffectivenessReport();return{totalAnalyses:e.culturalInsights.length,culturalAdaptations:e.culturalInsights.length,biasReductionRate:this.CULTURAL_BIAS_REDUCTION_FACTOR,culturalAccuracy:.85,regionSpecificMetrics:{summary:e.summary,insights:e.culturalInsights.length,recommendations:e.recommendations.length}}}catch(e){return{totalAnalyses:0,culturalAdaptations:0,biasReductionRate:this.CULTURAL_BIAS_REDUCTION_FACTOR,culturalAccuracy:0,regionSpecificMetrics:{}}}})}updateCulturalPatterns(e){return m(this,null,function*(){const t={textLength:e.text.length,culturalRegion:e.culturalRegion,accuracyGap:Math.abs(e.actualRisk-e.predictedRisk),culturalAppropriateness:e.culturallyAppropriate,timestamp:Date.now()},i=JSON.parse(localStorage.getItem("cultural_patterns_learning")||"[]");i.push(t),i.length>500&&i.splice(0,i.length-500),localStorage.setItem("cultural_patterns_learning",JSON.stringify(i))})}},Ie=(e,t)=>{const i={},n=new Date;n.setHours(0,0,0,0);const s=e.filter(e=>{const i=new Date(e.timestamp);i.setHours(0,0,0,0);const s=Math.floor((n.getTime()-i.getTime())/864e5);return s>=0&&s<t});for(const o of s){const e=new Date(o.timestamp).toISOString().split("T")[0];i[e]||(i[e]={total:0,count:0}),i[e].total+=o.moodScore,i[e].count++}const r=[];for(let o=t-1;o>=0;o--){const e=new Date(n);e.setDate(n.getDate()-o);const t=i[e.toISOString().split("T")[0]];r.push({label:e.toLocaleDateString("en-US",{weekday:"short"}),value:t?t.total/t.count:0,date:e})}return r};function we(e,t="GET",i,n){return m(this,null,function*(){try{const s=localStorage.getItem("auth_token"),r=yield fetch(`/.netlify/functions/api${e}`,c({method:t,headers:c(c({"Content-Type":"application/json"},s&&{Authorization:`Bearer ${s}`}),n)},i&&{body:JSON.stringify(i)}));if(!r.ok)throw new Error(`API Error: ${r.statusText}`);return yield r.json()}catch(s){throw N.error("API Call Failed:",s,"backendService"),s}})}const Ce={user:{register(e,t,i="seeker"){return m(this,null,function*(){return we("/users/register","POST",{email:e,password:t,role:i})})},getProfile(){return m(this,null,function*(){return we("/users/profile")})},updateProfile(e){return m(this,null,function*(){return we("/users/profile","PUT",e)})}},mood:{saveMoodEntry(e){return m(this,null,function*(){return we("/mood","POST",e)})},getMoodHistory(){return m(this,null,function*(){return we("/mood")})},getMoodAnalytics(e="month"){return m(this,null,function*(){return we(`/mood/analytics?period=${e}`)})}},assessment:{submitAssessment(e,t){return m(this,null,function*(){return we("/assessments/submit","POST",{type:e,responses:t})})},getAssessmentHistory(){return m(this,null,function*(){return we("/assessments")})},getLatestAssessment(e){return m(this,null,function*(){return we(`/assessments/latest?type=${e}`)})}},safetyPlan:{getSafetyPlan(){return m(this,null,function*(){return we("/safety-plan")})},saveSafetyPlan(e){return m(this,null,function*(){return we("/safety-plan","POST",e)})},updateSafetyPlan(e,t){return m(this,null,function*(){return we("/safety-plan","PATCH",{section:e,data:t})})}},journal:{saveEntry(e){return m(this,null,function*(){return we("/journal","POST",e)})},getEntries(e=20,t=0){return m(this,null,function*(){return we(`/journal?limit=${e}&offset=${t}`)})},getEntry(e){return m(this,null,function*(){return we(`/journal/${e}`)})},updateEntry(e,t){return m(this,null,function*(){return we(`/journal/${e}`,"PUT",t)})},deleteEntry(e){return m(this,null,function*(){return we(`/journal/${e}`,"DELETE")})}},crisis:{getResources(){return m(this,null,function*(){return we("/crisis/resources")})},reportCrisis(e){return m(this,null,function*(){return we("/crisis/report","POST",e)})},getEmergencyContacts(){return m(this,null,function*(){return we("/crisis/emergency-contacts")})}},peerSupport:{findMatch(e){return m(this,null,function*(){return we("/peer-support/match","POST",e)})},sendMessage(e,t){return m(this,null,function*(){return we("/peer-support/message","POST",{recipientId:e,message:t})})},getConversations(){return m(this,null,function*(){return we("/peer-support/conversations")})},reportUser(e,t){return m(this,null,function*(){return we("/peer-support/report","POST",{userId:e,reason:t})})}},health:{checkHealth(){return m(this,null,function*(){return we("/health")})}}};var _e={};class Ee{constructor(e){u(this,"ws",null),u(this,"reconnectAttempts",0),u(this,"maxReconnectAttempts",10),u(this,"reconnectInterval",5e3),u(this,"heartbeatInterval",null),u(this,"messageQueue",[]),u(this,"listeners",new Map),u(this,"connectionListeners",new Set),u(this,"eventHandlers",new Map),u(this,"typingIndicators",new Map),u(this,"presenceData",new Map),u(this,"roomSubscriptions",new Set),u(this,"demoMode",!1),u(this,"connectionPromise",null),u(this,"userId",null),this.url=e,this.checkDemoMode(),this.setupLifecycleListeners(),this.demoMode||this.connect()}checkDemoMode(){this.url.includes("localhost")}setupLifecycleListeners(){window.addEventListener("online",()=>{this.connect()}),document.addEventListener("visibilitychange",()=>{document.hidden?this.stopHeartbeat():this.isConnected()&&(this.startHeartbeat(),this.checkMissedNotifications())}),window.addEventListener("beforeunload",()=>{this.disconnect()})}connect(){return m(this,null,function*(){var e;if(this.connectionPromise)return this.connectionPromise;if(this.isConnected()&&(null==(e=this.ws)?void 0:e.readyState)===WebSocket.OPEN)return Promise.resolve();if(this.demoMode)return this.simulateDemoConnection(),Promise.resolve();this.connectionPromise=this.performConnect();try{yield this.connectionPromise}finally{this.connectionPromise=null}})}performConnect(){return m(this,null,function*(){return new Promise((e,t)=>{ne.getAccessToken().then(i=>{ne.getCurrentUser().then(e=>{e&&(this.userId=e.id)});const n=i?`${this.url}?token=${encodeURIComponent(i)}`:this.url;this.ws=new WebSocket(n),this.setupEventListeners(e,t)}).catch(()=>{this.ws=new WebSocket(this.url),this.setupEventListeners(e,t)})})})}simulateDemoConnection(){setTimeout(()=>{this.notifyConnectionListeners(!0),this.flushMessageQueue()},100)}setupEventListeners(e,t){this.ws&&(this.ws.onopen=()=>{this.reconnectAttempts=0,ne.getAccessToken().then(e=>{e&&this.authenticate(e)}),this.startHeartbeat(),this.notifyConnectionListeners(!0),this.rejoinRooms(),this.flushMessageQueue(),this.emit("connect",{timestamp:Date.now()}),e&&e()},this.ws.onclose=e=>{e.code,this.stopHeartbeat(),this.notifyConnectionListeners(!1),this.clearTypingIndicators(),this.emit("disconnect",{code:e.code,reason:e.reason}),!e.wasClean&&this.reconnectAttempts<this.maxReconnectAttempts&&this.scheduleReconnect()},this.ws.onerror=e=>{this.emit("error",e),t&&t(e)},this.ws.onmessage=e=>{try{const t=JSON.parse(e.data);this.handleMessage(t)}catch(t){}})}handleMessage(e){if("auth_success"!==e.type)if("auth_error"!==e.type)switch(e.type){case"pong":break;case"typing":this.handleTypingIndicator(e.payload);break;case"presence":this.handlePresenceUpdate(e.payload);break;case"notification":this.handleNotification(e.payload);break;case"crisis_alert":this.handleCrisisAlert(e.payload);break;default:{const t=this.listeners.get(e.type);t&&t.forEach(t=>{try{t(e.payload)}catch(i){}});break}}else this.disconnect()}authenticate(e){this.send("auth",{token:e})}handleTypingIndicator(e){const{userId:t,room:i,isTyping:n}=e;this.typingIndicators.has(i)||this.typingIndicators.set(i,new Map);const s=this.typingIndicators.get(i);if(n){const e=s.get(t);e&&clearTimeout(e);const n=setTimeout(()=>{s.delete(t),this.emit("typing",{room:i,userId:t,isTyping:!1})},3e3);s.set(t,n)}else{const e=s.get(t);e&&clearTimeout(e),s.delete(t)}this.emit("typing",e)}handlePresenceUpdate(e){this.presenceData.set(e.userId,e),this.emit("presence",e)}handleNotification(e){const t=e;document.hidden&&oe.show({title:t.title||"New Notification",body:t.message||"You have a new notification",urgency:t.urgency||"normal",category:t.type||"system",data:t.metadata}),this.emit("notification",e)}handleCrisisAlert(e){const t=e;oe.showCrisisNotification(t.title||"Crisis Alert",t.message||"Immediate assistance needed",e),this.emit("crisis_alert",e)}clearTypingIndicators(){this.typingIndicators.forEach(e=>{e.forEach(e=>clearTimeout(e))}),this.typingIndicators.clear()}checkMissedNotifications(){return m(this,null,function*(){this.emit("check_missed_notifications",{})})}scheduleReconnect(){if(this.reconnectAttempts++,this.reconnectAttempts>this.maxReconnectAttempts)return this.demoMode=!0,void this.simulateDemoConnection();const e=Math.min(this.reconnectInterval*Math.pow(2,this.reconnectAttempts-1),3e4);setTimeout(()=>{this.connect()},e)}rejoinRooms(){this.roomSubscriptions.forEach(e=>{this.send("join_room",{room:e})})}startHeartbeat(){this.heartbeatInterval=setInterval(()=>{var e;(null==(e=this.ws)?void 0:e.readyState)===WebSocket.OPEN&&this.send("ping",{})},3e4)}stopHeartbeat(){this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}flushMessageQueue(){for(;this.messageQueue.length>0;){const e=this.messageQueue.shift();e&&this.sendMessage(e)}}notifyConnectionListeners(e){this.connectionListeners.forEach(t=>{try{t(e)}catch(i){}})}sendMessage(e){var t;return this.demoMode?(setTimeout(()=>{"chat_message"===e.type&&this.handleMessage({type:"chat_message",payload:d(c({},e.payload),{id:Math.random().toString(36).substring(2,11),userId:"demo-echo",username:"Demo Echo",timestamp:Date.now()}),timestamp:Date.now()})},100),!0):(null==(t=this.ws)?void 0:t.readyState)===WebSocket.OPEN&&(this.ws.send(JSON.stringify(e)),!0)}send(e,t,i){const n={type:e,payload:t,timestamp:Date.now(),userId:this.userId||localStorage.getItem("userId")||void 0,room:i};this.sendMessage(n)||this.messageQueue.push(n)}on(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new Set),this.eventHandlers.get(e).add(t),()=>{this.off(e,t)}}off(e,t){const i=this.eventHandlers.get(e);i&&i.delete(t)}once(e,t){const i=n=>{t(n),this.off(e,i)};return this.on(e,i)}emit(e,t){const i=this.eventHandlers.get(e);i&&i.forEach(e=>{try{e(t)}catch(i){}})}subscribe(e,t){return this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t),()=>{const i=this.listeners.get(e);i&&(i.delete(t),0===i.size&&this.listeners.delete(e))}}onConnectionChange(e){return this.connectionListeners.add(e),e(this.isConnected()),()=>{this.connectionListeners.delete(e)}}isConnected(){var e;return!!this.demoMode||(null==(e=this.ws)?void 0:e.readyState)===WebSocket.OPEN}disconnect(){this.stopHeartbeat(),this.ws&&(this.ws.close(1e3,"Client disconnect"),this.ws=null)}joinRoom(e){this.roomSubscriptions.add(e),this.send("join_room",{roomId:e})}leaveRoom(e){this.roomSubscriptions.delete(e);const t=this.typingIndicators.get(e);t&&(t.forEach(e=>clearTimeout(e)),this.typingIndicators.delete(e)),this.send("leave_room",{roomId:e})}joinChatRoom(e){this.joinRoom(e)}leaveChatRoom(e){this.leaveRoom(e)}sendChatMessage(e,t,i){this.send("chat_message",{roomId:e,message:t,metadata:i,timestamp:Date.now()},e)}subscribeToNotifications(e){this.send("subscribe_notifications",{userId:e})}markNotificationRead(e){this.send("notification_read",{notificationId:e})}updatePresence(e){this.send("presence_update",{status:e})}startTyping(e){this.send("typing",{roomId:e,isTyping:!0},e)}stopTyping(e){this.send("typing",{roomId:e,isTyping:!1},e)}getTypingUsers(e){const t=this.typingIndicators.get(e);return t?Array.from(t.keys()):[]}getUserPresence(e){return this.presenceData.get(e)}sendCrisisAlert(e,t){this.send("crisis_alert",{userId:e,severity:t,timestamp:Date.now()})}updateHelperStatus(e){this.send("helper_status",{status:e})}requestDilemmaUpdate(e){this.send("dilemma_update",{dilemmaId:e})}}let De=null;const Ae=()=>{if(!De){De=new Ee(_e.VITE_WS_URL||"wss://api.astralcore.app/ws")}return De};"undefined"!=typeof window&&(window.addEventListener("load",()=>m(null,null,function*(){setTimeout(()=>m(null,null,function*(){const e=Ae();(yield ne.getAccessToken())&&e.connect().catch(console.error)}),1e3)})),window.addEventListener("auth-success",()=>{Ae().connect().catch(console.error)}),window.addEventListener("auth-logout",()=>{Ae().disconnect()}));const Te={algorithm:"AES-GCM",keyLength:256,ivLength:12,tagLength:16,iterations:1e5,hashAlgorithm:"SHA-256"},be={safetyPlan:{level:"restricted",category:"health",retention:2555,hipaaCompliant:!0},mood_analyses:{level:"restricted",category:"health",retention:2555,hipaaCompliant:!0},userToken:{level:"confidential",category:"personal",retention:90,hipaaCompliant:!1},userId:{level:"confidential",category:"personal",retention:90,hipaaCompliant:!1},aiChatHistory:{level:"restricted",category:"health",retention:1095,hipaaCompliant:!0},peerChatHistory:{level:"restricted",category:"communication",retention:1095,hipaaCompliant:!0},crisis_error:{level:"restricted",category:"crisis",retention:2555,hipaaCompliant:!0},last_crisis_error:{level:"restricted",category:"crisis",retention:2555,hipaaCompliant:!0},userStats:{level:"internal",category:"analytics",retention:365,hipaaCompliant:!1},"accessibility-preferences":{level:"internal",category:"personal",retention:365,hipaaCompliant:!1},contentFilters:{level:"internal",category:"personal",retention:365,hipaaCompliant:!1}};class Pe{constructor(e){u(this,"config"),u(this,"keyCache",new Map),u(this,"isSupported",!1),this.config=c(c({},Te),e),this.checkBrowserSupport()}checkBrowserSupport(){this.isSupported=!("undefined"==typeof crypto||!crypto.subtle||"function"!=typeof crypto.getRandomValues||"undefined"==typeof TextEncoder||"undefined"==typeof TextDecoder),this.isSupported}generateSecurePassword(){const e=new Uint8Array(32);return crypto.getRandomValues(e),Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")}getDevicePassword(){return m(this,null,function*(){let e=sessionStorage.getItem("device_encryption_key");return e||(e=this.generateSecurePassword(),sessionStorage.setItem("device_encryption_key",e),"undefined"!=typeof window&&(window.__astral_device_key=e)),e})}deriveKey(e,t){return m(this,null,function*(){const i=(new TextEncoder).encode(e),n=yield crypto.subtle.importKey("raw",i,"PBKDF2",!1,["deriveKey"]);return yield crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:this.config.iterations,hash:this.config.hashAlgorithm},n,{name:this.config.algorithm,length:this.config.keyLength},!1,["encrypt","decrypt"])})}generateRandomBytes(e){const t=new Uint8Array(e);return crypto.getRandomValues(t),t}arrayBufferToBase64(e){const t=Array.from(e);return btoa(String.fromCharCode(...t))}base64ToArrayBuffer(e){const t=atob(e),i=new Uint8Array(t.length);for(let n=0;n<t.length;n++)i[n]=t.charCodeAt(n);return i}getDataClassification(e){return be[e]?be[e]:e.includes("crisis")||e.includes("emergency")?be.crisis_error:e.includes("mood")||e.includes("health")?be.mood_analyses:e.includes("chat")||e.includes("message")?be.aiChatHistory:{level:"internal",category:"personal",retention:90,hipaaCompliant:!1}}shouldEncrypt(e){const t=this.getDataClassification(e);return"restricted"===t.level||"confidential"===t.level}encrypt(e,t){return m(this,null,function*(){if(!this.isSupported)throw new Error("Encryption not supported in this browser");try{const i=(new TextEncoder).encode(e),n=this.generateRandomBytes(16),s=this.generateRandomBytes(this.config.ivLength),r=yield this.getDevicePassword(),o=yield this.deriveKey(r,n),a=yield crypto.subtle.encrypt({name:this.config.algorithm,iv:s},o,i),l=new Uint8Array(a),c=this.config.tagLength,d=l.slice(0,-c),u=l.slice(-c),m={data:this.arrayBufferToBase64(d),iv:this.arrayBufferToBase64(s),salt:this.arrayBufferToBase64(n),tag:this.arrayBufferToBase64(u),version:"1.0",algorithm:this.config.algorithm};return this.logSecurityEvent("data_encrypted",{key:t,algorithm:this.config.algorithm,dataSize:e.length,classification:this.getDataClassification(t)}),m}catch(i){throw this.logSecurityEvent("encryption_failed",{key:t,error:i instanceof Error?i.message:"Unknown error"}),new Error("Failed to encrypt data")}})}decrypt(e,t){return m(this,null,function*(){if(!this.isSupported)throw new Error("Decryption not supported in this browser");try{const i=this.base64ToArrayBuffer(e.data),n=this.base64ToArrayBuffer(e.iv),s=this.base64ToArrayBuffer(e.salt),r=this.base64ToArrayBuffer(e.tag||""),o=new Uint8Array(i.length+r.length);o.set(i),o.set(r,i.length);const a=yield this.getDevicePassword(),l=yield this.deriveKey(a,s),c=yield crypto.subtle.decrypt({name:e.algorithm,iv:n},l,o),d=(new TextDecoder).decode(c);return this.logSecurityEvent("data_decrypted",{key:t,algorithm:e.algorithm,dataSize:d.length,classification:this.getDataClassification(t)}),d}catch(i){throw this.logSecurityEvent("decryption_failed",{key:t,error:i instanceof Error?i.message:"Unknown error"}),new Error("Failed to decrypt data")}})}secureSetItem(e,t){return m(this,null,function*(){try{if(this.shouldEncrypt(e)){const i=yield this.encrypt(t,e),n=d(c({encrypted:!0},i),{classification:this.getDataClassification(e),timestamp:Date.now()});localStorage.setItem(e,JSON.stringify(n))}else localStorage.setItem(e,t)}catch(i){localStorage.setItem(e,t)}})}secureGetItem(e){return m(this,null,function*(){try{const t=localStorage.getItem(e);if(!t)return null;let i;try{i=JSON.parse(t)}catch(Me){return t}if(i.encrypted&&i.data){const t={data:i.data,iv:i.iv,salt:i.salt,tag:i.tag,version:i.version,algorithm:i.algorithm};return yield this.decrypt(t,e)}return"object"==typeof i?JSON.stringify(i):t}catch(t){return localStorage.getItem(e)}})}secureRemoveItem(e){const t=this.getDataClassification(e);this.logSecurityEvent("data_deleted",{key:e,classification:t}),localStorage.removeItem(e)}getEncryptedKeys(){const e=[];for(let t=0;t<localStorage.length;t++){const i=localStorage.key(t);if(i){const t=localStorage.getItem(i);if(t)try{JSON.parse(t).encrypted&&e.push(i)}catch(Me){}}}return e}isDataEncrypted(e){try{return!0===JSON.parse(e).encrypted}catch(Me){return!1}}migrateSingleKey(e){return m(this,null,function*(){try{const t=localStorage.getItem(e);return!(!t||this.isDataEncrypted(t))&&(yield this.secureSetItem(e,t),!0)}catch(t){return!1}})}getKeysForMigration(){const e=[];for(let t=0;t<localStorage.length;t++){const i=localStorage.key(t);i&&this.shouldEncrypt(i)&&e.push(i)}return e}migrateExistingData(){return m(this,null,function*(){const e=Date.now();let t=0,i=0;const n=this.getKeysForMigration();for(const r of n){(yield this.migrateSingleKey(r))?t++:i++}const s=Date.now()-e;this.logSecurityEvent("data_migration_completed",{migratedCount:t,failedCount:i,migrationTime:s,totalKeys:localStorage.length})})}validateDataIntegrity(){return m(this,null,function*(){const e={valid:0,invalid:0,errors:[]},t=this.getEncryptedKeys();for(const n of t)try{null!==(yield this.secureGetItem(n))?e.valid++:(e.invalid++,e.errors.push(`Failed to decrypt data for key: ${n}`))}catch(i){e.invalid++,e.errors.push(`Integrity check failed for key ${n}: ${i instanceof Error?i.message:"Unknown error"}`)}return e})}clearEncryptionKeys(){sessionStorage.removeItem("device_encryption_key"),"undefined"!=typeof window&&delete window.__astral_device_key,this.keyCache.clear(),this.logSecurityEvent("encryption_keys_cleared",{keysClearedCount:this.keyCache.size})}getEncryptionStats(){const e=this.getEncryptedKeys(),t={};let i=0;for(const n of e){const e=this.getDataClassification(n);t[e.level]=(t[e.level]||0)+1,e.hipaaCompliant&&i++}return{isSupported:this.isSupported,encryptedKeys:e.length,totalKeys:localStorage.length,classifications:t,hipaaCompliantKeys:i}}logSecurityEvent(e,t){const i={timestamp:(new Date).toISOString(),event:`encryption_${e}`,details:d(c({},t),{userAgent:navigator.userAgent,url:window.location.href}),severity:"info"};try{const e=JSON.parse(localStorage.getItem("security_logs")||"[]");e.push(i),e.length>100&&e.splice(0,e.length-100),localStorage.setItem("security_logs",JSON.stringify(e))}catch(n){}}checkKeyForHIPAAViolation(e){if(!this.getDataClassification(e).hipaaCompliant)return null;const t=localStorage.getItem(e);if(!t)return null;try{if(!JSON.parse(t).encrypted)return`HIPAA-sensitive data in key '${e}' is not encrypted`}catch(Me){return`HIPAA-sensitive data in key '${e}' is stored as plain text`}return null}scanForHIPAAViolations(){const e=[];for(let t=0;t<localStorage.length;t++){const i=localStorage.key(t);if(i){const t=this.checkKeyForHIPAAViolation(i);t&&e.push(t)}}return e}generateHIPAARecommendations(e){const t=[];return e.length>0&&(t.push("Run data migration to encrypt all HIPAA-sensitive data"),t.push("Implement automatic encryption for all health-related data"),t.push("Review data classification rules for completeness")),t}performHIPAAComplianceCheck(){const e=this.scanForHIPAAViolations(),t=this.generateHIPAARecommendations(e);return{compliant:0===e.length,violations:e,recommendations:t}}}let ke=null;class Oe{constructor(e={}){u(this,"encryptionService",(ke||(ke=new Pe),ke)),u(this,"options"),u(this,"accessLog",new Map),this.options=c({enableEncryption:!0,enableAuditLogging:!0,enableDataRetention:!0,maxRetentionDays:2555},e),this.loadAccessLog(),this.scheduleDataRetentionCleanup()}loadAccessLog(){try{const e=localStorage.getItem("_secure_storage_log");if(e){const t=JSON.parse(e);this.accessLog=new Map(Object.entries(t))}}catch(e){}}saveAccessLog(){try{const e=Object.fromEntries(this.accessLog);localStorage.setItem("_secure_storage_log",JSON.stringify(e))}catch(e){}}updateMetadata(e,t,i=!1){if(!this.options.enableAuditLogging)return;const n=this.accessLog.get(e),s=Date.now(),r={timestamp:(null==n?void 0:n.timestamp)||s,classification:this.getDataClassification(e),encrypted:this.shouldEncrypt(e),size:t.length,accessCount:((null==n?void 0:n.accessCount)||0)+(i?1:0),lastAccessed:s};this.accessLog.set(e,r),this.saveAccessLog()}getDataClassification(e){return e.includes("crisis")||e.includes("emergency")?"crisis":e.includes("mood")||e.includes("safety")||e.includes("health")?"health":e.includes("chat")||e.includes("message")?"communication":e.includes("user")||e.includes("token")||e.includes("profile")?"personal":"general"}shouldEncrypt(e){if(!this.options.enableEncryption)return!1;const t=this.getDataClassification(e);return["crisis","health","communication","personal"].includes(t)}scheduleDataRetentionCleanup(){this.options.enableDataRetention&&(this.performDataRetentionCleanup(),setInterval(()=>{this.performDataRetentionCleanup()},864e5))}performDataRetentionCleanup(){const e=Date.now(),t=24*this.options.maxRetentionDays*60*60*1e3;let i=0;this.accessLog.forEach((n,s)=>{e-n.timestamp>t&&(this.removeItem(s),this.accessLog.delete(s),i++)}),i>0&&this.saveAccessLog()}setItem(e,t){return m(this,null,function*(){try{this.updateMetadata(e,t),yield this.encryptionService.secureSetItem(e,t),this.options.enableAuditLogging&&this.logStorageEvent("data_stored",{key:e,size:t.length,encrypted:this.shouldEncrypt(e),classification:this.getDataClassification(e)})}catch(i){throw new Error(`Failed to store data for key: ${e}`)}})}getItem(e){return m(this,null,function*(){try{const t=yield this.encryptionService.secureGetItem(e);return null!==t&&(this.updateMetadata(e,t,!0),this.options.enableAuditLogging&&this.logStorageEvent("data_accessed",{key:e,size:t.length,classification:this.getDataClassification(e)})),t}catch(t){return null}})}removeItem(e){try{this.encryptionService.secureRemoveItem(e),this.accessLog.delete(e),this.saveAccessLog(),this.options.enableAuditLogging&&this.logStorageEvent("data_removed",{key:e,classification:this.getDataClassification(e)})}catch(t){}}clear(){try{localStorage.clear(),this.accessLog.clear(),this.options.enableAuditLogging&&this.logStorageEvent("storage_cleared",{})}catch(e){}}get length(){return localStorage.length}key(e){return localStorage.key(e)}hasItem(e){return null!==localStorage.getItem(e)}getAllKeys(){const e=[];for(let t=0;t<localStorage.length;t++){const i=localStorage.key(t);i&&e.push(i)}return e}getStorageStats(){const e={totalKeys:0,encryptedKeys:0,totalSize:0,byClassification:{},byEncryption:{encrypted:0,plaintext:0}};return this.accessLog.forEach((t,i)=>{e.totalKeys++,e.totalSize+=t.size,t.encrypted?(e.encryptedKeys++,e.byEncryption.encrypted++):e.byEncryption.plaintext++,e.byClassification[t.classification]=(e.byClassification[t.classification]||0)+1}),e}getMetadata(e){return this.accessLog.get(e)||null}getAllMetadata(){return new Map(this.accessLog)}validateIntegrity(){return m(this,null,function*(){return yield this.encryptionService.validateDataIntegrity()})}migrateToEncrypted(){return m(this,null,function*(){yield this.encryptionService.migrateExistingData();for(let e=0;e<localStorage.length;e++){const t=localStorage.key(e);if(t&&this.shouldEncrypt(t)){const e=yield this.getItem(t);e&&this.updateMetadata(t,e)}}})}performHIPAAComplianceCheck(){return this.encryptionService.performHIPAAComplianceCheck()}exportData(e=!0){return m(this,null,function*(){const t={},i=this.getAllKeys();for(const e of i){const i=yield this.getItem(e);null!==i&&(t[e]=i)}const n={data:t,exportTime:(new Date).toISOString(),version:"1.0"};return e&&(n.metadata=Object.fromEntries(this.accessLog)),n})}importData(e){return m(this,null,function*(){const t=[];try{for(const[i,n]of Object.entries(e.data))yield this.setItem(i,n),t.push(i);if(e.metadata){for(const[t,i]of Object.entries(e.metadata))this.accessLog.set(t,i);this.saveAccessLog()}this.logStorageEvent("data_imported",{importedCount:t.length,keys:t})}catch(i){throw new Error("Data import failed")}})}logStorageEvent(e,t){if(!this.options.enableAuditLogging)return;const i={timestamp:(new Date).toISOString(),event:`secure_storage_${e}`,details:d(c({},t),{userAgent:navigator.userAgent,url:window.location.href}),severity:"info"};try{const e=JSON.parse(localStorage.getItem("security_logs")||"[]");e.push(i),e.length>100&&e.splice(0,e.length-100),localStorage.setItem("security_logs",JSON.stringify(e))}catch(n){}}}let Re=null;class Le{constructor(){var e;u(this,"activeSessions",new Map),u(this,"pendingRequests",new Map),u(this,"userProfiles",new Map),u(this,"userSettings"),u(this,"websocketService",Ae()),u(this,"secureStorage",(Re||(Re=new Oe(e)),Re)),u(this,"eventHandlers",new Map),u(this,"currentUserId"),u(this,"hapticController"),u(this,"breathingInterval"),u(this,"heartbeatInterval"),u(this,"offlineQueue",[]),u(this,"isOnline",navigator.onLine),this.initializeService()}initializeService(){return m(this,null,function*(){yield this.loadUserSettings(),yield this.loadUserProfile(),this.setupWebSocketListeners(),this.initializeHapticFeedback(),this.initializePressureSensing(),this.initializeOfflineSupport(),this.initializePanicButton()})}emit(e,t){const i=this.eventHandlers.get(e);i&&i.forEach(e=>{try{e(t)}catch(i){}})}on(e,t){this.eventHandlers.has(e)||this.eventHandlers.set(e,new Set),this.eventHandlers.get(e).add(t)}off(e,t){const i=this.eventHandlers.get(e);i&&i.delete(t)}removeAllListeners(){this.eventHandlers.clear()}setupWebSocketListeners(){this.websocketService.subscribe("tether-request",this.handleTetherRequest.bind(this)),this.websocketService.subscribe("tether-response",this.handleTetherResponse.bind(this)),this.websocketService.subscribe("tether-pressure",this.handlePressureUpdate.bind(this)),this.websocketService.subscribe("tether-heartbeat",this.handleHeartbeatSync.bind(this)),this.websocketService.subscribe("tether-breathing",this.handleBreathingSync.bind(this)),this.websocketService.subscribe("tether-end",this.handleTetherEnd.bind(this)),this.websocketService.subscribe("tether-emergency",this.handleEmergencyEscalation.bind(this))}initializeHapticFeedback(){return m(this,null,function*(){try{"vibrate"in navigator&&(this.hapticController=navigator)}catch(e){}})}initializePressureSensing(){return m(this,null,function*(){try{"DeviceMotionEvent"in window&&window.addEventListener("devicemotion",this.handleDeviceMotion.bind(this))}catch(e){}})}initializeOfflineSupport(){window.addEventListener("online",()=>{this.isOnline=!0,this.processOfflineQueue()}),window.addEventListener("offline",()=>{this.isOnline=!1,oe.addToast("You are offline. Tether requests will be sent when connection is restored.","info")})}initializePanicButton(){let e,t=0;document.addEventListener("click",i=>{i.target.closest(".tether-view")&&(t++,3===t&&(this.triggerPanicMode(),t=0),clearTimeout(e),e=setTimeout(()=>{t=0},500))}),document.addEventListener("keydown",e=>{e.ctrlKey&&e.shiftKey&&"P"===e.key&&(e.preventDefault(),this.triggerPanicMode())})}processOfflineQueue(){return m(this,null,function*(){if(0===this.offlineQueue.length)return;const e=[...this.offlineQueue];this.offlineQueue=[];for(const i of e)try{yield this.sendTetherRequest(i)}catch(t){this.offlineQueue.push(i)}})}triggerPanicMode(){return m(this,null,function*(){this.hapticController&&this.hapticController.vibrate([200,100,200,100,200]);const e=this.userProfiles.get(this.currentUserId||"default-user");if(e&&e.trustedConnections.length>0){const i={fromUserId:this.currentUserId||"default-user",toUserId:e.trustedConnections[0],message:"EMERGENCY - Panic button activated. I need immediate help.",urgency:"critical",tetherType:"emergency",preferredDuration:60,location:yield this.getCurrentLocation()};try{const e=yield this.sendTetherRequest(i);setTimeout(()=>{this.requestEmergencyEscalation(e,"professional")},3e4),oe.addToast("Emergency tether sent. Help is on the way.","error")}catch(t){window.location.href="tel:911"}}else window.location.href="tel:911"})}getCurrentLocation(){return m(this,null,function*(){try{const e=yield new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(e,t,{timeout:5e3,enableHighAccuracy:!0})});return{lat:e.coords.latitude,lng:e.coords.longitude}}catch(e){return}})}loadUserSettings(){return m(this,null,function*(){try{const e=yield this.secureStorage.getItem("tether-settings");e?this.userSettings=JSON.parse(e):(this.userSettings=this.getDefaultSettings(),yield this.saveUserSettings())}catch(e){this.userSettings=this.getDefaultSettings()}})}loadUserProfile(){return m(this,null,function*(){try{const e=this.currentUserId||"default-user",t=yield this.secureStorage.getItem(`tether-profile-${e}`);if(t){const i=JSON.parse(t);this.userProfiles.set(e,i)}else{const t={userId:e,displayName:e,isAvailable:!0,availabilityStatus:"available",friendCode:this.generateFriendCode(),preferredTetherTypes:["breathing","presence"],responseTime:0,successfulSessions:0,rating:0,emergencyContact:!1,professionalSupport:!1,languages:["en"],timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,availability:{days:[0,1,2,3,4,5,6],startTime:"00:00",endTime:"23:59"},trustedConnections:[],lastActiveTimestamp:Date.now()};this.userProfiles.set(e,t),yield this.saveUserProfile(t)}}catch(e){}})}getDefaultSettings(){return{hapticEnabled:!0,hapticIntensity:.7,breathingGuideEnabled:!0,breathingPattern:"box",pressureShareEnabled:!0,emergencyContacts:[],professionalHandoffEnabled:!0,privacyLevel:"friends",autoAcceptFromCircle:!1}}saveUserSettings(){return m(this,null,function*(){try{yield this.secureStorage.setItem("tether-settings",JSON.stringify(this.userSettings))}catch(e){}})}generateFriendCode(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let t="";for(let i=0;i<8;i++)4===i&&(t+="-"),t+=e.charAt(Math.floor(36*Math.random()));return t}saveUserProfile(e){return m(this,null,function*(){try{yield this.secureStorage.setItem(`tether-profile-${e.userId}`,JSON.stringify(e))}catch(t){}})}addTrustedConnection(e){return m(this,null,function*(){try{const t=Array.from(this.userProfiles.values()).find(t=>t.friendCode===e);if(!t)throw new Error("Invalid friend code");const i=this.userProfiles.get(this.currentUserId||"default-user");if(!i)throw new Error("Current user profile not found");return i.trustedConnections.includes(t.userId)||(i.trustedConnections.push(t.userId),yield this.saveUserProfile(i)),!0}catch(t){return!1}})}updateAvailabilityStatus(e){return m(this,null,function*(){const t=this.userProfiles.get(this.currentUserId||"default-user");t&&(t.availabilityStatus=e,t.lastActiveTimestamp=Date.now(),yield this.saveUserProfile(t),this.websocketService.send("tether-status-update",{userId:t.userId,status:e,timestamp:Date.now()}))})}sendTetherRequest(e){return m(this,null,function*(){let t;switch(e.urgency){case"critical":t=5;break;case"high":t=15;break;default:t=30}const i=d(c({},e),{id:`tether-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:Date.now(),expiresAt:Date.now()+60*t*1e3});if(e.isAnonymous&&(i.anonymousAlias=this.generateAnonymousAlias(),i.fromUserId=`anon-${i.id}`),!this.isOnline)return this.offlineQueue.push(i),yield this.secureStorage.setItem("tether-offline-queue",JSON.stringify(this.offlineQueue)),oe.addToast("Tether request queued. Will be sent when connection is restored.","info"),i.id;this.pendingRequests.set(i.id,i);try{this.websocketService.send("tether-request",i),oe.addToast(e.isAnonymous?"Anonymous tether request sent":`Tether request sent to user ${e.toUserId}`,"info")}catch(n){throw this.offlineQueue.push(i),n}return this.emit("tether-request-sent",i),i.id})}generateAnonymousAlias(){const e=["Gentle","Caring","Kind","Supportive","Understanding","Peaceful"],t=["Friend","Companion","Helper","Listener","Guardian","Presence"];return`${e[Math.floor(Math.random()*e.length)]} ${t[Math.floor(Math.random()*t.length)]}`}respondToTetherRequest(e,t){return m(this,null,function*(){const i=this.pendingRequests.get(e);if(!i)throw new Error("Tether request not found");if(t){const t=yield this.createTetherSession(i);return this.websocketService.send("tether-response",{requestId:e,accepted:!0,sessionId:t}),this.emit("tether-session-created",t),t}return this.websocketService.send("tether-response",{requestId:e,accepted:!1}),this.pendingRequests.delete(e),null})}createTetherSession(e){return m(this,null,function*(){var t,i;const n=`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,s={id:n,participants:[e.fromUserId,e.toUserId],startTime:Date.now(),status:"active",tetherType:e.tetherType,hapticSync:(null==(t=this.userSettings)?void 0:t.hapticEnabled)||!1,breathingSync:(null==(i=this.userSettings)?void 0:i.breathingGuideEnabled)||!1,pressureSensitivity:.5,settings:this.userSettings||this.getDefaultSettings(),metrics:{sessionQuality:0,completionRate:0,averageResponseTime:0,effectivenessScore:0}};return this.activeSessions.set(n,s),s.breathingSync&&this.startBreathingSync(n),this.startHeartbeatMonitoring(n),n})}startBreathingSync(e){return m(this,null,function*(){const t=this.activeSessions.get(e);if(!t||!t.breathingSync)return;const i=t.settings.breathingPattern;let n=4e3,s=4e3,r=6e3,o=2e3;switch(i){case"4-7-8":n=4e3,s=7e3,r=8e3,o=1e3;break;case"coherent":n=5e3,s=0,r=5e3,o=0;break;case"custom":n=1e3*(t.settings.customInhale||4),s=1e3*(t.settings.customHold||4),r=1e3*(t.settings.customExhale||6),o=1e3*(t.settings.customPause||2)}const a=()=>m(this,null,function*(){this.activeSessions.has(e)&&(t.currentPhase="inhale",t.phaseStartTime=Date.now(),this.emit("breathing-phase",{sessionId:e,phase:"inhale",duration:n}),setTimeout(()=>{s>0&&(t.currentPhase="hold",t.phaseStartTime=Date.now(),this.emit("breathing-phase",{sessionId:e,phase:"hold",duration:s})),setTimeout(()=>{t.currentPhase="exhale",t.phaseStartTime=Date.now(),this.emit("breathing-phase",{sessionId:e,phase:"exhale",duration:r}),setTimeout(()=>{o>0&&(t.currentPhase="pause",t.phaseStartTime=Date.now(),this.emit("breathing-phase",{sessionId:e,phase:"pause",duration:o})),setTimeout(a,o)},r)},s)},n))});a()})}sendPressureUpdate(e,t){const i=this.activeSessions.get(e);if(!i||!i.settings.pressureShareEnabled)return;const n=Math.max(0,Math.min(1,t));if(this.websocketService.send("tether-pressure",{sessionId:e,pressure:n,timestamp:Date.now()}),i.hapticSync&&this.hapticController){const e=Math.floor(n*i.settings.hapticIntensity*100);this.hapticController.vibrate(e)}i.metrics.pressureReadings||(i.metrics.pressureReadings=[]),i.metrics.pressureReadings.push({timestamp:Date.now(),pressure:n}),this.emit("pressure-update",{sessionId:e,pressure:n})}startHeartbeatMonitoring(e){this.heartbeatInterval=setInterval(()=>{this.activeSessions.get(e)?this.websocketService.send("tether-heartbeat",{sessionId:e,timestamp:Date.now(),isActive:!0}):this.heartbeatInterval&&clearInterval(this.heartbeatInterval)},5e3)}endTetherSession(e){return m(this,null,function*(){const t=this.activeSessions.get(e);t&&(t.status="ended",t.endTime=Date.now(),t.metrics.completionRate=1,t.metrics.sessionQuality=this.calculateSessionQuality(t),this.websocketService.send("tether-end",{sessionId:e,endTime:t.endTime,metrics:t.metrics}),this.breathingInterval&&clearInterval(this.breathingInterval),this.heartbeatInterval&&clearInterval(this.heartbeatInterval),yield this.storeSessionMetrics(t),this.activeSessions.delete(e),this.emit("tether-session-ended",e))})}calculateSessionQuality(e){let t=5;const i=((e.endTime||Date.now())-e.startTime)/6e4;return i>=10?t+=2:i>=5&&(t+=1),e.metrics.pressureReadings&&e.metrics.pressureReadings.length>10&&(t+=1),e.breathingSync&&(t+=1),Math.min(10,t)}storeSessionMetrics(e){return m(this,null,function*(){try{const t=d(c({},e),{storedAt:Date.now()});yield this.secureStorage.setItem(`session-${e.id}`,JSON.stringify(t))}catch(t){}})}handleTetherRequest(e){this.pendingRequests.set(e.id,e),oe.addToast(`Tether request from ${e.fromUserId}: ${e.message}`,"critical"===e.urgency?"error":"info"),this.emit("tether-request-received",e)}handleTetherResponse(e){const t=this.pendingRequests.get(e.requestId);t&&(e.accepted&&e.sessionId?this.emit("tether-request-accepted",{request:t,sessionId:e.sessionId}):this.emit("tether-request-declined",t),this.pendingRequests.delete(e.requestId))}handlePressureUpdate(e){const t=this.activeSessions.get(e.sessionId);if(t){if(t.hapticSync&&this.hapticController){const i=Math.floor(e.pressure*t.settings.hapticIntensity*100);this.hapticController.vibrate(i)}this.emit("pressure-received",e)}}handleHeartbeatSync(e){this.activeSessions.get(e.sessionId)&&this.emit("heartbeat-received",e)}handleBreathingSync(e){this.activeSessions.get(e.sessionId)&&this.emit("breathing-sync-received",e)}handleTetherEnd(e){const t=this.activeSessions.get(e.sessionId);t&&(t.status="ended",t.endTime=e.endTime,t.metrics=c(c({},t.metrics),e.metrics),this.activeSessions.delete(e.sessionId),this.emit("tether-session-ended",e.sessionId))}handleEmergencyEscalation(e){const t=this.activeSessions.get(e.sessionId);t&&(t.status="escalated",this.emit("emergency-escalation",e),"professional"===e.escalationType&&t.settings.professionalHandoffEnabled&&this.requestProfessionalHandoff(e.sessionId,e.contact))}handleDeviceMotion(e){const t=e.acceleration;if(t){const e=Math.sqrt(a(t.x||0,2)+a(t.y||0,2)+a(t.z||0,2))/10;this.activeSessions.forEach((t,i)=>{t.settings.pressureShareEnabled&&this.sendPressureUpdate(i,e)})}}requestEmergencyEscalation(e,t){return m(this,null,function*(){const i=this.activeSessions.get(e);if(!i)throw new Error("Session not found");const n={sessionId:e,escalationType:t,timestamp:Date.now(),participants:i.participants,urgency:"critical",sessionMetrics:i.metrics};this.websocketService.send("tether-emergency",n),"professional"===t&&(yield this.requestProfessionalHandoff(e)),this.emit("emergency-escalation-requested",n)})}requestProfessionalHandoff(e,t){return m(this,null,function*(){const i=this.activeSessions.get(e);if(!i)return;const n={sessionId:e,timestamp:Date.now(),sessionData:{duration:Date.now()-i.startTime,tetherType:i.tetherType,participants:i.participants,metrics:i.metrics},preferredContact:t,urgency:"high"};this.emit("professional-handoff-requested",n)})}getActiveSession(e){return this.activeSessions.get(e)}getActiveSessions(){return Array.from(this.activeSessions.values())}getPendingRequests(){return Array.from(this.pendingRequests.values())}getUserSettings(){return this.userSettings}updateUserSettings(e){return m(this,null,function*(){this.userSettings=c(c({},this.userSettings),e),yield this.saveUserSettings(),this.emit("settings-updated",this.userSettings)})}isAvailable(){return!!this.userSettings&&this.activeSessions.size<3}destroy(){this.breathingInterval&&clearInterval(this.breathingInterval),this.heartbeatInterval&&clearInterval(this.heartbeatInterval),this.activeSessions.forEach((e,t)=>{this.endTetherSession(t)}),this.eventHandlers.clear(),"DeviceMotionEvent"in window&&window.removeEventListener("devicemotion",this.handleDeviceMotion.bind(this))}initiateTether(e){return m(this,null,function*(){return this.sendTetherRequest(e)})}acceptTether(e,t){return m(this,null,function*(){return null!==(yield this.respondToTetherRequest(e,!0))})}endTether(e,t){return m(this,null,function*(){return this.endTetherSession(e)})}updateConnectionStrength(e,t){this.sendPressureUpdate(e,t)}saveComfortProfile(e,t){return m(this,null,function*(){t.settings&&(yield this.updateUserSettings(t.settings))})}}let Ne=null;const Ue=()=>(Ne||(Ne=new Le),Ne),Fe=(e,t,i="...")=>e?e.length<=t?e:e.slice(0,t).trimEnd()+i:"";export{R as A,V as T,C as W,L as a,B as b,he as c,ve as d,ge as e,pe as f,fe as g,Ie as h,Ce as i,Ue as j,E as k,N as l,M as m,X as n,me as o,le as p,ce as r,ae as s,Fe as t};
